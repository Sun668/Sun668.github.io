<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="This article talks about the development process of asynchronous programming syntax, and how asynchronous method invocation gradually becomes synchronous syntax. There are probably asynchronous progra"><meta property="og:type" content="article"><meta property="og:title" content="JavaScript Asynchronous Programming Syntax"><meta property="og:url" content="https://sunra.top/en/2020/06/02/javascript_async/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="This article talks about the development process of asynchronous programming syntax, and how asynchronous method invocation gradually becomes synchronous syntax. There are probably asynchronous progra"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2020-06-02T10:59:07.000Z"><meta property="article:modified_time" content="2023-07-21T07:32:11.801Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://sunra.top/en/2020/06/02/javascript_async/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/2020/06/02/javascript_async/","path":"2020/06/02/javascript_async/","title":"JavaScript Asynchronous Programming Syntax"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>JavaScript Asynchronous Programming Syntax | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Generator"><span class="nav-number">1.</span> <span class="nav-text">Generator</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Generator-function"><span class="nav-number">1.1.</span> <span class="nav-text">Generator function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Generator-function-pause-resume-execution-principle"><span class="nav-number">1.2.</span> <span class="nav-text">Generator function pause resume execution principle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Actuator"><span class="nav-number">1.3.</span> <span class="nav-text">Actuator</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Actuator-for-callback-function-yield"><span class="nav-number">1.3.1.</span> <span class="nav-text">Actuator for callback function (yield</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#The-executor-of-the-Promise-object-yield"><span class="nav-number">1.3.2.</span> <span class="nav-text">The executor of the Promise object (yield</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#COS-function"><span class="nav-number">1.3.3.</span> <span class="nav-text">COS function</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#COS-function-source-code"><span class="nav-number">1.3.4.</span> <span class="nav-text">COS function source code</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#async-await"><span class="nav-number">2.</span> <span class="nav-text">async&#x2F;await</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Summary"><span class="nav-number">3.</span> <span class="nav-text">Summary</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/2020/06/02/javascript_async/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="JavaScript Asynchronous Programming Syntax | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> JavaScript Asynchronous Programming Syntax</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-06-02 18:59:07" itemprop="dateCreated datePublished" datetime="2020-06-02T18:59:07+08:00">2020-06-02</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2023-07-21 15:32:11" itemprop="dateModified" datetime="2023-07-21T15:32:11+08:00">2023-07-21</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/2020/06/02/javascript_async/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/2020/06/02/javascript_async/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>This article talks about the development process of asynchronous programming syntax, and how asynchronous method invocation gradually becomes synchronous syntax.</p><p>There are probably asynchronous programming methods<a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.ruanyifeng.com/blog/2012/12/asynchronous＿javascript.html">下面四种</a>。</p><blockquote><p>-<br>-<br>-<br>-</p></blockquote><p>ECMAScript 6 (abbreviated as ES6), as the next generation JavaScript language, brings JavaScript asynchronous programming to a new stage. <strong>The topic of this series of articles is to introduce more powerful and complete ES6 asynchronous programming methods.</strong></p><p>The new method is more abstract, at first, I often feel puzzled, until a long time later to figure out, <strong>The syntax goal of asynchronous programming is how to make it more like synchronous programming.</strong></p><p>This article is about the relationship between these grammars. If you need a deep understanding of any grammar during reading, you can take a look.<a target="_blank" rel="external nofollow noopener noreferrer" href="https://es6.ruanyifeng.com/#README">阮一峰老师的ES6语法入门</a>。<br><span id="more"></span></p><h2 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h2><p>In general, async is syntactic sugar for the Generator function and has been improved on the Generator function.</p><h3 id="Generator-function"><a href="#Generator-function" class="headerlink" title="Generator function"></a>Generator function</h3><p>The Generator function is a Finite-State Machine that encapsulates multiple internal states. Execution of the Generator function will return a traverser object, which can traverse each state inside the Generator function in turn, but only by calling the’next ‘method will the next internal state be traversed, so it actually provides a function that can pause execution. The’yield’ expression is the pause flag.</p><p>There is such a piece of code:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">helloWorldGenerator</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;ending&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hw = <span class="title function_">helloWorldGenerator</span>();</span><br></pre></td></tr></table></figure><p>Call and run results:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hw.<span class="title function_">next</span>()<span class="comment">// &#123; value: &#x27;hello&#x27;, done: false &#125;</span></span><br><span class="line">hw.<span class="title function_">next</span>()<span class="comment">// &#123; value: &#x27;world&#x27;, done: false &#125;</span></span><br><span class="line">hw.<span class="title function_">next</span>()<span class="comment">// &#123; value: &#x27;ending&#x27;, done: true &#125;</span></span><br><span class="line">hw.<span class="title function_">next</span>()<span class="comment">// &#123; value: undefined, done: true &#125;</span></span><br></pre></td></tr></table></figure><p>As can be seen from the results, ‘Generator function’ does not execute when called, but only executes when the’next method ‘is called and the internal pointer points to the statement,’ that is, the function can be suspended or resumed ‘. Each time the next method of the traverser object is called, an object with two properties,’ value ‘and’done’, is returned. The’value ‘property represents the value of the current internal state, which is the value of the expression following the yield expression; the’done’ property is a boolean value indicating whether the traversal has ended.</p><h3 id="Generator-function-pause-resume-execution-principle"><a href="#Generator-function-pause-resume-execution-principle" class="headerlink" title="Generator function pause resume execution principle"></a>Generator function pause resume execution principle</h3><p>To understand why functions can pause and resume, you first need to understand the concept of coroutines.</p><blockquote><p>When a thread (or function) is halfway through execution, it can suspend execution, give the execution right to another thread (or function), and resume execution when the execution right is recovered later. This kind of thread (or function) that can execute in parallel and exchange execution rights is called coroutine.</p></blockquote><p>Coroutines are more lightweight than threads. Ordinary threads are preemptive and compete for cpu resources, while coroutines are cooperative. Coroutines can be regarded as tasks running on threads. There can be multiple coroutines on a thread, but only one coroutine can be executed on the thread at the same time. Its running process is roughly as follows:</p><ol><li>Coroutine’A ‘starts execution</li><li>Coroutine’A ‘executes to a certain stage, enters a pause, and the execution right is transferred to coroutine’B’</li><li>The execution of coroutine’B ‘is completed or suspended, and the execution right is returned to’A’</li><li>Coroutine’A ‘resumes execution</li></ol><p>The coroutine pauses when it encounters the yield command, waits until the execution right returns (calls the next method), and then continues to execute from the paused place. Its biggest advantage is that the code is written very much like a synchronous operation. If the yield command is removed, it will be exactly the same.</p><h3 id="Actuator"><a href="#Actuator" class="headerlink" title="Actuator"></a>Actuator</h3><p>Usually, we encapsulate the code that executes the generator into a function, and call the function that executes the generator code an executor.</p><p> <strong>Generator is a container for asynchronous operations. Its automatic execution requires a mechanism to automatically hand back the execution right when the asynchronous operation has a result</strong> . Two methods can do this:</p><ol><li>Callback function. Wrap asynchronous operations as <a href="https://sunra.top/posts/d56cb4fa/">Thunk 函数</a>Return the execution right in the callback function.</li><li>Promise object. Wrap the asynchronous operation into a Promise object, and use the then method to return the execution right.</li></ol><h4 id="Actuator-for-callback-function-yield"><a href="#Actuator-for-callback-function-yield" class="headerlink" title="Actuator for callback function (yield"></a>Actuator for callback function (yield</h4><p>The following is a Generator executor based on Thunk function.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">fn</span>) &#123;</span><br><span class="line"><span class="keyword">var</span> gen = <span class="title function_">fn</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">next</span>(<span class="params">err, data</span>) &#123;</span><br><span class="line"> <span class="keyword">var</span> result = gen.<span class="title function_">next</span>(data);</span><br><span class="line"> <span class="keyword">if</span> (result.<span class="property">done</span>) <span class="keyword">return</span>;</span><br><span class="line"> result.<span class="title function_">value</span>(next);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">run</span>(gen);</span><br></pre></td></tr></table></figure><p>The run function of the above code is an automatic executor of the Generator function. The internal next function is the callback function of Thunk. Next function first moves the pointer to the next step of the Generator function (gen.next method), and then determines whether the Generator function ends (result.done property). If it does not end, pass the next function to the Thunk function (result.value property), otherwise exit directly.</p><p>With this executor, executing the Generator function is much easier. No matter how many asynchronous operations there are, just pass in the run function directly. Of course, the premise is that each asynchronous operation must be a Thunk function, that is, the yield command must be followed by a Thunk function.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gen = <span class="keyword">function</span>* ()&#123;</span><br><span class="line"><span class="title class_">Var</span> f1 = <span class="keyword">yield</span> readFile (<span class="string">&#x27;fileA&#x27;</span>);<span class="comment">//readFile is a Thunk function that returns a function to pass in the callback function</span></span><br><span class="line"><span class="keyword">var</span> f2 = <span class="keyword">yield</span> <span class="title function_">readFile</span>(<span class="string">&#x27;fileB&#x27;</span>);</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">var</span> fn = <span class="keyword">yield</span> readFile (<span class="string">&#x27;fileN&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">run</span>(gen);</span><br></pre></td></tr></table></figure><p>In the above code, function gen encapsulates n asynchronous read file operations, which will be automatically completed as long as the run function is executed. In this way, asynchronous operations can not only be written like synchronous operations, but also executed in one line of code.</p><p>Thunk function is not the only solution for automatic execution of Generator function. Because the key to automatic execution is that there must be a mechanism to automatically control the flow of Generator function, receive and return the execution rights of the program. The callback function can do this, and so can the Promise object.</p><h4 id="The-executor-of-the-Promise-object-yield"><a href="#The-executor-of-the-Promise-object-yield" class="headerlink" title="The executor of the Promise object (yield"></a>The executor of the Promise object (yield</h4><p>A simple automatic executor based on a Promise object (or an executor that can only yield Promises):</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">gen</span>)&#123;</span><br><span class="line">  <span class="title class_">Var</span> g = gen ();<span class="comment">//call generator to generate iterator g</span></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Function</span> next (data) &#123;<span class="comment">//Defines the next function of the executor</span></span><br><span class="line">    <span class="title class_">Var</span> result = g.<span class="property">next</span> (data);<span class="comment">//call the next function of iterator g and run until the next yield is encountered</span></span><br><span class="line">    <span class="title class_">If</span> (result.<span class="property">done</span>) <span class="keyword">return</span> result.<span class="property">value</span>;<span class="comment">//if the iterator completes, return the result</span></span><br><span class="line">    <span class="title class_">Result</span>.<span class="property">value</span>.<span class="property">then</span> (<span class="keyword">function</span> (<span class="params">data</span>) &#123;<span class="comment">//result.value is a promise, continue to call the next method of the executor in then, and pass in the promise. resolve data</span></span><br><span class="line">      <span class="title function_">next</span>(data);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title class_">Next</span> (); <span class="comment">// directly call the next method of the executor once</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>When we use it, we can use it like this.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Let</span> response1 = <span class="keyword">yield</span> fetch (<span class="string">&#x27;https://xxx&#x27;</span>)<span class="comment">//return promise object</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;response1&#x27;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response1)</span><br><span class="line">    <span class="title class_">Let</span> response2 = <span class="keyword">yield</span> fetch (<span class="string">&#x27;https://xxx&#x27;</span>)<span class="comment">//return promise object</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;response2&#x27;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response2)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">run</span>(foo);</span><br><span class="line"><span class="comment">//1. g = foo (); Generator foo generates iterator g after execution</span></span><br><span class="line"><span class="comment">//2. Run the next method of the executor for the first time without passing parameters. At this time, the data of result = g.next (data) is undefined, and the result is &#123;value: fetch (&#x27;https://xxx&#x27;), done: false&#125;</span></span><br><span class="line"><span class="comment">//3.done is false, continue execution, result.value.then is actually fetch (&#x27;https://xxx&#x27;).then, the data passed in the callback function of then is the result of the fetch function, and the callback function is called again The next method of the executor passes in the result of fetch at this time.</span></span><br><span class="line"><span class="comment">//4. Run the next method of the executor for the second time, the incoming data is the result returned by the previous fetch, continue to run the foo function through g.next (data), assign the data to response1, and then print the data, until it meets The second yield, then the result.value in the next function of the executor is equal to the second fetch. Repeat the previous step.</span></span><br></pre></td></tr></table></figure><p>In the above code, as long as the Generator function has not been executed to the last step, the next function calls itself to achieve automatic execution. By using generators and executors, asynchronous code can be written in a synchronous way, which greatly enhances the readability of the code.</p><p> <strong>The above method looks a lot like async/await. Replace the yield above with await and the function * with async. In fact, await is waiting for the executor to return the running permission.</strong> At one point, the callback or then are straightened out through the constant callbacks of the built-in executor, and it is synchronized. <strong>The execution right of the thread is handed over through yield. After the asynchronous function in the executor returns the data, the data and execution right are passed to the generator through the next method</strong> .</p><h4 id="COS-function"><a href="#COS-function" class="headerlink" title="COS function"></a>COS function</h4><p>There is a Generator function that reads two files in sequence.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gen = <span class="keyword">function</span>* ()&#123;</span><br><span class="line">    <span class="keyword">var</span> f1 = <span class="keyword">yield</span> <span class="title function_">readFile</span>(<span class="string">&#x27;/etc/fstab&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> f2 = <span class="keyword">yield</span> <span class="title function_">readFile</span>(<span class="string">&#x27;/etc/shells&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(f1.<span class="title function_">toString</span>());</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(f2.<span class="title function_">toString</span>());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p> <strong>The comma function library lets you avoid writing executors for Generator functions.</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> co = <span class="built_in">require</span>(<span class="string">&#x27;co&#x27;</span>);</span><br><span class="line"><span class="title function_">co</span>(gen);</span><br></pre></td></tr></table></figure><p>In the above code, the Generator function will be automatically executed as long as it is passed in to the co function.</p><p>The co function returns a Promise object, so you can add a callback function with the then method.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">co</span>(gen).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">	<span class="title class_">Console</span>.<span class="property">log</span> (<span class="string">&#x27;Generator function completed&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>In the above code, when the Generator function finishes executing, a line of prompts will be output.</p><h4 id="COS-function-source-code"><a href="#COS-function-source-code" class="headerlink" title="COS function source code"></a>COS function source code</h4><p>First, the co function takes the Generator function as a parameter and returns a Promise object.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">co</span>(<span class="params">gen</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ctx = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>In the returned Promise object, co first checks whether the parameter gen is a Generator function. If so, execute the function and get an internal pointer object; if not, return and change the state of the Promise object to resolved.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">co</span>(<span class="params">gen</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ctx = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">     <span class="keyword">if</span> (<span class="keyword">typeof</span> gen = <span class="string">&#x27;function&#x27;</span>) gen = gen.<span class="title function_">call</span>(ctx);</span><br><span class="line">     <span class="keyword">if</span> (!gen || <span class="keyword">typeof</span> gen.<span class="property">next</span> ! <span class="string">&#x27;function&#x27;</span>) <span class="keyword">return</span> <span class="title function_">resolve</span>(gen);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Next, co wraps the next method of the internal pointer object of the Generator function as an onFulefilled function. This is mainly to be able to catch thrown errors.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">co</span>(<span class="params">gen</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ctx = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">     <span class="keyword">if</span> (<span class="keyword">typeof</span> gen = <span class="string">&#x27;function&#x27;</span>) gen = gen.<span class="title function_">call</span>(ctx);</span><br><span class="line">     <span class="keyword">if</span> (!gen || <span class="keyword">typeof</span> gen.<span class="property">next</span> ! <span class="string">&#x27;function&#x27;</span>) <span class="keyword">return</span> <span class="title function_">resolve</span>(gen);</span><br><span class="line"></span><br><span class="line">     <span class="title function_">onFulfilled</span>();</span><br><span class="line">     <span class="keyword">function</span> <span class="title function_">onFulfilled</span>(<span class="params">res</span>) &#123;</span><br><span class="line">       <span class="keyword">var</span> ret;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">         ret = gen.<span class="title function_">next</span>(res);</span><br><span class="line">       &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="title function_">reject</span>(e);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="title function_">next</span>(ret);</span><br><span class="line">     &#125;    </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Finally, there is the key next function, which calls itself repeatedly.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">next</span>(<span class="params">ret</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (ret.<span class="property">done</span>) <span class="keyword">return</span> <span class="title function_">resolve</span>(ret.<span class="property">value</span>);</span><br><span class="line">    <span class="keyword">var</span> value = toPromise.<span class="title function_">call</span>(ctx, ret.<span class="property">value</span>);</span><br><span class="line">    <span class="keyword">if</span> (value &amp;&amp; <span class="title function_">isPromise</span>(value)) <span class="keyword">return</span> value.<span class="title function_">then</span>(onFulfilled, onRejected);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">onRejected</span>(<span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;You may only yield a function, promise, generator, array, or object, &#x27;</span></span><br><span class="line">        + <span class="string">&#x27;but the following object was passed: &quot;&#x27;</span> + <span class="title class_">String</span>(ret.<span class="property">value</span>) + <span class="string">&#x27;&quot;&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>In the above code, the internal code of the next function has only four lines of commands in total.</p><blockquote><p>First line, check if the current is</p><p>The second line, ensuring the return value of each step, is</p><p>Third line, use</p><p>In the fourth line, if the parameter does not meet the requirements (the parameter is not</p></blockquote><h2 id="async-await"><a href="#async-await" class="headerlink" title="async/await"></a>async/await</h2><p>The introduction of async/await in ES7 can completely bid farewell to executors and generators and achieve more intuitive and concise code. According to the MDN definition, async is a function that executes asynchronously and implicitly returns a Promise as the result. It can be said that async is the syntactic sugar of Generator function, and the Generator function has been improved.</p><p>The previous code, implemented with’async ‘, looks like this:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">foo</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> response1 = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://xxx&#x27;</span>) </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;response1&#x27;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response1)</span><br><span class="line">    <span class="keyword">let</span> response2 = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://xxx&#x27;</span>) </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;response2&#x27;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>A comparison shows that the async function replaces the asterisk (*) of the Generator function with async, replaces yield with await, and that’s it.</p><p>The async function improves the Generator function in the following four points:</p><ol><li>Built-in executor. The execution of the Generator function must rely on the executor, while the async function has its own executor, so there is no need to manually execute the next () method.</li><li>‘Better semantics’. Async and await have clearer semantics than asterisks and yield. Async means that there is an asynchronous operation in the function, and await means that the following expression needs to wait for the result.</li><li>‘Wider applicability’. The co module convention stipulates that only Thunk function or Promise object can be behind the yield command, while the await command of async function can be Promise object and primitive type values (numeric, string, and boolean values, but this will be automatically converted to immediately resolved Promise object).</li><li>The return value is a Promise. The return value of async function is a Promise object, which is more convenient than the Iterator object returned by Generator function and can be called directly using then () method.</li></ol><p>The key point here is that it has its own executor, which is equivalent to encapsulating everything we need to do extra (write executor/dependent co module) internally. For example:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">args</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Equivalent to:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">args</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">spawn</span>(<span class="keyword">function</span>* () &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Function</span> spawn (genF) &#123;<span class="comment">//spawn function is an automatic executor, the same idea as the simple version, with more Promise and fault tolerance</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="title class_">Const</span> gen = genF (); <span class="comment">// execute generator</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">step</span>(<span class="params">nextF</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> next;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="title class_">Next</span> = next F (); <span class="comment">// next is gen.next ()</span></span><br><span class="line">      &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">reject</span>(e);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title class_">If</span> (next.<span class="property">done</span>) &#123;<span class="comment">//if all awaits are executed, then async can be resolved</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">resolve</span>(next.<span class="property">value</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title class_">Promise</span>.<span class="property">resolve</span> (next.<span class="property">value</span>).<span class="property">then</span> (<span class="keyword">function</span> (<span class="params">v</span>) &#123;<span class="comment">//if there is still await, then change the content of the next await (which can be a promise, or a value, etc.) to Promsie</span></span><br><span class="line">        <span class="title class_">Step</span> (<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="keyword">return</span> gen.<span class="property">next</span> (v ); &#125;); <span class="comment">// execute gen.next (v) in then, handing the execution right back to the async function along with the data v to continue execution to the next await.</span></span><br><span class="line">      &#125;, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="title function_">step</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> gen.<span class="keyword">throw</span>(e); &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Step</span> (<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="keyword">return</span> gen.<span class="property">next</span> (<span class="literal">undefined</span> ); &#125;); <span class="comment">// call step, pass in a function, function returns gen.next ()</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>To sum up, that is to say, async/await actually encapsulates the generator and the executor, encapsulates the function to be executed into the generator, and executes it with a built-in executor.</p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>The Generator can temporarily hand over the thread execution right while waiting for the asynchronous method (callback function, Promise) to return, while the executor can help execute the generator while waiting for the asynchronous method to return and call the generator’s next method, returning the asynchronous method. The return data and execution rights are returned to the generator.</p><p>In general, we can use callbacks, Promises and other methods for asynchronous programming. Promises solve the callback nightmare, but they are still different from synchronous programming syntax, so we use the generator Generator to first yiled the result of the Promise. When the Promise resolves, pass the execution right to the generator together with the result of the Promise through the next method to continue execution until the next yield or end.</p><p>At this point, it looks like synchronous programming. Yield continues to execute after waiting for the asynchronous result to return, but in the above process, we need to write an executor to execute the generator. When yielding, the execution right is handed over. After the Promise resolves of yield, call the next of the Generator to hand over the execution right. This executor is known as CO at the beginning. It can help us execute the Generator, but the yield can only be Thunk or Promise.</p><p>So later came async/await, <strong>The function defined with async will be put into a generator and then return a Promise. It not only makes the syntax better understood, but also has a built-in support for a wider range of executors (Promises) to execute this generator, this Promise is an executor, and then uses the recursion callback of the internal function of the executor to call the next method of the generator</strong> , to execute all asynchronous functions one by one, until all awaits are executed. Call the resolve of the Promise and return the result.</p><p>Reference link:</p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.ruanyifeng.com/blog/2015/05/co.html">http://www.ruanyifeng.com/blog/2015/05/co.html</a></p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/2020/06/02/javascript_async/" title="JavaScript Asynchronous Programming Syntax">https://sunra.top/en/2020/06/02/javascript_async/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/2020/05/30/nodejs-io-and-event/" rel="prev" title="Nodejs Asynchronous IO and Event Driven"><i class="fa fa-chevron-left"></i> Nodejs Asynchronous IO and Event Driven</a></div><div class="post-nav-item"> <a href="/en/2020/06/08/union-find-algorithm/" rel="next" title="Union search algorithm">Union search algorithm<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2023</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/en/js/third-party/math/mathjax.js"></script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/2020/06/02/javascript_async/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>