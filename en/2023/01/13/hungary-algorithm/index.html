<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="I came into contact with this algorithm because I saw a problem called prime significant other. That is to say, you are given a string of numbers, and you choose two numbers to add. If their sum is a"><meta property="og:type" content="article"><meta property="og:title" content="Hungary algorithm"><meta property="og:url" content="https://sunra.top/en/2023/01/13/hungary-algorithm/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="I came into contact with this algorithm because I saw a problem called prime significant other. That is to say, you are given a string of numbers, and you choose two numbers to add. If their sum is a"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1673917617/origin-of-ray/v2-81f21981c992bc0b5b1acf04b37ff6c2_r_tjxivp.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1673917884/origin-of-ray/screenshot-20230117-091101_x2bdmd.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1673917885/origin-of-ray/screenshot-20230117-091111_oj8vev.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1673922535/origin-of-ray/screenshot-20230117-102841_rk6fvq.png"><meta property="article:published_time" content="2023-01-13T14:12:06.000Z"><meta property="article:modified_time" content="2025-06-14T08:12:57.440Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1673917617/origin-of-ray/v2-81f21981c992bc0b5b1acf04b37ff6c2_r_tjxivp.png"><link rel="canonical" href="https://sunra.top/en/2023/01/13/hungary-algorithm/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/2023/01/13/hungary-algorithm/","path":"2023/01/13/hungary-algorithm/","title":"Hungary algorithm"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Hungary algorithm | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#bipartite-graph"><span class="nav-number">1.</span> <span class="nav-text">Bipartite graph</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hungary-algorithm"><span class="nav-number">2.</span> <span class="nav-text">Hungary algorithm</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#pre-concept"><span class="nav-number">2.1.</span> <span class="nav-text">Pre-concept</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#basic-principle-of-algorithm"><span class="nav-number">2.2.</span> <span class="nav-text">Basic principle of algorithm</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#algorithm-implementation"><span class="nav-number">2.3.</span> <span class="nav-text">Algorithm implementation</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/2023/01/13/hungary-algorithm/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Hungary algorithm | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Hungary algorithm</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2023-01-13 22:12:06" itemprop="dateCreated datePublished" datetime="2023-01-13T22:12:06+08:00">2023-01-13</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2025-06-14 16:12:57" itemprop="dateModified" datetime="2025-06-14T16:12:57+08:00">2025-06-14</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/2023/01/13/hungary-algorithm/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/2023/01/13/hungary-algorithm/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>I came into contact with this algorithm because I saw a problem called prime significant other. That is to say, you are given a string of numbers, and you choose two numbers to add. If their sum is a prime number, then this pair is called a prime significant other. Then we need to find how many pairs of prime numbers significant other can be found at most in this string of numbers.</p><p>The solution to this problem is first to divide the number into two parts, one part is even and the other part is odd, because the addition of two even numbers or the addition of two odd numbers must still be even and cannot be prime.</p><p>So the problem becomes to choose one of the even numbers, then choose one of the odd numbers, and see how many pairs are added to the prime number at most. This problem uses the Hungary algorithm.</p><p>Hungary algorithm is mainly used to solve some problems related to bipartite graph matching, so let’s first understand bipartite graph.</p><span id="more"></span><h1 id="bipartite-graph"><a class="markdownIt-Anchor" href="#bipartite-graph"></a> Bipartite graph</h1><p>Bipartite graph: Also known as bipartite graph, it is a special model in graph theory. Let G = (V, E) be an undirected graph. If vertices V can be divided into two disjoint subsets (A, B), and the two vertices i and j associated with each edge in the graph belong to these two different sets of vertices (i δ A, j δ B), then the graph G is said to be a bipartite graph.</p><p>In simple terms, if all vertices in the graph can be divided into two sets, and the heads and tails of all edges in the graph do not belong to the same set of vertices, but span both sets, then the graph is a bipartite graph.</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1673917617/origin-of-ray/v2-81f21981c992bc0b5b1acf04b37ff6c2_r_tjxivp.png" alt></p><p>Let’s take another look at this picture:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1673917884/origin-of-ray/screenshot-20230117-091101_x2bdmd.png" alt></p><p>This graph doesn’t look like a bipartite graph at first glance, but if we translate its appearance, we will find that it is actually a bipartite graph</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1673917885/origin-of-ray/screenshot-20230117-091111_oj8vev.png" alt></p><h1 id="hungary-algorithm"><a class="markdownIt-Anchor" href="#hungary-algorithm"></a> Hungary algorithm</h1><h2 id="pre-concept"><a class="markdownIt-Anchor" href="#pre-concept"></a> Pre-concept</h2><p>In graph theory, a matching is a set of edges where no two edges have common vertices.</p><p>** Maximum match **: The match with the largest number of matched edges among all matches of a graph is called the maximum match of this graph.</p><p>** Perfect match **: A graph is a perfect match if all vertices in a match are matching points. A perfect match must be the maximum match (any point of a perfect match has already matched, and adding a new matching edge will definitely conflict with an existing matching edge), but not every graph has a perfect match.</p><p>** Alternate Path **: Starting from an unmatched point, passing through non-matching edges, matching edges, and non-matching edges in turn… The path formed is called an alternate path.</p><p>** Augmenting Path **: Starting from an unmatched point, take an alternate path. If you pass through another unmatched point (the starting point does not count), this alternate path is called an augmenting path (agumenting path).</p><p>** Augmented path properties **:</p><ol><li>The path length of P must be odd, and neither the first nor the last edge belongs to M, because the two endpoints belong to two sets and do not match.</li><li>P can obtain a larger match M 'after inversion operation.</li><li>M is the maximum match of G if and only if there is no augmented path with respect to M.</li></ol><h2 id="basic-principle-of-algorithm"><a class="markdownIt-Anchor" href="#basic-principle-of-algorithm"></a> Basic principle of algorithm</h2><p>Hungary algorithm: The maximum matching algorithm that uses augmented paths to find bipartite graphs is called the Hungary algorithm. (Hungary mathematician Edmonds proposed it in 1965).</p><p>The basic idea: by finding an augmented path, the matching and non-matching edges in the augmented path are exchanged with each other, so that an additional matching edge will be created until the augmented path cannot be found.</p><blockquote><p>One thing to be sure of here is that this process is to find matching and non-matching edges from existing edges, and cannot create new edges</p></blockquote><p>Let’s take the last figure above as an example to explain the process of the entire algorithm:</p><ol><li>Starting from the vertex a, follow the alternate path. The first non-matching edge is, reaching the vertex e, and e is the non-matching point, forming an augmented path. Let it be a matching edge, and the vertices a and e are matching vertices.</li><li>Starting from vertex b, the first non-matching edge is, reach vertex e, select the matching edge, reach a, select the non-matching edge, g is the non-matching point, find an augmented path, exchange the matching edge in the augmented path with The non-matching edge, that is, b-e, a-g becomes the matching edge, and a-e becomes the non-matching edge.</li><li>Starting from the vertex c, the first non-matching edge is, reaches the vertex e, and then proceeds according to the alternate path, reaches the vertex b, cannot continue to move forward, and b is already a matching point, so no new grace path is found</li><li>Starting from vertex c, select the second non-matching edge</li><li>Starting from vertex d, select non-matching edge, reach vertex g, select matching edge, reach vertex a, select non-matching edge to reach vertex e, select matching edge, reach top b, there is no edge to choose, and no augmentation path is found</li><li>Continue from vertex d, select the non-matching edge, find the augmented path, change the edge to the matching edge, and the algorithm ends.</li></ol><p>Finally, the result we get is the following figure, and the red line in the following figure is the maximum match obtained by the algorithm:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1673922535/origin-of-ray/screenshot-20230117-102841_rk6fvq.png" alt></p><h2 id="algorithm-implementation"><a class="markdownIt-Anchor" href="#algorithm-implementation"></a> Algorithm implementation</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Numbering of vertices and edges starts from 0</span></span><br><span class="line"><span class="comment">//adjacency list storage</span></span><br><span class="line"></span><br><span class="line">struct Edge</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> from;</span><br><span class="line">    <span class="type">int</span> to;</span><br><span class="line">    <span class="type">int</span> weight;</span><br><span class="line"></span><br><span class="line">    Edge(<span class="type">int</span> f, <span class="type">int</span> t, <span class="type">int</span> w):from(f), to(t), weight(w) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Vector &lt; <span class="type">int</span> &gt; G [__maxNodes];<span class="comment">/* G [i] stores the number of edges starting from vertex i */</span></span><br><span class="line">vector&lt;Edge&gt; edges;</span><br><span class="line">typedef vector&lt;<span class="type">int</span>&gt;::iterator iterator_t;</span><br><span class="line"><span class="type">int</span> num_nodes;</span><br><span class="line"><span class="type">int</span> num_left;</span><br><span class="line"><span class="type">int</span> num_right;</span><br><span class="line"><span class="type">int</span> num_edges;</span><br><span class="line">Int matching [__maxNodes];<span class="comment">/* store the solution result */</span></span><br><span class="line"><span class="type">int</span> check[__maxNodes];</span><br><span class="line"></span><br><span class="line">bool <span class="title function_">dfs</span><span class="params">(<span class="type">int</span> u)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">iterator_t</span> <span class="variable">i</span> <span class="operator">=</span> G[u].begin(); i != G[u].end(); ++i) &#123; <span class="comment">// 对 u 的每个邻接点</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> edges[*i].to;</span><br><span class="line">        If (! check [v ]) &#123; <span class="comment">// request is not in alternate path</span></span><br><span class="line">            Check [v] = <span class="literal">true</span>;<span class="comment">//put an alternate path</span></span><br><span class="line">            <span class="keyword">if</span> (matching[v]  -<span class="number">1</span> || dfs(matching[v])) &#123;</span><br><span class="line">                <span class="comment">//If it is an uncovered point, indicating that the alternate path is an augmented path, the path is exchanged and success is returned</span></span><br><span class="line">                matching[v] = u;</span><br><span class="line">                matching[u] = v;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Return <span class="literal">false</span>;<span class="comment">//no augmentation path exists, return failed</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">hungarian</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    memset(matching, -<span class="number">1</span>, sizeof(matching));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> u=<span class="number">0</span>; u &lt; num_left; ++u) &#123;</span><br><span class="line">        <span class="keyword">if</span> (matching[u]  -<span class="number">1</span>) &#123;</span><br><span class="line">            memset(check, <span class="number">0</span>, sizeof(check));</span><br><span class="line">            <span class="keyword">if</span> (dfs(u))</span><br><span class="line">                ++ans;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">queue&lt;<span class="type">int</span>&gt; Q;</span><br><span class="line"><span class="type">int</span> prev[__maxNodes];</span><br><span class="line"><span class="type">int</span> <span class="title function_">Hungarian</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    memset(matching, -<span class="number">1</span>, sizeof(matching));</span><br><span class="line">    memset(check, -<span class="number">1</span>, sizeof(check));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;num_left; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (matching[i]  -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (!Q.empty()) Q.pop();</span><br><span class="line">            Q.push(i);</span><br><span class="line">            Prev [i] = -<span class="number">1</span>;<span class="comment">//set i as the starting point of the path</span></span><br><span class="line">            <span class="type">Bool</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;<span class="comment">//no augmentation path found</span></span><br><span class="line">            <span class="keyword">while</span> (!Q.empty() &amp;&amp; !flag) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> Q.front();</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">iterator_t</span> <span class="variable">ix</span> <span class="operator">=</span> G[u].begin(); ix != G[u].end() &amp;&amp; !flag; ++ix) &#123;</span><br><span class="line">                    <span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> edges[*ix].to;</span><br><span class="line">                    <span class="keyword">if</span> (check[v] != i) &#123;</span><br><span class="line">                        check[v] = i;</span><br><span class="line">                        Q.push(matching[v]);</span><br><span class="line">                        If (matching [v] &gt; = <span class="number">0</span> ) &#123; <span class="comment">// this point is a matching point</span></span><br><span class="line">                            prev[matching[v]] = u;</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;<span class="comment">//Find unmatched point, alternate path becomes augmented path</span></span><br><span class="line">                            flag = <span class="literal">true</span>;</span><br><span class="line">                            <span class="type">int</span> d=u, e=v;</span><br><span class="line">                            <span class="keyword">while</span> (d != -<span class="number">1</span>) &#123;</span><br><span class="line">                                <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> matching[d];</span><br><span class="line">                                matching[d] = e;</span><br><span class="line">                                matching[e] = d;</span><br><span class="line">                                d = prev [d];</span><br><span class="line">                                e = t;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                Q.pop();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (matching[i] != -<span class="number">1</span>) ++ans;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Reference article: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.cxyxiaowu.com/874.html">https://www.cxyxiaowu.com/874.html</a></p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/2023/01/13/hungary-algorithm/" title="Hungary algorithm">https://sunra.top/en/2023/01/13/hungary-algorithm/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/2023/01/05/react-scheduler/" rel="prev" title="React Scheduler Source Code Analysis"><i class="fa fa-chevron-left"></i> React Scheduler Source Code Analysis</a></div><div class="post-nav-item"> <a href="/en/2023/01/22/km-algorithm/" rel="next" title="KMS algorithm">KMS algorithm<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" integrity="sha256-hLTCMFlKxdNgPXyWlSSxYN0ykJmxxq9Yt3MNfdRGWeA=" crossorigin="anonymous"><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/2023/01/13/hungary-algorithm/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>