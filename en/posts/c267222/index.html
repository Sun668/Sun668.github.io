<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="The core concept of webpack  Entry: Entry, the first entry of webpack execution and construction, which can be abstractly understood as input Module: Module, everything in webpack is a module, a modu"><meta property="og:type" content="article"><meta property="og:title" content="Introduction to the Webpack Build Process"><meta property="og:url" content="https://sunra.top/en/posts/c267222/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="The core concept of webpack  Entry: Entry, the first entry of webpack execution and construction, which can be abstractly understood as input Module: Module, everything in webpack is a module, a modu"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1593818010/Webpack/16b0153001913dc5_cemufu.webp"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1593818451/Webpack/172256efb94eec6d_nipzbn.webp"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1593818478/Webpack/1722383f5f4bb210_t1mdv0.webp"><meta property="article:published_time" content="2020-07-03T22:43:50.000Z"><meta property="article:modified_time" content="2024-06-26T23:33:43.612Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1593818010/Webpack/16b0153001913dc5_cemufu.webp"><link rel="canonical" href="https://sunra.top/en/posts/c267222/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/posts/c267222/","path":"posts/c267222/","title":"Introduction to the Webpack Build Process"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Introduction to the Webpack Build Process | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#the-core-concept-of-webpack"><span class="nav-number">1.</span> <span class="nav-text">The core concept of webpack</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#webpack"><span class="nav-number">1.1.</span> <span class="nav-text">webpack</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#webpack-build-process-analysis"><span class="nav-number">2.</span> <span class="nav-text">Webpack build process analysis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#the-workflow-of-webpack"><span class="nav-number">2.1.</span> <span class="nav-text">The workflow of webpack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#understanding-the-event-stream-mechanism"><span class="nav-number">2.2.</span> <span class="nav-text">Understanding the Event Stream Mechanism</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#tapable-usage"><span class="nav-number">2.2.1.</span> <span class="nav-text">Tapable usage</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#simple-implementation-of-a"><span class="nav-number">2.2.2.</span> <span class="nav-text">Simple implementation of a</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#how-does-tapable-associate-webapckwebpack-plugins"><span class="nav-number">2.2.3.</span> <span class="nav-text">How does tapable associate webapck&#x2F;webpack plugins?</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#summary"><span class="nav-number">3.</span> <span class="nav-text">Summary</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/posts/c267222/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Introduction to the Webpack Build Process | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Introduction to the Webpack Build Process</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-07-04 06:43:50" itemprop="dateCreated datePublished" datetime="2020-07-04T06:43:50+08:00">2020-07-04</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2024-06-27 07:33:43" itemprop="dateModified" datetime="2024-06-27T07:33:43+08:00">2024-06-27</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Packing/" itemprop="url" rel="index"><span itemprop="name">Packing</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/posts/c267222/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/posts/c267222/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="the-core-concept-of-webpack"><a class="markdownIt-Anchor" href="#the-core-concept-of-webpack"></a> The core concept of webpack</h2><ul><li>Entry: Entry, the first entry of webpack execution and construction, which can be abstractly understood as input</li><li>Module: Module, everything in webpack is a module, a module corresponds to a file, webpack will start from the configured Entry, recursion finds all dependent modules.</li><li>Chunk: Code Block, a chunk is composed of multiple modules for code merging and splitting.</li><li>Loader: Module converter, used to convert the metadata of the module into new content as required.</li><li>Plugin: extension plug-in, broadcast corresponding events at specific times in the webpack build process, plug-in can listen to these events and do corresponding things at specific times.</li></ul><span id="more"></span><h3 id="webpack"><a class="markdownIt-Anchor" href="#webpack"></a> webpack</h3><p>Previous article first<a target="_blank" rel="external nofollow noopener noreferrer" href="https://juejin.im/post/5cede821f265da1bbd4b5630">参考文章</a>Pictures in</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1593818010/Webpack/16b0153001913dc5_cemufu.webp" alt></p><p>For a piece of code with the same logic, when we write a file by hand, whether it is ESM or commonJS or AMD, they are all ** modules **;</p><p>When the module source file we write is sent to webpack for packaging, webpack will generate a ** chunk ** file according to the file reference relationship, and webpack will perform some operations on this chunk file;</p><p>After webpack processes the chunk file, it will finally output the ** bundle ** file. This bundle file contains the final source file that has been loaded and compiled, so it can be run directly in the browser.</p><p>Generally speaking, a chunk corresponds to a bundle, such as’utils.js - &gt; chunks 1 - &gt; utils.bundle.js’ in the above figure; but there are exceptions. For example, in the above figure, I used’MiniCssExtractPlugin ‘to extract the’index.bundle.css’ file from chunks 0.</p><h2 id="webpack-build-process-analysis"><a class="markdownIt-Anchor" href="#webpack-build-process-analysis"></a> Webpack build process analysis</h2><p>Webpack source code is a plugin architecture, many functions are achieved through many built-in plugins. Webpack specifically writes a plugin system for this purpose, called’Tapable ', which mainly provides the functions of registering and calling plugins.</p><h3 id="the-workflow-of-webpack"><a class="markdownIt-Anchor" href="#the-workflow-of-webpack"></a> The workflow of webpack</h3><p>Webpack is a serial process. From startup to completion, the following process will be executed in sequence</p><ul><li>Initialization parameters: Merge parameters from shell parameters and configuration files to obtain final parameters</li><li>Start compile: initialize the compiler object with the parameters obtained from the previous step, load all plugins, and execute compile through the run method.</li><li>identify entries: find all entry files based on the configuration file entries.</li><li>compile module: start from the entry file, call all configured loaders to translate the module into compliation, then recursion all dependent modules, and then repeat compile. Get the final translated content of each module and their dependencies.</li><li>Output resources: Assemble chunks containing multiple modules according to the dependencies of the entry and the module, and then convert the chunk into a separate file to join the output list. This is the last chance to modify the output content</li><li>Output complete: After determining the output content, determine the output path and file name according to the configuration, and write the content of the file to the file system.</li></ul><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1593818451/Webpack/172256efb94eec6d_nipzbn.webp" alt="img"></p><p>WebPack compiles the flowchart, the original picture is from:<a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.didiyun.com/index.php/2019/03/01/webpack/">blog.didiyun.com/index.php/2…</a></p><p>In the above process, webpack will broadcast specific events at specific time points, and the plugin will execute specific logic after listening to the events of interest and change the running results of webpack.</p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://juejin.im/post/5dcaa685f265da4d2375a162#heading-2">这篇文章</a>会从源码级别讲解流程，有兴趣或者有需要可以回头看。</p><h3 id="understanding-the-event-stream-mechanism"><a class="markdownIt-Anchor" href="#understanding-the-event-stream-mechanism"></a> Understanding the Event Stream Mechanism</h3><p>'Webpack 'is essentially an event flow mechanism, and its workflow is to connect various plugins, and the core of all this is Tapable.</p><p>Webpack’s Tapable event streaming mechanism ensures the orderliness of the plugin, concatenates each plugin, Webpack will broadcast events during operation, and the plugin only needs to listen to the events it cares about to join this webapck mechanism, to change the operation of webapck, making the entire system scalable.</p><p>‘Tapable ‘is also a small library and a core tool of’Webpack’. Similar to the’events’ library in’node ', the core principle is a subscription publishing mode. The role is to provide a similar plugin interface.</p><p>The core’Compiler ‘responsible for compiling and’Compilation’ responsible for creating bundles in webpack are both instances of Tapable, which can broadcast and listen to events directly on the’Compiler ‘and’Compilation’ objects. The methods are as follows:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Broadcast events</span></span><br><span class="line"><span class="comment">* Event-name is the name of the event, be careful not to duplicate the name of an existing event</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">compiler.<span class="title function_">apply</span>(<span class="string">&#x27;event-name&#x27;</span>,params);</span><br><span class="line">compilation.<span class="title function_">apply</span>(<span class="string">&#x27;event-name&#x27;</span>,params);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Monitoring incidents</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">compiler.<span class="title function_">plugin</span>(<span class="string">&#x27;event-name&#x27;</span>,<span class="keyword">function</span>(<span class="params">params</span>)&#123;&#125;);</span><br><span class="line">compilation.<span class="title function_">plugin</span>(<span class="string">&#x27;event-name&#x27;</span>, <span class="keyword">function</span>(<span class="params">params</span>)&#123;&#125;);</span><br></pre></td></tr></table></figure><p>The Tapable class exposes the tap, tapAsync, and tapPromise methods, which allow you to select a function to inject logic based on the synchronous/asynchronous mode of the hook.</p><p>'Tap 'sync hook</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">compiler.<span class="property">hooks</span>.<span class="property">compile</span>.<span class="title function_">tap</span>(<span class="string">&#x27;MyPlugin&#x27;</span>, <span class="function"><span class="params">params</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="title class_">Console</span>.<span class="property">log</span> (<span class="string">&#x27;Touch compile hook synchronously.&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>'tapAsync ‘asynchronous hook, tell’Webpack’ to complete asynchronous execution through’callback ‘callback’tapPromise’ asynchronous hook, return a’Promise ‘to tell’Webpack’ to complete asynchronous execution</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">compiler.<span class="property">hooks</span>.<span class="property">run</span>.<span class="title function_">tapAsync</span>(<span class="string">&#x27;MyPlugin&#x27;</span>, <span class="function">(<span class="params">compiler, callback</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title class_">Console</span>.<span class="property">log</span> (<span class="string">&#x27;Touch run hook asynchronously.&#x27;</span>)</span><br><span class="line">  <span class="title function_">callback</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">compiler.<span class="property">hooks</span>.<span class="property">run</span>.<span class="title function_">tapPromise</span>(<span class="string">&#x27;MyPlugin&#x27;</span>, <span class="function"><span class="params">compiler</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">1000</span>)).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title class_">Console</span>.<span class="property">log</span> (<span class="string">&#x27;hit run hook asynchronously with delay&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="tapable-usage"><a class="markdownIt-Anchor" href="#tapable-usage"></a> Tapable usage</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line"> <span class="title class_">SyncHook</span>,</span><br><span class="line"> <span class="title class_">SyncBailHook</span>,</span><br><span class="line"> <span class="title class_">SyncWaterfallHook</span>,</span><br><span class="line"> <span class="title class_">SyncLoopHook</span>,</span><br><span class="line"> <span class="title class_">AsyncParallelHook</span>,</span><br><span class="line"> <span class="title class_">AsyncParallelBailHook</span>,</span><br><span class="line"> <span class="title class_">AsyncSeriesHook</span>,</span><br><span class="line"> <span class="title class_">AsyncSeriesBailHook</span>,</span><br><span class="line"> <span class="title class_">AsyncSeriesWaterfallHook</span></span><br><span class="line"> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1593818478/Webpack/1722383f5f4bb210_t1mdv0.webp" alt="tapable"></p><h4 id="simple-implementation-of-a"><a class="markdownIt-Anchor" href="#simple-implementation-of-a"></a> Simple implementation of a</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Hook</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">args</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">taps</span> = []</span><br><span class="line">        <span class="title class_">This</span>. interceptors = [] <span class="comment">// this for the back</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_args</span> = args </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">tap</span>(<span class="params">name,fn</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">taps</span>.<span class="title function_">push</span>(&#123;name,fn&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SyncHook</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Hook</span>&#123;</span><br><span class="line">    <span class="title function_">call</span>(<span class="params">name,fn</span>)&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">taps</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">tap</span> =&gt;</span> tap.<span class="title function_">fn</span>(name))</span><br><span class="line">            <span class="title function_">fn</span>(<span class="literal">null</span>,name)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="title function_">fn</span>(error)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Copy</span> the code</span><br></pre></td></tr></table></figure><h4 id="how-does-tapable-associate-webapckwebpack-plugins"><a class="markdownIt-Anchor" href="#how-does-tapable-associate-webapckwebpack-plugins"></a> How does tapable associate webapck/webpack plugins?</h4><p><strong>Compiler.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">AsyncSeriesHook</span> ,<span class="title class_">SyncHook</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>);</span><br><span class="line"><span class="comment">//Create a class</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Compiler</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">hooks</span> = &#123;</span><br><span class="line">           <span class="title class_">Run</span>: <span class="keyword">new</span> <span class="title class_">AsyncSeriesHook</span> ([<span class="string">&quot;compiler &quot;</span>]), <span class="comment">// asynchronous hook</span></span><br><span class="line">           <span class="title class_">Compile</span>: <span class="keyword">new</span> <span class="title class_">SyncHook</span> ([<span class="string">&quot;params&quot;</span>]),<span class="comment">//sync hook</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">run</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="comment">//perform asynchronous hook</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">run</span>.<span class="title function_">callAsync</span>(<span class="variable language_">this</span>, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">         <span class="variable language_">this</span>.<span class="title function_">compile</span>(onCompiled);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">compile</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="title class_">Execute</span> synchronization hook and pass parameters</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">hooks</span>.<span class="property">compile</span>.<span class="title function_">call</span>(params);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">Compiler</span></span><br></pre></td></tr></table></figure><p><strong>MyPlugin.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Compiler</span> = <span class="built_in">require</span>(<span class="string">&#x27;./Compiler&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyPlugin</span>&#123;</span><br><span class="line">    <span class="title class_">Apply</span> (compiler) &#123;<span class="comment">//Accept compiler parameters</span></span><br><span class="line">        compiler.<span class="property">hooks</span>.<span class="property">run</span>.<span class="title function_">tap</span>(<span class="string">&quot;MyPlugin&quot;</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;开始编译...&#x27;</span>));</span><br><span class="line">        <span class="comment">//Add a method in the run phase</span></span><br><span class="line">        compiler.<span class="property">hooks</span>.<span class="property">complier</span>.<span class="title function_">tapAsync</span>(<span class="string">&#x27;MyPlugin&#x27;</span>, <span class="function">(<span class="params">name, age</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">Console</span>.<span class="property">log</span> (<span class="string">&#x27;compiling...&#x27;</span>)</span><br><span class="line">          &#125;, <span class="number">1000</span>)</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//Add method in compier stage</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//This is similar to the plugins configuration of webpack.config.js</span></span><br><span class="line"><span class="comment">//pass a new instance to the plugins property</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myPlugin = <span class="keyword">new</span> <span class="title class_">MyPlugin</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">    <span class="attr">plugins</span>: [myPlugin]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> compiler = <span class="keyword">new</span> <span class="title class_">Compiler</span>(options)</span><br><span class="line">compiler.<span class="title function_">run</span>()</span><br></pre></td></tr></table></figure><p>If you want to learn more about’tapable ', you can take a look at this article:</p><p>'Webpack4 ‘core module’tapable’ source code parsing: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.cnblogs.com/tugenhua0707/p/11317557.html">https://www.cnblogs.com/tugenhua0707/p/11317557.html</a></p><h2 id="summary"><a class="markdownIt-Anchor" href="#summary"></a> Summary</h2><p>In general, the packaging of webpack is divided into several stages, similar to the life cycle. Events can be issued at the beginning and end of each life cycle. The loader is used in the compile stage to compile files of the type we specify.</p><p>So as mentioned earlier, the build process of webpack is event-based. For webpack, its event issuance and subscription depend on the Tapable class. Our Plugin is actually a Tapable class, and the compiler we use Or compilation is the built-in Plugin.</p><p>We can use the apply and plugin methods of the Tapable class to issue and subscribe to events. Since complier itself is a Tapable, it can apply and plugin events itself, and we add function to complier hooks through a method similar to tap, which is equivalent to listening to the event issued by the hooks.</p><p>Reference article:</p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://juejin.im/post/5dcaa685f265da4d2375a162">webpack构建流程分析</a></p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://juejin.im/post/5cede821f265da1bbd4b5630">webpack 中那些最易混淆的 5 个知识点</a></p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://juejin.im/post/5ec169786fb9a043721b46ad">揭秘webpack插件工作流程和原理</a></p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.jianshu.com/p/2995fbf92e66">webpack插件编写及原理解析</a></p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/posts/c267222/" title="Introduction to the Webpack Build Process">https://sunra.top/en/posts/c267222/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/posts/1bcc6f4f/" rel="prev" title="Azure Basic Concepts Compendium"><i class="fa fa-chevron-left"></i> Azure Basic Concepts Compendium</a></div><div class="post-nav-item"> <a href="/en/posts/e5782665/" rel="next" title="Proxy 与 Vue">Proxy 与 Vue<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" integrity="sha256-hLTCMFlKxdNgPXyWlSSxYN0ykJmxxq9Yt3MNfdRGWeA=" crossorigin="anonymous"><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/posts/c267222/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>