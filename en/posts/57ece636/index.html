<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="With the gradual improvement of the development of the Internet system and the improvement of the system’s qps, most of the current systems have increased the caching mechanism to avoid excessive requ"><meta property="og:type" content="article"><meta property="og:title" content="Three Problems with Caching Systems"><meta property="og:url" content="https://sunra.top/en/posts/57ece636/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="With the gradual improvement of the development of the Internet system and the improvement of the system’s qps, most of the current systems have increased the caching mechanism to avoid excessive requ"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2019-12-27T14:40:10.000Z"><meta property="article:modified_time" content="2025-06-10T14:30:04.065Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://sunra.top/en/posts/57ece636/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/posts/57ece636/","path":"posts/57ece636/","title":"Three Problems with Caching Systems"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Three Problems with Caching Systems | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#cache-avalanche"><span class="nav-number">1.</span> <span class="nav-text">Cache avalanche</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#definition"><span class="nav-number">1.1.</span> <span class="nav-text">Definition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#solution"><span class="nav-number">1.2.</span> <span class="nav-text">Solution</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#thread-mutual-exclusion"><span class="nav-number">1.2.1.</span> <span class="nav-text">Thread mutual exclusion</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#staggered-failure-time"><span class="nav-number">1.2.2.</span> <span class="nav-text">Staggered failure time</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#downgrade"><span class="nav-number">1.2.3.</span> <span class="nav-text">Downgrade</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fusing"><span class="nav-number">1.2.4.</span> <span class="nav-text">Fusing</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#limited-viewership-of"><span class="nav-number">1.2.5.</span> <span class="nav-text">Limited viewership of</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cache-penetration"><span class="nav-number">2.</span> <span class="nav-text">Cache penetration</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#definition-2"><span class="nav-number">2.1.</span> <span class="nav-text">Definition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#solution-2"><span class="nav-number">2.2.</span> <span class="nav-text">Solution</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#bloom-filter"><span class="nav-number">2.2.1.</span> <span class="nav-text">Bloom filter</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#principle"><span class="nav-number">2.2.1.1.</span> <span class="nav-text">Principle</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#how-to-choose-the-number-of-hash-functions-and-bloom-filter-length"><span class="nav-number">2.2.1.2.</span> <span class="nav-text">How to choose the number of hash functions and bloom filter length</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cache-breakdown"><span class="nav-number">3.</span> <span class="nav-text">Cache breakdown</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#definition-3"><span class="nav-number">3.1.</span> <span class="nav-text">Definition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#solution-3"><span class="nav-number">3.2.</span> <span class="nav-text">Solution</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#level-2-cache"><span class="nav-number">3.2.1.</span> <span class="nav-text">Level 2 cache</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/posts/57ece636/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Three Problems with Caching Systems | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Three Problems with Caching Systems</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2019-12-27 22:40:10" itemprop="dateCreated datePublished" datetime="2019-12-27T22:40:10+08:00">2019-12-27</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2025-06-10 22:30:04" itemprop="dateModified" datetime="2025-06-10T22:30:04+08:00">2025-06-10</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Sundry/" itemprop="url" rel="index"><span itemprop="name">Sundry</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/posts/57ece636/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/posts/57ece636/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>With the gradual improvement of the development of the Internet system and the improvement of the system’s qps, most of the current systems have increased the caching mechanism to avoid excessive requests and direct database operations, resulting in system bottlenecks, greatly improving User Experience and system stability.</p><p>While caching brings performance improvements, it also has some problems.</p><span id="more"></span><h2 id="cache-avalanche"><a class="markdownIt-Anchor" href="#cache-avalanche"></a> Cache avalanche</h2><h3 id="definition"><a class="markdownIt-Anchor" href="#definition"></a> Definition</h3><p>Cache avalanche refers to the situation where the cache server is restarted or a large number of caches are concentrated in a certain period of time, causing instantaneous load increase pressure on the backend database, or even crushing the database.</p><h3 id="solution"><a class="markdownIt-Anchor" href="#solution"></a> Solution</h3><h4 id="thread-mutual-exclusion"><a class="markdownIt-Anchor" href="#thread-mutual-exclusion"></a> Thread mutual exclusion</h4><p>Only one thread is allowed to build the cache, and the other threads wait for the thread that built the cache to finish executing before retrieving data from the cache. Only one thread is executing the request at each time, which relieves the pressure on db, but the disadvantage is also obvious, reducing the system’s qps.</p><h4 id="staggered-failure-time"><a class="markdownIt-Anchor" href="#staggered-failure-time"></a> Staggered failure time</h4><p>This method is relatively simple and crude time, since the failure at the same time will cause too many requests avalanche, then we staggered different failure time can avoid this problem from a certain length, when the cache failure time setting, from a random time in the appropriate value range as the failure time.</p><h4 id="downgrade"><a class="markdownIt-Anchor" href="#downgrade"></a> Downgrade</h4><p>For the overall service, when the overall load exceeds the overall load capacity, delay or suspend non-important services, such as log collection services, to ensure the normal operation of important services.</p><h4 id="fusing"><a class="markdownIt-Anchor" href="#fusing"></a> Fusing</h4><p>For a single service, when a service is overloaded, a protective measure is adopted to prevent the failure of the entire system. Directly close the service (more violent) or ensure that part of the request succeeds, and the other part directly returns failure (does not occupy service resources), eg. If the number of consecutive request failures reaches 20 times within 5 seconds, then trigger the circuit breaker mechanism to filter 60% of the requests.</p><h4 id="limited-viewership-of"><a class="markdownIt-Anchor" href="#limited-viewership-of"></a> Limited viewership of</h4><p>Limit viewership of can be considered a kind of service degradation, limit viewership of is to limit the amount of access to the system has reached the purpose of shielding system.</p><p>Common limited viewership of algorithms are: counter, leaky bucket and token bucket algorithm.</p><p>** Counter: **</p><p>A typical application scenario is to stipulate that only a fixed number of requests are allowed to pass within a fixed time. For example, only 100 requests are allowed to be processed in one minute.</p><ul><li><p>** Basic idea **: There is a counter. When a request arrives, first determine whether it is in a new time period. If it is in a new time period, you can clear the counter to 0, and then add one to the count of the current request. If it is not in the new time period, determine whether the number of current counters exceeds the specified number, such as 100. If it exceeds, the request will be discarded, otherwise add one to the counter to allow the request to pass.</p></li><li><p>** There is a problem **: The accuracy is not enough, and the requests are not evenly distributed. When in the critical section of time, problems may occur. For example, if it is stipulated to process 100 requests a minute, there will be 100 requests in the first second, which will also cause system stress, and the system will be idle for the next 59 seconds.</p></li></ul><p>** Leaky cylinder algorithm: **</p><ul><li>a leaky bucket of fixed capacity, with droplets flowing out at a constant fixed rate;</li><li>If the bucket is empty, there is no need for droplets to flow out;</li><li>Can flow water droplets into leaky buckets at any rate;</li><li>If the inflow droplet exceeds the capacity of the bucket, the inflow droplet overflows (is discarded) and the leaking bucket capacity is unchanged.</li></ul><p>** Token bucket algorithm: **</p><p>A bucket with a fixed capacity of tokens, and tokens are added to the bucket at a fixed rate.</p><ul><li>Tokens will be placed in the token bucket at a fixed rate. For example 10 per second.</li><li>A maximum of b tokens are stored in the bucket, and when the bucket is full, the newly added tokens are discarded or rejected.</li><li>When a data packet of n bytes arrives, n tokens are removed from the bucket, and the data packet is sent to the network.</li><li>If there are less than n tokens in the bucket, the tokens will not be deleted and the data packet will be limited viewership of (either discarded or buffered waiting).</li></ul><h2 id="cache-penetration"><a class="markdownIt-Anchor" href="#cache-penetration"></a> Cache penetration</h2><h3 id="definition-2"><a class="markdownIt-Anchor" href="#definition-2"></a> Definition</h3><p>Cache penetration refers to the use of non-existent keys for a large number of highly concurrent queries, which leads to cache misses, and each request must penetrate to the backend Database System for queries, causing excessive pressure on the database and even crushing the database service.</p><h3 id="solution-2"><a class="markdownIt-Anchor" href="#solution-2"></a> Solution</h3><p>We usually cache the null value. When we receive the same query request again, if it hits the cache and the value is empty, it will return directly, and will not pass-through to the database to avoid cache penetration. Of course, sometimes malicious attackers can guess that we use this scheme, and we will use different parameters to query each time, which requires us to filter the input parameters. For example, if we use ID to query, we can analyze the format of the ID. If it does not meet the rules for generating the ID, it will be rejected directly, or put time information on the ID, and judge whether the ID is legal or whether it is the ID we have generated according to the time information, so that certain invalid requests can be intercepted.</p><p>Of course, a more common solution is to use a Bloom filter</p><h4 id="bloom-filter"><a class="markdownIt-Anchor" href="#bloom-filter"></a> Bloom filter</h4><h5 id="principle"><a class="markdownIt-Anchor" href="#principle"></a> Principle</h5><p>When an element is added to the set, the K hash function maps the element to K points in a bit array and sets them to 1. When searching, we only need to see if these points are all 1 to know (approximately) whether it is in the set: if these points have any zeros, the checked element must not be there; if they are all 1, the checked element is likely to be there. This is the basic idea of Bloom filter.</p><p>Assuming that we now have a blom filter with size = 10000, what is assigned to us is actually 10000 binary bits. Assuming ‘k = 8’, then when the new element’huyanshi ‘is added, through 8 different’hash functions’, you can get 8 index values, assuming it is’ 1,2300,222,11… ', we will set the position of these 8 indices as subscripts to 1.</p><p>When we want to retrieve whether’huyanshi 'exists, we use 8 hash functions again to obtain 8 indices. If the position of these 8 indices is 1, then this element is very likely to exist. If one of them is 0, then the element must not exist.</p><p>The principle of Bloom filter is relatively simple, but the main difficulty is how to design an array of reasonable length and how to design multiple hash functions to map the data to the entire array.</p><h5 id="how-to-choose-the-number-of-hash-functions-and-bloom-filter-length"><a class="markdownIt-Anchor" href="#how-to-choose-the-number-of-hash-functions-and-bloom-filter-length"></a> How to choose the number of hash functions and bloom filter length</h5><p>Obviously, if the Bloom filter is too small, all bits will be 1 soon, so any query value will return “may exist”, which will not serve the purpose of filtering. The length of the Bloom filter will directly affect the false positive rate, and the longer the Bloom filter, the smaller the false positive rate.</p><p>In addition, the number of hash functions also needs to be weighed. The more the number, the faster the speed of the Bloom filter bit position 1, and the lower the efficiency of the Bloom filter; but if it is too small, then our false positive rate will become higher.</p><p>How to choose the k and m values suitable for the business? Here is a formula directly posted:</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mo>=</mo><mo>−</mo><mo stretchy="false">(</mo><mi>n</mi><mo>∗</mo><mi>l</mi><mi>n</mi><mi>p</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>l</mi><mi>n</mi><mn>2</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">m = -(n * lnp) / (ln2)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">n</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">n</span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>k</mi><mo>=</mo><mo stretchy="false">(</mo><mi>m</mi><mi mathvariant="normal">/</mi><mi>n</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>l</mi><mi>n</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">k = (m /n) * ln2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">n</span><span class="mord">2</span></span></span></span></span></p><p>K is the number of hash functions, m is the length of the Bloom filter, n is the number of elements inserted, and p is the false positive rate</p><h2 id="cache-breakdown"><a class="markdownIt-Anchor" href="#cache-breakdown"></a> Cache breakdown</h2><h3 id="definition-3"><a class="markdownIt-Anchor" href="#definition-3"></a> Definition</h3><p>Cache breakdown refers to the use of non-existent keys for a large number of highly concurrent queries, which leads to cache misses, and each request must be broken down to the backend Database System for queries, causing excessive pressure on the database and even crushing the database service. ** The difference between this and cache avalanche is that here is a cache for a certain key, while the former is a lot of keys **.</p><h3 id="solution-3"><a class="markdownIt-Anchor" href="#solution-3"></a> Solution</h3><h4 id="level-2-cache"><a class="markdownIt-Anchor" href="#level-2-cache"></a> Level 2 cache</h4><p>For hotspot data level 2 cache, and for different levels of cache set different expiration time, the request will not directly penetrate the cache layer reaches the database.</p><p>These solutions already have relatively mature third-party packages that can be called.</p><p>Reference article:</p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://juejin.im/post/5b604b9ef265da0f62639001">https://juejin.im/post/5b604b9ef265da0f62639001</a></p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://zhuanlan.zhihu.com/p/43263751">https://zhuanlan.zhihu.com/p/43263751</a></p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/posts/57ece636/" title="Three Problems with Caching Systems">https://sunra.top/en/posts/57ece636/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/posts/303b575/" rel="prev" title="NAT and Intranet Penetration"><i class="fa fa-chevron-left"></i> NAT and Intranet Penetration</a></div><div class="post-nav-item"> <a href="/en/posts/aee1d6ef/" rel="next" title="Vue-test-utils">Vue-test-utils<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" integrity="sha256-hLTCMFlKxdNgPXyWlSSxYN0ykJmxxq9Yt3MNfdRGWeA=" crossorigin="anonymous"><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/posts/57ece636/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>