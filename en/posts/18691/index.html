<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="OverviewDue to the wide variety of I&#x2F;O devices, the functions and transmission rates vary greatly, so the need for a variety of methods to control the device, these methods together constitute the ope"><meta property="og:type" content="article"><meta property="og:title" content="Operating System Learning Notes (8) I&#x2F;O Management Subsystem"><meta property="og:url" content="https://sunra.top/en/posts/18691/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="OverviewDue to the wide variety of I&#x2F;O devices, the functions and transmission rates vary greatly, so the need for a variety of methods to control the device, these methods together constitute the ope"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642160906/origin-of-ray/asynccode_fnjgcu.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642160936/origin-of-ray/asynccode_tvqeud.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642161250/origin-of-ray/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20220114195347_sle5nu.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642160963/origin-of-ray/asynccode_yrffju.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642160986/origin-of-ray/asynccode_ep2j2u.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642161118/origin-of-ray/asynccode_z1kip3.png"><meta property="article:published_time" content="2022-01-14T11:46:59.000Z"><meta property="article:modified_time" content="2024-02-07T08:11:31.227Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642160906/origin-of-ray/asynccode_fnjgcu.png"><link rel="canonical" href="https://sunra.top/en/posts/18691/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/posts/18691/","path":"posts/18691/","title":"Operating System Learning Notes (8) I/O Management Subsystem"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Operating System Learning Notes (8) I/O Management Subsystem | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Overview"><span class="nav-number">1.</span> <span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#I-O-scheduling"><span class="nav-number">2.</span> <span class="nav-text">I&#x2F;O scheduling</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cache-and-buffer"><span class="nav-number">3.</span> <span class="nav-text">Cache and buffer</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Disk-cache"><span class="nav-number">3.1.</span> <span class="nav-text">Disk cache</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Buffer-zone"><span class="nav-number">3.2.</span> <span class="nav-text">Buffer zone</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Single-buffer"><span class="nav-number">3.2.1.</span> <span class="nav-text">Single buffer</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Double-buffering"><span class="nav-number">3.2.2.</span> <span class="nav-text">Double buffering</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Cyclic-buffering"><span class="nav-number">3.2.3.</span> <span class="nav-text">Cyclic buffering</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Buffer-pool"><span class="nav-number">3.2.4.</span> <span class="nav-text">Buffer pool</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Comparison-of-cache-and-buffer"><span class="nav-number">3.3.</span> <span class="nav-text">Comparison of cache and buffer</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Equipment-distribution-and-recycling"><span class="nav-number">4.</span> <span class="nav-text">Equipment distribution and recycling</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Equipment-distribution-overview"><span class="nav-number">4.1.</span> <span class="nav-text">Equipment distribution overview</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Data-structure-for-device-allocation"><span class="nav-number">4.2.</span> <span class="nav-text">Data structure for device allocation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Device-allocation-strategy"><span class="nav-number">4.3.</span> <span class="nav-text">Device allocation strategy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Security-of-device-allocation"><span class="nav-number">4.4.</span> <span class="nav-text">Security of device allocation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Logical-device-name-to-physical-device-name-mapping"><span class="nav-number">4.5.</span> <span class="nav-text">Logical device name to physical device name mapping</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SPOOLing-technology-spooler-technology"><span class="nav-number">5.</span> <span class="nav-text">SPOOLing technology (spooler technology)</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/posts/18691/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Operating System Learning Notes (8) I/O Management Subsystem | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Operating System Learning Notes (8) I/O Management Subsystem</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2022-01-14 19:46:59" itemprop="dateCreated datePublished" datetime="2022-01-14T19:46:59+08:00">2022-01-14</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2024-02-07 16:11:31" itemprop="dateModified" datetime="2024-02-07T16:11:31+08:00">2024-02-07</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/posts/18691/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/posts/18691/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Due to the wide variety of I/O devices, the functions and transmission rates vary greatly, so the need for a variety of methods to control the device, these methods together constitute the operating system kernel I/O subsystem, it will be the other aspects of the kernel from the heavy I/O Facility Management freed.</p><span id="more"></span><p>The main services provided by the I/O core subsystem are:</p><ul><li>I/O Dispatching</li><li>Buffering and Cache</li><li>Equipment distribution and recycling</li><li>Spooled</li><li>Equipment protection</li><li>Error handling</li></ul><h2 id="I-O-scheduling"><a href="#I-O-scheduling" class="headerlink" title="I/O scheduling"></a>I/O scheduling</h2><p>The order of system calls issued by applications is not necessarily the best choice, so I/O scheduling is needed to improve overall system performance, so that device access is fairly shared between processes, and the average latency required for I/O is reduced.</p><p>Operating system developers implement scheduling by maintaining a request queue for each device. When an application executes a blocking I/O system call, requests are added to the queue of the corresponding device.</p><p>I/O scheduling rearranges scheduling order to improve overall system efficiency and the average response time of applications.</p><p>The I/O subsystem can also use storage space techniques on main memory or disk, such as buffering, caching, spooling, etc., to improve computer efficiency</p><p>Disk scheduling algorithm is a kind of I/O scheduling.</p><h2 id="Cache-and-buffer"><a href="#Cache-and-buffer" class="headerlink" title="Cache and buffer"></a>Cache and buffer</h2><h3 id="Disk-cache"><a href="#Disk-cache" class="headerlink" title="Disk cache"></a>Disk cache</h3><p>The operating system uses disk caching technology to improve disk I/O speed, and the access to cache replication is faster than the original data source access. For example, running process instructions are stored both on disk and in physical memory, and are also copied to the CPU’s second-level and first-level caches.</p><p>However, the disk cache is different from the usual sense of a small-capacity high-speed memory between the CPU and the memory, but refers to the use of memory storage space to temporarily store information in a series of disk blocks read out from the disk.</p><p>Therefore, the disk cache belongs to the disk logically, and is a disk block that resides in memory physically.</p><p>Cache is divided into two forms in memory.</p><p>One is to open up a separate piece of storage space in memory as a disk cache, with a fixed size;</p><p>The other is to use the unused Memory Space as a buffer pool for the request paging system and disk I/O to share.</p><h3 id="Buffer-zone"><a href="#Buffer-zone" class="headerlink" title="Buffer zone"></a>Buffer zone</h3><p>In the Facility Management subsystem, the main purpose of introducing buffers is as follows:</p><ul><li>Mitigate speed mismatch between CPU and I/O devices.</li><li>Reduce CPU interrupt frequency and relax restrictions on CPU interrupt response time.</li><li>Resolve basic data unit size mismatch issue<br>Improve parallelism between CPU and I/O devices</li></ul><p>This is achieved as follows:</p><ul><li>The use of hardware buffers, but the cost is too high, only in some key parts of the use.</li><li>Using buffer (in memory)</li></ul><p>Buffer has a feature, that is, when the buffer data is not empty, it cannot be flushed into the data like the buffer, and can only read data from the buffer. When the buffer is empty, you can flush data into the buffer, but you must fill the buffer before you can read data from it.</p><p>According to the number of buffers set by the system, the buffering technology can be divided into the following types:</p><h4 id="Single-buffer"><a href="#Single-buffer" class="headerlink" title="Single buffer"></a>Single buffer</h4><p>A buffer is provided between the device and the processor. When the device and the processor exchange data, the exchanged data is first written into the buffer, and then the device or processor that needs the data removes the data from it.</p><p>When the block device input, it is assumed that a piece of data from the disk input buffer time T, the operating system to remove data from the time M, CPU processing time of this piece of data is C.</p><p>When we study the time for each piece of data to be processed by various buffering techniques, we assume an initial state, and then calculate the time to reach the same state next time, which is the time to process a piece of data (if not explicitly stated, it is generally considered that the buffer size is the same as the workspace).</p><p>We assume that T &gt; C, the initial state workspace is full and the buffer is empty.</p><p>When the workspace has finished processing the data, the time is C, but the buffer is not yet full.</p><p>Wait until the buffer is full, from time T, stop flushing data.</p><p>Then the data from the buffer into the work area, with M, when the work area is full, the buffer is empty, to the next state, this brother process with M + T.</p><p>If T &lt; C, similarly, the time is M + C</p><p>Therefore, the time for single-buffer processing of each piece of data is max (C, T) + M.</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642160906/origin-of-ray/asynccode_fnjgcu.png" alt="img"></p><h4 id="Double-buffering"><a href="#Double-buffering" class="headerlink" title="Double buffering"></a>Double buffering</h4><p>According to the single buffering feature, the CPU is idle during the transmission time M, thereby introducing double buffering</p><p>We assume that the initial state is that the workspace is empty, where one buffer is full and the other is empty, and can be calculated again.</p><p>We divide the discussion into two cases: T &lt; M + C and T &gt; M + C.</p><p>The conclusion is that the time for double buffering to process a piece of data is max (C + M, T).</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642160936/origin-of-ray/asynccode_tvqeud.png" alt="img"></p><p>If T &gt; M + C, we can use the block device for continuous input; if T &lt; M + C, we can make the CPU not have to wait for device input.</p><p>For character devices, if line input is used, double buffering may be used after the user inputs the first line, when the CPU executes the first line command, the user may input the next line of data to the second buffer.</p><p>If only a single buffer is set between two machines, they can only achieve one-way data transmission at any time. In order to achieve bidirectional data transmission, another buffer must be set, one as the send buffer and the other as the receive buffer.</p><h4 id="Cyclic-buffering"><a href="#Cyclic-buffering" class="headerlink" title="Cyclic buffering"></a>Cyclic buffering</h4><p>Contains multiple buffers of the same size, each buffer has a linked pointer to the next buffer, the last buffer points to the first buffer, and multiple buffers form a ring.</p><p>When the circular buffer is used for input and output, two pointers in and out are also required. For input, data is first received from the device into the buffer, with the in pointer pointing to the first empty buffer where data can be input and the out pointer pointing to the first full buffer where data can be extracted. Output is the opposite (?).</p><h4 id="Buffer-pool"><a href="#Buffer-pool" class="headerlink" title="Buffer pool"></a>Buffer pool</h4><p>It consists of buffers common to multiple systems. Buffers can be divided into three queues according to their usage.</p><ul><li>Empty buffer queue</li><li>Buffer queue filled with input data (input queue)</li><li>Buffer queue full of output data (output queue)</li></ul><p>There should also be four types of buffers:</p><ul><li>Working buffer for holding input data</li><li>Working buffer for extracting input data</li><li>Working buffer for holding output data</li><li>Working buffer for extracting output data</li></ul><p>When the input process needs to input data, an empty buffer is removed from the head of the empty buffer queue as a working buffer for accommodating input, and then input data into it, and then hang to the end of the input queue after being filled.</p><p>When the calculation process needs to input data, a buffer is obtained from the input queue as a working buffer for extracting input data, and the empty buffer queue is returned to the end of the queue after the extraction is completed.</p><h3 id="Comparison-of-cache-and-buffer"><a href="#Comparison-of-cache-and-buffer" class="headerlink" title="Comparison of cache and buffer"></a>Comparison of cache and buffer</h3><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642161250/origin-of-ray/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20220114195347_sle5nu.png" alt></p><h2 id="Equipment-distribution-and-recycling"><a href="#Equipment-distribution-and-recycling" class="headerlink" title="Equipment distribution and recycling"></a>Equipment distribution and recycling</h2><h3 id="Equipment-distribution-overview"><a href="#Equipment-distribution-overview" class="headerlink" title="Equipment distribution overview"></a>Equipment distribution overview</h3><p>Device allocation refers to the allocation of the required equipment according to the user’s I/O requests. The general principle of allocation is to give full play to the efficiency of the equipment, keep the equipment as busy as possible, and avoid process deadlock caused by unreasonable allocation methods.</p><p>From the perspective of device characteristics, devices using the following three usage methods are called exclusive devices, shared devices, and virtual devices.</p><ul><li>Exclusive use of equipment</li><li>Time-sharing devices, such as disk I/O, each I/O operation request of each process can be alternated through time-sharing</li><li>Use external devices in the SPOOLing way. This technology was introduced in the era of batch processing operating systems, that is, spooled I/O technology. The operation of this technology on the device is actually batch processing of I/O operations, which is a space-for-time technology.</li></ul><h3 id="Data-structure-for-device-allocation"><a href="#Data-structure-for-device-allocation" class="headerlink" title="Data structure for device allocation"></a>Data structure for device allocation</h3><p>The main data structures based on device allocation are device control table (DCT), controller control table (COCT), channel control table (CHCT) and system device table (SDT).</p><p>Device Control Table (DCT): We can think that a device control table symbolizes a device, and the entry of this control table is the various properties of the device. As shown in Figure</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642160963/origin-of-ray/asynccode_yrffju.png" alt="img"></p><p>We have learned four kinds of I/O control methods before, and the channel mode is obviously superior to other methods. Therefore, the I/O control of modern operating systems adopts channel control.</p><p>The device controller controls the exchange of data between the device and the memory, and the device controller needs to request the channel to serve it, so each COCT must have a table entry to store a pointer to the corresponding channel control table (CHCT), and a channel can be used for multiple Device controller services, so there must be a pointer in CHCT pointing to a table, and the information on this table expresses the device controllers that CHCT provides services. The relationship between CHCT and COCT is a one-to-many relationship.</p><p>System Device Table (SDT): There is only one SDT in the entire system, which records the situation of all physical devices connected to the system, and each physical device occupies an entry.</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642160986/origin-of-ray/asynccode_ep2j2u.png" alt="img"></p><p>Since the number of processes is more than the number of resources in a multiprogram system, it will cause competition for resources, so there must be a set of reasonable allocation principles. The main considerations are: the inherent properties of I/O devices, the allocation of I/O devices algorithm, the security of I/O device allocation, and the independence of I/O devices.</p><h3 id="Device-allocation-strategy"><a href="#Device-allocation-strategy" class="headerlink" title="Device allocation strategy"></a>Device allocation strategy</h3><ol><li>Equipment allocation principle. Equipment allocation should be based on equipment characteristics, user requirements and system configuration. The general principle of allocation is: not only to give full play to the efficiency of the equipment, but also to avoid causing process deadlock. It is also necessary to isolate user programs from specific devices.</li><li>Device allocation method. There are two types: static allocation and dynamic allocation.</li></ol><p>Static allocation is mainly used for the allocation of exclusive devices. It allocates all the devices, controllers (such as channels, etc.) required by the job at one time before the user’s job starts to execute. Once allocated, these devices, controllers (and channels) remain owned by the job until the job is revoked. Static allocation does not deadlock, but is inefficient and does not meet the general principle.</p><p>Dynamic allocation is allocated according to needs during the execution of the process, and dynamic allocation requires appropriate allocation algorithms.</p><ol><li>Device allocation algorithm. Common dynamic device allocation algorithm has first request first allocation, higher priority and so on.</li></ol><p>Here you can contact the critical quota in process scheduling, how to avoid deadlock, such as banker algorithm?</p><h3 id="Security-of-device-allocation"><a href="#Security-of-device-allocation" class="headerlink" title="Security of device allocation"></a>Security of device allocation</h3><p>Refers to the fact that deadlocks should be avoided during equipment allocation</p><ol><li>Safe allocation method. Every time a process issues an I/O request, it enters a blocking state and is not woken up until other I/O operations are completed. In this way, once a process obtains a certain device, it is blocked and cannot request any resources, and it is blocked. No resources are kept. The advantage is that device allocation is safe, but CPU and I/O are serial (for the same process).</li><li>Unsafe allocation method. The process continues to run after issuing an I/O request, and issues a second or third I/O request when needed. It only enters a blocking state when the device requested by the process is already occupied by another process. The advantage is that multiple devices can be operated at the same time, thus advancing the process quickly. The disadvantage is that there may be deadlocks (because resources are not released when entering a block).</li></ol><h3 id="Logical-device-name-to-physical-device-name-mapping"><a href="#Logical-device-name-to-physical-device-name-mapping" class="headerlink" title="Logical device name to physical device name mapping"></a>Logical device name to physical device name mapping</h3><p>In order to improve the flexibility of device allocation and device utilization, and facilitate the realization of I/O Retargeting, device independence is introduced. It refers to the independence of the application from the specific physical device used.</p><p>In order to achieve device independence, logical device names are used in the application to request the use of certain types of devices.</p><p>Set up a Logic Unit Table (LUT) in the system to map logical device names to physical device names. The LUT table entry includes logical device names, physical device names, and device driver entry addresses.</p><p>When the process requests the allocation device with a logical device, the system assigns the corresponding physical device to it, and establishes a table entry in the LUT. After the process uses the logical device name to request the I/O operating system, the system finds the corresponding LUT by looking up the corresponding physical device and driver.</p><p>There are two ways to create a LUT:</p><ul><li>Set only one LUT in the entire system. Mainly suitable for single-user systems</li><li>One LUT per user. When a user logs in, the system creates a process and a LUT for the user, and stores the LUT in the PCB of the process.</li></ul><h2 id="SPOOLing-technology-spooler-technology"><a href="#SPOOLing-technology-spooler-technology" class="headerlink" title="SPOOLing technology (spooler technology)"></a>SPOOLing technology (spooler technology)</h2><p>In order to alleviate the contradiction between the high speed of CPU and the low speed of I/O devices, offline I/O technology is introduced.</p><p>This technology utilizes specialized peripheral controllers to transfer data from low-speed I/O devices to high-speed disks, or vice versa.</p><p>SPOOLing means that external devices operate online at the same time, also known as spooled input/output operation, which is a technology used in the operating system to transform an exclusive device into a shared device.</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1642161118/origin-of-ray/asynccode_z1kip3.png" alt="img"></p><ol><li>Input and output wells</li></ol><p>An input well and an output well refer to two storage areas opened up on a disk. The input well simulates the disk when the offline input is used to house the data input by the I/O device. The output well simulates the disk when the offline output is used to house the output data of the user program.</p><ol><li>Input buffer and output buffer</li></ol><p>Are two buffers created in memory. The input buffer is used to temporarily store data sent by the input device and then sent to the input well. The output buffer is used to temporarily store data sent from the output well and then sent to the output device.</p><ol><li>Input process and output process</li></ol><p>The input process simulates offline input. It is a peripheral control machine that sends the data requested by the user from the input machine through the input buffer to the input well. When the CPU needs input data, it directly reads the data from the input well into memory.</p><p>The output process simulates the peripheral control machine when the output is offline, and sends the data required by the user to the output well from the memory first. When the output device is idle, the data in the output well is sent to the output device through the output buffer</p><p>Why go from the input machine to the input buffer (memory) to the input well (disk), and then read the memory from the disk when the CPU needs it, and go around?</p><p>In order that the CPU may not currently need this data, enter it in advance, okay?</p><p>Shared printers are an example of the use of SPOOLing technology, which has been widely used in multi-user systems and local area networks. When a user process requests print output, the SPOOLing system agrees to print, but instead of immediately assigning the printer to the user process, it does two things for it.</p><ul><li>The output process requests a free disk block for it in the output well and sends the data to be printed</li><li>The output process then applies for a blank user request print table for the user process, fills in the user’s print request, and then hangs the table in the request print queue.</li></ul></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/posts/18691/" title="Operating System Learning Notes (8) I&#x2F;O Management Subsystem">https://sunra.top/en/posts/18691/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/posts/3683/" rel="prev" title="Operating System Learning Notes (7) Overview of I/O Management"><i class="fa fa-chevron-left"></i> Operating System Learning Notes (7) Overview of I/O Management</a></div><div class="post-nav-item"> <a href="/en/posts/45016/" rel="next" title="Async in Unity">Async in Unity<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/en/js/third-party/math/mathjax.js"></script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/posts/18691/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>