<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="Basic knowledgeFirst, let’s review the knowledge of operating systems, namely:  Why do the concepts of processes and threads appear, and what problems do they appear to solve? Concepts and definitions"><meta property="og:type" content="article"><meta property="og:title" content="How to understand multithreading in JS"><meta property="og:url" content="https://sunra.top/en/posts/54454/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="Basic knowledgeFirst, let’s review the knowledge of operating systems, namely:  Why do the concepts of processes and threads appear, and what problems do they appear to solve? Concepts and definitions"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1667742557/origin-of-ray/d7uwzsgurkb9f4gvvpnu.png"><meta property="article:published_time" content="2022-11-06T12:02:58.000Z"><meta property="article:modified_time" content="2023-08-26T09:54:52.880Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1667742557/origin-of-ray/d7uwzsgurkb9f4gvvpnu.png"><link rel="canonical" href="https://sunra.top/en/posts/54454/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/posts/54454/","path":"posts/54454/","title":"How to understand multithreading in JS"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>How to understand multithreading in JS | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Basic-knowledge"><span class="nav-number">1.</span> <span class="nav-text">Basic knowledge</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-origin-of-processes-and-threads"><span class="nav-number">1.1.</span> <span class="nav-text">The origin of processes and threads</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-concept-of-process-and-thread"><span class="nav-number">1.2.</span> <span class="nav-text">The concept of process and thread</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Scheduling-algorithm-for-threads"><span class="nav-number">1.3.</span> <span class="nav-text">Scheduling algorithm for threads</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Synchronization-and-mutual-exclusion"><span class="nav-number">1.4.</span> <span class="nav-text">Synchronization and mutual exclusion</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Software-methods"><span class="nav-number">1.4.1.</span> <span class="nav-text">Software methods</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Hardware-implementation-method"><span class="nav-number">1.4.2.</span> <span class="nav-text">Hardware implementation method</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Mutual-exclusion-mutex"><span class="nav-number">1.4.3.</span> <span class="nav-text">Mutual exclusion (mutex</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Signal-quantity"><span class="nav-number">1.4.4.</span> <span class="nav-text">Signal quantity</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#What-does-four-cores-and-eight-threads-mean"><span class="nav-number">1.5.</span> <span class="nav-text">What does four cores and eight threads mean?</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Understanding-multithreading-in-JS"><span class="nav-number">2.</span> <span class="nav-text">Understanding multithreading in JS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Web"><span class="nav-number">2.1.</span> <span class="nav-text">Web</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JS-has-no-concept-of-thread-synchronization"><span class="nav-number">2.2.</span> <span class="nav-text">JS has no concept of thread synchronization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Chrome-multithreading-model"><span class="nav-number">2.3.</span> <span class="nav-text">Chrome multithreading model</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/posts/54454/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="How to understand multithreading in JS | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> How to understand multithreading in JS</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2022-11-06 20:02:58" itemprop="dateCreated datePublished" datetime="2022-11-06T20:02:58+08:00">2022-11-06</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2023-08-26 17:54:52" itemprop="dateModified" datetime="2023-08-26T17:54:52+08:00">2023-08-26</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/posts/54454/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/posts/54454/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="Basic-knowledge"><a href="#Basic-knowledge" class="headerlink" title="Basic knowledge"></a>Basic knowledge</h2><p>First, let’s review the knowledge of operating systems, namely:</p><ul><li>Why do the concepts of processes and threads appear, and what problems do they appear to solve?</li><li>Concepts and definitions of processes and threads</li><li>Scheduling of threads</li><li>Thread synchronization and mutual exclusion</li><li>Deadlock problem</li></ul><span id="more"></span><h3 id="The-origin-of-processes-and-threads"><a href="#The-origin-of-processes-and-threads" class="headerlink" title="The origin of processes and threads"></a>The origin of processes and threads</h3><p>To explain this problem, from the classification and development process of the operating system, we usually contact more computers are time-sharing systems based on time slice scheduling, but in fact there are many other types of operating systems, time-sharing operation The system is not there from the beginning, and the concept of processes and threads is not there from the beginning.<br>The general development process of the operating system is as follows, we simply understand it:</p><ul><li>Manual operation stage (no operating system in this stage)</li><li>Batch processing operating system<ul><li>Single-channel batch processing system</li><li>Multichannel batch processing system</li></ul></li><li>Time-sharing operating system</li><li>Real-time operating system<ul><li>Hard real-time operating system</li><li>Soft real-time operating system</li></ul></li><li>Network operating systems and distributed operating systems</li></ul><p>The resource scheduling algorithms of different operating systems above are different. For example, the human-hard real-time system is not based on time slice scheduling, but on priority. We mainly focus on the transformation from single-channel operating system to multi-channel operating system.</p><p>For a single-channel operating system, there is no need for the concept of processes and threads, it is to execute jobs in order, and there is no parallel situation of multiple jobs over a period of time.</p><p>Of course, we can also see the problem of single-channel operating systems, that is, the utilization efficiency of various computer resources is very low. For example, when a job is waiting for I/O, the CPU is idle.</p><p>In order to improve the utilization efficiency of various resources, a multi-channel batch processing system is proposed, which is also a very important source of operating system complexity:</p><ul><li>Because to be concurrent, there is a program switch, before switching from the options to select a run, the selection process is scheduling, there are a variety of different scheduling algorithms, such as FCFS, SJF, time slice and so on.</li><li>Because concurrency brings asynchrony, the execution order of each program is uncertain, so it may compete for critical resources. In order to avoid this contention, we propose mutual exclusion; another situation is that we need some Programs are executed in a certain order, so we propose the concept of synchronization.</li><li>Because of the proposal of mutual exclusion, there may be deadlock problems. For example, program A applies for P resources and waits for Q resources, while program B applies for Q resources. However, while waiting for P resources, a circular dependency is formed between A and B. And neither of them is willing to give up the acquired resources, then a deadlock is formed between A and B programs.</li></ul><p>In order to describe the above scheduling, mutual exclusion, synchronization, and deadlock problems, we need to introduce a new concept to describe the state during program execution, and to save the context of execution at that time when the program switches. This concept is the process.</p><p>Then later we found that compared to other resources, CPU resources are scheduled very frequently, so we extracted a concept for CPU scheduling separately, called threads.</p><h3 id="The-concept-of-process-and-thread"><a href="#The-concept-of-process-and-thread" class="headerlink" title="The concept of process and thread"></a>The concept of process and thread</h3><p>So far, we have these concepts:</p><ul><li>Homework: It can be understood as a program on our hard disk that has not been executed yet</li><li>Process: The basic unit of resource scheduling outside of the CPU. When we choose to execute a program, it is to apply for resources such as memory for the job, and then the process will start a thread by default to apply for CPU resources</li><li>Thread: The basic unit of CPU scheduling. Threads of the same process share the same set of resources, such as the same Memory Space, which means that data between threads of the same process can be directly modified</li></ul><p>Threads are divided into kernel-level threads (KLT) and user-level threads (ULT). Kernel-level threads mean that there are really multiple threads in the operating system. The switching of threads requires the context switching of the operating system., the saving and loading of registers, etc., we did switch threads; and the meaning of user-level threads is that the operating system itself does not perceive thread switching at all. We simulated the switching of registers and so on within the thread. Each has its own benefits, the latter is sometimes called coroutine, and its benefits are that switching consumes less and does not require The disadvantage of using the operating system’s interrupt processing for context switching is that it cannot take advantage of multi-core processors, because no matter how many threads you have, it looks like one in the operating system.</p><h3 id="Scheduling-algorithm-for-threads"><a href="#Scheduling-algorithm-for-threads" class="headerlink" title="Scheduling algorithm for threads"></a>Scheduling algorithm for threads</h3><ul><li>FCFS, First-Come First-Service algorithm, is an inalienable algorithm and is not suitable for time-sharing systems and real-time systems. On the surface, it is fair to all jobs, but if a long job arrives in the system first, it will be a short job that waits a long time</li><li>SJF, short job first algorithm. Bad for long jobs and may cause long jobs to be “hungry”</li><li>Priority scheduling algorithm, according to whether the high priority job arrives or interrupts the current job is divided into preemptive and non-preemptive, according to whether the priority can be changed at runtime into static priority and dynamic priority</li><li>High response ratio priority algorithm. Response ratio = (waiting time + requested service time)/requested service time</li><li>Time slice rotation scheduling algorithm.</li><li>Multi-level queue scheduling algorithm. Set multiple queues for different CPUs, each queue adopts a different scheduling algorithm</li><li>Multilevel feedback queue scheduling algorithm</li></ul><h3 id="Synchronization-and-mutual-exclusion"><a href="#Synchronization-and-mutual-exclusion" class="headerlink" title="Synchronization and mutual exclusion"></a>Synchronization and mutual exclusion</h3><p>Synchronization is a direct constraint relationship, such as A is to perform first than B, and mutual exclusion is an indirect constraint relationship, such as A and B have to use the only printer resources, A occupied, B can only block.<br>Basic method of mutual exclusion in critical area</p><h4 id="Software-methods"><a href="#Software-methods" class="headerlink" title="Software methods"></a>Software methods</h4><ol><li>Single marking method</li><li>Double marking method</li><li>Double mark inspection method</li><li>Peterson’s Algorithm<h4 id="Hardware-implementation-method"><a href="#Hardware-implementation-method" class="headerlink" title="Hardware implementation method"></a>Hardware implementation method</h4></li><li>Interrupt masking algorithm: turn off the interrupt, because the CPU can only switch processes when interrupted, and turn off the interrupt can directly prevent all process switching</li><li>Hardware command method: TestAndSet</li></ol><h4 id="Mutual-exclusion-mutex"><a href="#Mutual-exclusion-mutex" class="headerlink" title="Mutual exclusion (mutex"></a>Mutual exclusion (mutex</h4><p>A process acquires a lock when entering the critical section and releases the lock when exiting the critical section</p><h4 id="Signal-quantity"><a href="#Signal-quantity" class="headerlink" title="Signal quantity"></a>Signal quantity</h4><p>The semaphore mechanism is a powerful mechanism that can be used to solve mutual exclusion and synchronization problems. It can only be accessed by the two standard primitives wait and signal, and can also be recorded as P operations and V operations. There are two types:</p><ul><li>Integer semaphore</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wait(S) &#123;</span><br><span class="line">    while(S &lt;=0);</span><br><span class="line">    S = S - 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">signal(S) &#123;</span><br><span class="line">    S = S + 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Recording type semaphore</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">wait(semaphore S) &#123;</span><br><span class="line">    S.value--;</span><br><span class="line">    if (S.value &lt; 0) &#123;</span><br><span class="line">        add this process to S.L;</span><br><span class="line">        block(S.L)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">signal(semaphore S) &#123;</span><br><span class="line">    S.value++;</span><br><span class="line">    if (S.value &lt;= 0) &#123;</span><br><span class="line">        remove a process P from S.L;</span><br><span class="line">        wakeup(P)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="What-does-four-cores-and-eight-threads-mean"><a href="#What-does-four-cores-and-eight-threads-mean" class="headerlink" title="What does four cores and eight threads mean?"></a>What does four cores and eight threads mean?</h3><p>We always mention that a computer has four cores and eight threads. What is this concept?</p><p>As we just mentioned, whether it is a single-channel or multi-channel operating system, its concurrency is based on only one CPU core, that is to say, it can only have one program executing at the same time, and only one program counter.</p><p>We want to achieve the true meaning of multiple programs executed at the same time, the method is more than a few CPU cores, that is, the four cores here.</p><p>Theoretically, four cores could only have four threads in parallel. The reason for the emergence of four cores and eight threads was that two cores were simulated on one core, making the upper-level operating system think it had eight cores, but in fact it was still four cores. This is an implementation of computer virtualization technology.</p><h2 id="Understanding-multithreading-in-JS"><a href="#Understanding-multithreading-in-JS" class="headerlink" title="Understanding multithreading in JS"></a>Understanding multithreading in JS</h2><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><p>After understanding the concept of multi-threading, we can say JS multi-threaded Web Workers.</p><p>HTML5 introduces Web Workers, making JS support threads.</p><p>JS multithreading is OS-level, that is to say, JS multithreading is really multithreading, that is, the kernel-level thread mentioned above.</p><h3 id="JS-has-no-concept-of-thread-synchronization"><a href="#JS-has-no-concept-of-thread-synchronization" class="headerlink" title="JS has no concept of thread synchronization"></a>JS has no concept of thread synchronization</h3><p>JS’s multi-threading cannot operate the DOM. There is no window object, and the data of each thread is independent. The data passed by the main thread to the child thread is copied by copying. The same child thread, the data given to the main thread is also copied by copying, rather than sharing the same memory area.</p><p>From this point of view, the multi-threading of JS does not belong to the same process, or there is an internal isolation mechanism</p><p>So there is basically nothing wrong with Web Workers.</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1667742557/origin-of-ray/d7uwzsgurkb9f4gvvpnu.png" alt></p><p>In the main logic, the calls of fun1 and fun2 are connected together. It is an execution unit that has either not been executed yet or has to be executed in one go. After execution, execute setTimout append to the next one. Then because it has exceeded the 20ms set by setInterval, the setInterval function is executed immediately. Here it can be seen that the timing of setTimeout starts from, the timing starts when the logical unit is executed, and the timing starts when setInterval is executed on this line.</p><p>Single-threaded features such as asynchronous callback, asynchronous callback is Chrome own IO thread, processing, each request must have a thread to follow, Chrome limit the same, the domain can only send up to 6 requests at the same time</p><h3 id="Chrome-multithreading-model"><a href="#Chrome-multithreading-model" class="headerlink" title="Chrome multithreading model"></a>Chrome multithreading model</h3><p>Let’s take a look at Chrome thread pattern from the click event</p><p>Every time a tab is opened, Chrome will create a process, the process is the container of the thread, and the Tab of the same domain name is the same process</p><p>First, the user clicks the mouse, and after the browser’s UI thread receives it, the message data is encapsulated as a mouse event and sent to the IO thread, which is then assigned to the rendering thread of the specific page. Among them, the IO thread and the UI thread are the browser’s threads, and the rendering thread is each page’s own thread.</p><p>If you are executing a time-consuming piece of JS code, the render thread in the render thread will be blocked, and the main thread will continue to receive messages from the IO thread and queue up, waiting for the render thread to process. That is to say, when the page is stuck, keep clicking the mouse, wait for the page to be idle, and the clicked event will continue to trigger.</p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/posts/54454/" title="How to understand multithreading in JS">https://sunra.top/en/posts/54454/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/posts/26901/" rel="prev" title="Redux Source Code Analysis"><i class="fa fa-chevron-left"></i> Redux Source Code Analysis</a></div><div class="post-nav-item"> <a href="/en/posts/10746/" rel="next" title="Difference between Set, Map and Object in JavaScript">Difference between Set, Map and Object in JavaScript<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2023</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/en/js/third-party/math/mathjax.js"></script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/posts/54454/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>