<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="Recently, I want to use Docker, and I found a few entry-level blogs in the evening, summarizing and practicing."><meta property="og:type" content="article"><meta property="og:title" content="Docker Introduction Notes"><meta property="og:url" content="https://sunra.top/en/posts/6b3a9e14/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="Recently, I want to use Docker, and I found a few entry-level blogs in the evening, summarizing and practicing."><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2020-05-29T22:26:32.000Z"><meta property="article:modified_time" content="2024-08-27T11:53:56.858Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://sunra.top/en/posts/6b3a9e14/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/posts/6b3a9e14/","path":"posts/6b3a9e14/","title":"Docker Introduction Notes"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Docker Introduction Notes | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#basic-concepts"><span class="nav-number">1.</span> <span class="nav-text">Basic concepts</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#the-problem-of-environment-configuration"><span class="nav-number">1.1.</span> <span class="nav-text">The problem of environment configuration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#virtual-machine"><span class="nav-number">1.2.</span> <span class="nav-text">Virtual machine</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#linux"><span class="nav-number">1.3.</span> <span class="nav-text">Linux</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker"><span class="nav-number">1.4.</span> <span class="nav-text">Docker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-2"><span class="nav-number">1.5.</span> <span class="nav-text">Docker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#image"><span class="nav-number">1.6.</span> <span class="nav-text">image</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#example-hello"><span class="nav-number">1.7.</span> <span class="nav-text">Example: hello</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#container-file"><span class="nav-number">1.8.</span> <span class="nav-text">Container file</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dockerfile"><span class="nav-number">1.9.</span> <span class="nav-text">Dockerfile</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#practice"><span class="nav-number">2.</span> <span class="nav-text">Practice</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#building-web-services"><span class="nav-number">2.1.</span> <span class="nav-text">Building web services</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#build-mirroring"><span class="nav-number">2.2.</span> <span class="nav-text">Build mirroring</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#build-the-first"><span class="nav-number">2.3.</span> <span class="nav-text">Build the first</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#command-discrimination-1-run-cmd-entrypoint"><span class="nav-number">2.4.</span> <span class="nav-text">Command discrimination 1: RUN, CMD, ENTRYPOINT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#command-discrimination-2-add-copy"><span class="nav-number">2.5.</span> <span class="nav-text">Command discrimination 2: ADD, COPY</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#more-docker-commands"><span class="nav-number">2.6.</span> <span class="nav-text">More docker commands</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/posts/6b3a9e14/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Docker Introduction Notes | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Docker Introduction Notes</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-05-30 06:26:32" itemprop="dateCreated datePublished" datetime="2020-05-30T06:26:32+08:00">2020-05-30</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2024-08-27 19:53:56" itemprop="dateModified" datetime="2024-08-27T19:53:56+08:00">2024-08-27</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Sundry/" itemprop="url" rel="index"><span itemprop="name">Sundry</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/posts/6b3a9e14/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/posts/6b3a9e14/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>Recently, I want to use Docker, and I found a few entry-level blogs in the evening, summarizing and practicing.</p><span id="more"></span><h2 id="basic-concepts"><a class="markdownIt-Anchor" href="#basic-concepts"></a> Basic concepts</h2><h3 id="the-problem-of-environment-configuration"><a class="markdownIt-Anchor" href="#the-problem-of-environment-configuration"></a> The problem of environment configuration</h3><p>One of the biggest hassles in software development is environment configuration. The environments of users’ computers are different. How do you know which machines your software will run on?</p><p>Users must ensure two things: the settings of the operating system, and the installation of various libraries and components. Only if they are correct can the software run. For example, to install a Python application, the computer must have a Python engine, various dependencies, and possibly configure environment variables.</p><p>If some old modules are not compatible with the current environment, it will be troublesome. Developers often say “It works on my machine”, which means that other machines are likely not to run.</p><p>Configuring the environment was so troublesome that it would take time to do it all over again when changing a machine. Many people thought, can the problem be fundamentally solved, and the software can be installed with the environment? That is to say, when installing, copy the original environment exactly.</p><h3 id="virtual-machine"><a class="markdownIt-Anchor" href="#virtual-machine"></a> Virtual machine</h3><p>Virtual machine (virtual machine) is a solution with environment installation. It can run another operating system within one operating system, such as Windows system running Linux system. The application has no awareness of this, because the virtual machine looks exactly like the real system, while for the underlying system, the virtual machine is just an ordinary file that can be deleted without any effect on other parts.</p><p>Although users can restore the original environment of the software through virtual machines. However, this solution has several drawbacks.</p><p>** (1) Too much resource occupation **</p><p>The virtual machine monopolizes a portion of memory and hard disk space. When it runs, other programs cannot use these resources. Even if the applications in the virtual machine actually use only 1MB of memory, the virtual machine still needs several hundred MB of memory to run.</p><p>** (2) Multiple redundant steps **</p><p>Virtual machines are complete operating systems, and some system-level operation steps often cannot be skipped, such as user login.</p><p>** (3) Slow startup **</p><p>As long as it takes to start the operating system, it takes to start the virtual machine. It may take several minutes for the application to actually run.</p><h3 id="linux"><a class="markdownIt-Anchor" href="#linux"></a> Linux</h3><p>Because of these shortcomings, Linux developed another virtualization technology: Linux Containers (LXC).</p><p>** Linux container does not simulate a complete operating system, but isolates processes. ** In other words, it sets a<a target="_blank" rel="external nofollow noopener noreferrer" href="https://opensource.com/article/18/1/history-low-level-container-runtimes">保护层</a>For the process inside the container, the various resources it touches are virtual, thus achieving isolation from the underlying system.</p><p>Since containers are process-level, they have many advantages over virtual machines.</p><p>** (1) Start fast **</p><p>The application inside the container is directly a process of the underlying system, not a process inside the virtual machine. Therefore, starting the container is equivalent to starting a process on the local machine, instead of starting an operating system, which is much faster.</p><p>** (2) Low resource usage **</p><p>Containers only occupy the resources they need, not those that are not used; Since virtual machines are complete operating systems, they inevitably occupy all resources. In addition, multiple containers can share resources, and virtual machines are exclusive resources.</p><p>** (3) Small size **</p><p>The container only needs to contain the components used, and the virtual machine is the packaging of the entire operating system, so the container file is much smaller than the virtual machine file.</p><p>In short, containers are a bit like lightweight virtual machines that can provide a virtualized environment, but at a much lower cost.</p><h3 id="docker"><a class="markdownIt-Anchor" href="#docker"></a> Docker</h3><p>** Docker is an encapsulation of Linux containers, providing a simple and easy-to-use container interface. ** It is currently the most popular Linux container solution.</p><p>Docker packages the application and its dependencies in a file. Running this file will generate a virtual container. The program runs in this virtual container as if it were running on a real physical machine. With Docker, there is no need to worry about environmental issues.</p><p>Overall, Docker’s interface is quite simple. Users can easily create and use containers and put their own applications into containers. Containers can also be version managed, copied, shared, and modified, just like managing ordinary code.</p><h3 id="docker-2"><a class="markdownIt-Anchor" href="#docker-2"></a> Docker</h3><p>There are currently three main categories of Docker’s main uses.</p><p>** (1) Provide a one-time environment. ** For example, provide Unit Test and build environments when testing other people’s software locally and continuous integration.</p><p>** (2) Provide elastic Cloud as a Service. ** Because Docker containers can be turned on and off, they are very suitable for dynamic scaling and shrinking.</p><p>** (3) Set up a micro-service structure. ** Through multiple containers, a machine can run multiple services, so the micro-service structure can be simulated locally.</p><h3 id="image"><a class="markdownIt-Anchor" href="#image"></a> image</h3><p>** Docker packages the application and its dependencies in an image file. ** Only through this file can a Docker container be generated. The image file can be seen as a template for the container. Docker generates container instances from the image file. The same image file can generate multiple container instances running simultaneously.</p><p>Image is a binary file. In actual development, an image file is often generated by inheriting another image file and adding some personalized settings. For example, you can add an Apache server to it on the basis of Ubuntu image to form your image.</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure></blockquote><p>Image files are universal, and the image files from one machine are copied to another machine and can still be used. Generally speaking, in order to save time, we should try to use image files made by others instead of making them ourselves. Even if you want to customize, you should process based on other people’s image files instead of making them from scratch.</p><p>In order to facilitate sharing, after the image file is created, it can be uploaded to the online repository. Docker’s official repository <a target="_blank" rel="external nofollow noopener noreferrer" href="https://hub.docker.com/">Docker Hub</a> It is the most important and commonly used image repository. In addition, it is possible to sell image files made by yourself.</p><h3 id="example-hello"><a class="markdownIt-Anchor" href="#example-hello"></a> Example: hello</h3><p>Below we go through the simplest image file &quot;<a target="_blank" rel="external nofollow noopener noreferrer" href="https://hub.docker.com/r/library/hello-world/">hello world&quot;</a>Get a feel for Docker.</p><p>It should be noted that the domestic official repository connected to Docker is very slow and will be disconnected. You need to change the default repository to the domestic mirroring website. The specific modification method is in<a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html">下一篇文章</a>The first section of. Friends in need, you can take a look first.</p><p>First, run the following command to grab the image file from the repository to local.</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$</span><br></pre></td></tr></table></figure></blockquote><p>In the above code, ‘docker image pull’ is the command to grab the image file. ‘library/hello-world’ is the location of the image file in the repository, where’library ‘is the group where the image file is located, and’hello-world’ is the name of the image file.</p><p>Due to the image files officially provided by Docker, they are all placed in<a target="_blank" rel="external nofollow noopener noreferrer" href="https://hub.docker.com/r/library/"><code>library</code></a>Group, so it’s the default group and can be omitted. Therefore, the above command can be written like this.</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$</span><br></pre></td></tr></table></figure></blockquote><p>After the capture is successful, you can see the image file locally.</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$</span><br></pre></td></tr></table></figure></blockquote><p>Now run this image file.</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$</span><br></pre></td></tr></table></figure></blockquote><p>The docker container run command generates a running container instance from the image file.</p><p>Note that the’docker container run ‘command has the function of automatically crawling image files. If no image file is found locally, it will be automatically crawled from the repository. Therefore, the previous’docker image pull’ command is not a necessary step.</p><p>If it runs successfully, you will read the following output on the screen.</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$</span><br><span class="line"></span><br><span class="line">Hello</span><br><span class="line">This</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure></blockquote><p>After outputting this prompt, ‘hello world’ will stop running and the container will automatically terminate.</p><p>Some containers do not automatically terminate because they provide services. For example, installing and running Ubuntu image can experience the Ubuntu system from the command line.</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$</span><br></pre></td></tr></table></figure></blockquote><p>For those containers that do not automatically terminate, you must use<a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.docker.com/engine/reference/commandline/container_kill/"><code>docker container kill</code></a> Command to terminate manually.</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$</span><br></pre></td></tr></table></figure></blockquote><h3 id="container-file"><a class="markdownIt-Anchor" href="#container-file"></a> Container file</h3><p>** The container instance generated by the image file is itself a file, called the container file. ** That is to say, once the container is generated, there will be two files at the same time: the image file and the container file. And closing the container does not delete the container file, it just stops running.</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure></blockquote><p>The output of the above command includes the ID of the container. This ID needs to be provided in many places, such as the’docker container kill 'command to terminate the container operation in the previous section.</p><p>The terminated container file will still occupy hard disk space and can be used<a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.docker.com/engine/reference/commandline/container_rm/"><code>docker container rm</code></a>Command to delete.</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$</span><br></pre></td></tr></table></figure></blockquote><p>After running the above command, using the command’docker container ls --all ', you will find that the deleted container file has disappeared.</p><h3 id="dockerfile"><a class="markdownIt-Anchor" href="#dockerfile"></a> Dockerfile</h3><p>After learning to use image files, the next question is, how can you generate image files? If you want to promote your own software, it is necessary to make your own image files.</p><p>This requires the use of the Dockerfile. It is a text file used to configure image. Docker generates a binary image file from this file.</p><h2 id="practice"><a class="markdownIt-Anchor" href="#practice"></a> Practice</h2><h3 id="building-web-services"><a class="markdownIt-Anchor" href="#building-web-services"></a> Building web services</h3><p>First, we need to pull centos mirroring.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 80 --name web -i -t centos /bin/bash</span><br><span class="line">Copy the code</span><br></pre></td></tr></table></figure><p>Next, we install the nginx server and execute the following command:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</span><br><span class="line">Copy the code</span><br></pre></td></tr></table></figure><p>After installing the Nginx source, you can officially install Nginx.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install -y nginx</span><br><span class="line">Copy the code</span><br></pre></td></tr></table></figure><p>At this point, we can enter the command’whereis nginx 'to see the installation path. Finally, we also need to run Nginx.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nginx</span><br><span class="line">Copy the code</span><br></pre></td></tr></table></figure><p>Now, we do’ctrl + P + Q ‘to switch to the background. Then, use’docker ps -a’ to see the randomly assigned ports.</p><p>Then access <a target="_blank" rel="external nofollow noopener noreferrer" href="http://127.0.0.1">http://127.0.0.1</a>: Random Port Number through the browser.</p><h3 id="build-mirroring"><a class="markdownIt-Anchor" href="#build-mirroring"></a> Build mirroring</h3><p>There are two ways to build mirroring in Docker. One way is to use the’docker commit ‘command, and the other way is to use the’docker build’ command and the’Dockerfile ‘file. Among them, it is not recommended to use the’docker commit’ command for building because it does not standardize the whole process. Therefore, it is more recommended to use the’docker build ‘command and the’Dockerfile’ file to build our mirroring in enterprises. We use the’Dockerfile 'file to make building mirroring more repeatable, while ensuring standardization of startup scripts and running programs.</p><h3 id="build-the-first"><a class="markdownIt-Anchor" href="#build-the-first"></a> Build the first</h3><p>Now, let’s move on to the actual combat. Here, we build a mirroring from the web server we set up at the beginning. First, we need to create an empty Dokcerfile file.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir dockerfile_test</span><br><span class="line">cd dockerfile_test/</span><br><span class="line">touch Dockerfile</span><br><span class="line">nano Dockerfile</span><br><span class="line">Copy the code</span><br></pre></td></tr></table></figure><p>Next, we need to write a Dockerfile with the following code listing</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FROM centos:7</span><br><span class="line">MAINTAINER LiangGzone &quot;lianggzone@163.com&quot;</span><br><span class="line">RUN rpm -ivh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</span><br><span class="line">RUN yum install -y nginx</span><br><span class="line">EXPOSE 80</span><br><span class="line">Copy the code</span><br></pre></td></tr></table></figure><p>Finally, we build with the’docker build 'command.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker build -t=&quot;lianggzone/nginx_demo:v1&quot; .</span><br><span class="line">Copy the code</span><br></pre></td></tr></table></figure><p>We can take a look at our new mirroring with docker images.</p><p>Now, let’s understand the whole process. First, ‘FROM centos: 7’ is the first step that Dockerfile must take. It will run a container from an existing mirroring. In other words, Docker needs to rely on a base mirroring for building. Here, we specify centos as the base mirroring, and its version is 7 (CentOS 7). Then, we specify the author of the mirroring as LiangGzone and the mailbox as <a href="mailto:lianggzone@163.com" rel="external nofollow noopener noreferrer" target="_blank">lianggzone@163.com</a> through’MAINTAINER LiangGzone “<a href="mailto:lianggzone@163.com" rel="external nofollow noopener noreferrer" target="_blank">lianggzone@163.com</a>”. This helps to tell the user its author and contact information. Next, we execute two RUN commands to download and install Nginx, and finally expose port 80 of the Dokcer container through’EXPOSE 80 '. Note that the execution order of Docker is executed from top to bottom, so we need to clarify the execution order of the entire process. In addition, Docker creates a new mirroring layer and commits after each instruction.</p><p>We use the’docker build ‘command to build, specifying’ -t ‘to tell Docker the name and version of mirroring. Note that if no tag is specified, Docker will automatically set a lastest tag for mirroring. Another point, we have a final’. 'to let Docker go to the current local directory to find the Dockerfile file. Note that Docker commits the result as mirroring at each build step, and then treats the previous mirroring layer as a cache, so when we rebuild a similar mirroring layer, we will directly reuse the previous mirroring. If we need to skip, we can use the ‘–no-cache’ option to tell Docker not to cache.</p><h3 id="command-discrimination-1-run-cmd-entrypoint"><a class="markdownIt-Anchor" href="#command-discrimination-1-run-cmd-entrypoint"></a> Command discrimination 1: RUN, CMD, ENTRYPOINT</h3><p>The purposes of the three instructions’RUN ‘,’ CMD ‘, and’ENTRYPOINT’ are very familiar. The difference is that the’RUN ‘instruction is a command to run when the container is built, while’CMD’ and’ENTRYPOINT ‘execute shell commands when the container is started, and’RUN’ will be overwritten by the’docker run ‘command, but’ENTRYPOINT’ will not be overwritten. In fact, any arguments specified by the’docker run ‘command will be passed to the’ENTRYPOINT’ instruction again as arguments. The’CMD ‘and’ENTRYPOINT’ directives can also be used together. For example, we can use the exec form of’ENTRYPOINT ‘to set fixed default commands and parameters, and then use either form of’CMD’ to set other default values that may change.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu</span><br><span class="line">ENTRYPOINT [&quot;top&quot;, &quot;-b&quot;]</span><br><span class="line">CMD [&quot;-c&quot;]</span><br><span class="line">Copy the code</span><br></pre></td></tr></table></figure><h3 id="command-discrimination-2-add-copy"><a class="markdownIt-Anchor" href="#command-discrimination-2-add-copy"></a> Command discrimination 2: ADD, COPY</h3><p>The’ADD ‘and’COPY’ directives are used in the same way, the only difference is that’ADD ‘supports extracting and decompressing archive files (tar, gzip, bzip2, etc.). Note that the directory that the’COPY’ directive needs to copy must be placed in the same directory as the Dockerfile file.</p><h3 id="more-docker-commands"><a class="markdownIt-Anchor" href="#more-docker-commands"></a> More docker commands</h3><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.docker.com/engine/reference/commandline/docker/">https://docs.docker.com/engine/reference/commandline/docker/</a></p><p>Reference link:</p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://juejin.im/post/5cacbfd7e51d456e8833390c">https://juejin.im/post/5cacbfd7e51d456e8833390c</a></p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html">https://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html</a></p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/posts/6b3a9e14/" title="Docker Introduction Notes">https://sunra.top/en/posts/6b3a9e14/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/posts/e438c689/" rel="prev" title="TamperMonkey"><i class="fa fa-chevron-left"></i> TamperMonkey</a></div><div class="post-nav-item"> <a href="/en/posts/5f68736a/" rel="next" title="Nodejs Asynchronous IO and Event Driven">Nodejs Asynchronous IO and Event Driven<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" integrity="sha256-hLTCMFlKxdNgPXyWlSSxYN0ykJmxxq9Yt3MNfdRGWeA=" crossorigin="anonymous"><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/posts/6b3a9e14/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>