<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="During the few days when everyone was happy, Google released two docs, which I feel is very necessary to know as a programmer and engineer. After reading, the author intercepted some of the original t"><meta property="og:type" content="article"><meta property="og:title" content="codereview"><meta property="og:url" content="https://sunra.top/en/posts/1f2e7416/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="During the few days when everyone was happy, Google released two docs, which I feel is very necessary to know as a programmer and engineer. After reading, the author intercepted some of the original t"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2019-10-05T03:46:37.000Z"><meta property="article:modified_time" content="2024-10-18T04:06:20.611Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://sunra.top/en/posts/1f2e7416/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/posts/1f2e7416/","path":"posts/1f2e7416/","title":"codereview"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>codereview | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#the"><span class="nav-number">1.</span> <span class="nav-text">The</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#writing"><span class="nav-number">1.1.</span> <span class="nav-text">Writing</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#first"><span class="nav-number">1.1.1.</span> <span class="nav-text">First</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#body"><span class="nav-number">1.1.2.</span> <span class="nav-text">Body</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#bad"><span class="nav-number">1.1.3.</span> <span class="nav-text">Bad</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#good"><span class="nav-number">1.1.4.</span> <span class="nav-text">Good</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#functionality"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">Functionality</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#small"><span class="nav-number">1.2.</span> <span class="nav-text">Small</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#why"><span class="nav-number">1.2.1.</span> <span class="nav-text">Why</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#what"><span class="nav-number">1.2.2.</span> <span class="nav-text">What</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#when"><span class="nav-number">1.2.3.</span> <span class="nav-text">When</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#splitting"><span class="nav-number">1.2.3.1.</span> <span class="nav-text">Splitting</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#separate"><span class="nav-number">1.2.3.2.</span> <span class="nav-text">Separate</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#keep"><span class="nav-number">1.2.3.3.</span> <span class="nav-text">Keep</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#dont"><span class="nav-number">1.2.3.4.</span> <span class="nav-text">Don’t</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#cant"><span class="nav-number">1.2.3.5.</span> <span class="nav-text">Can’t</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#how"><span class="nav-number">1.3.</span> <span class="nav-text">How</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#dont-2"><span class="nav-number">1.3.1.</span> <span class="nav-text">Don’t</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fix"><span class="nav-number">1.3.2.</span> <span class="nav-text">Fix</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#think"><span class="nav-number">1.3.3.</span> <span class="nav-text">Think</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#resolving"><span class="nav-number">1.3.4.</span> <span class="nav-text">Resolving</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#how-2"><span class="nav-number">2.</span> <span class="nav-text">How</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#the-2"><span class="nav-number">2.1.</span> <span class="nav-text">The</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#mentoring"><span class="nav-number">2.1.1.</span> <span class="nav-text">Mentoring</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#principles"><span class="nav-number">2.1.2.</span> <span class="nav-text">Principles</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#what-2"><span class="nav-number">2.2.</span> <span class="nav-text">What</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#design"><span class="nav-number">2.2.1.</span> <span class="nav-text">Design</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#functionality-2"><span class="nav-number">2.2.2.</span> <span class="nav-text">Functionality</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#complex"><span class="nav-number">2.2.3.</span> <span class="nav-text">Complex</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tests"><span class="nav-number">2.2.4.</span> <span class="nav-text">Tests</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#naming"><span class="nav-number">2.2.5.</span> <span class="nav-text">Naming</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#comments"><span class="nav-number">2.2.6.</span> <span class="nav-text">Comments</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#style"><span class="nav-number">2.2.7.</span> <span class="nav-text">Style</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#documentation"><span class="nav-number">2.2.8.</span> <span class="nav-text">Documentation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#every"><span class="nav-number">2.2.9.</span> <span class="nav-text">Every</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#context"><span class="nav-number">2.2.10.</span> <span class="nav-text">Context</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#good-2"><span class="nav-number">2.2.11.</span> <span class="nav-text">Good</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#summary"><span class="nav-number">2.2.12.</span> <span class="nav-text">Summary</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#navigating"><span class="nav-number">2.3.</span> <span class="nav-text">Navigating</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#speed"><span class="nav-number">2.4.</span> <span class="nav-text">Speed</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#why-2"><span class="nav-number">2.4.1.</span> <span class="nav-text">Why</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#how-3"><span class="nav-number">2.5.</span> <span class="nav-text">How</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/posts/1f2e7416/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="codereview | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> codereview</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2019-10-05 11:46:37" itemprop="dateCreated datePublished" datetime="2019-10-05T11:46:37+08:00">2019-10-05</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2024-10-18 12:06:20" itemprop="dateModified" datetime="2024-10-18T12:06:20+08:00">2024-10-18</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Sundry/" itemprop="url" rel="index"><span itemprop="name">Sundry</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/posts/1f2e7416/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/posts/1f2e7416/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>During the few days when everyone was happy, Google released two docs, which I feel is very necessary to know as a programmer and engineer. After reading, the author intercepted some of the original text and simplified some other parts to summarize.</p><span id="more"></span><h2 id="the"><a class="markdownIt-Anchor" href="#the"></a> The</h2><p>Simply put, it is the CL author guide to guide through code review. So what does CL mean? It means change list, change record and log.</p><p>This guide can help you complete code reviews faster and obtain higher quality results. For every Google developer, reading this guide is very helpful.</p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://google.github.io/eng-practices/review/developer/">https://google.github.io/eng-practices/review/developer/</a></p><h3 id="writing"><a class="markdownIt-Anchor" href="#writing"></a> Writing</h3><h4 id="first"><a class="markdownIt-Anchor" href="#first"></a> First</h4><ul><li>Short summary of what is being done.</li><li>Complete sentence, written as though it was an order.</li><li>Follow by empty line.</li></ul><p>First of all, the first line of the CL should preferably be a short description of what was done, followed by a blank line, and second, it should be written as imperative, of course the following part may not need to be written like this.</p><h4 id="body"><a class="markdownIt-Anchor" href="#body"></a> Body</h4><p>The rest of the description should be informative. It may include a brief description of the problem to be solved and why this is the best approach. If there are any shortcomings in the approach, it should be mentioned. If relevant, please include background information such as error numbers, benchmark results, and a link to the design doc…</p><h4 id="bad"><a class="markdownIt-Anchor" href="#bad"></a> Bad</h4><p>“Fix bug” is an inadequate CL description. What bug? What did you do to fix it? Other similarly bad descriptions include:</p><ul><li>“Fix build.”</li><li>“Add patch.”</li><li>“Moving code from A to B.”</li><li>“Phase 1.”</li><li>“Add convenience functions.”</li><li>“kill weird URLs.”</li></ul><p>Some of those are real CL descriptions. Their authors may believe they are providing useful information, but they are not serving the purpose of a CL description.</p><h4 id="good"><a class="markdownIt-Anchor" href="#good"></a> Good</h4><p>Here are some examples of good descriptions.</p><h5 id="functionality"><a class="markdownIt-Anchor" href="#functionality"></a> Functionality</h5><blockquote><p>rpc:</p><p>Servers</p></blockquote><p>The first few words describe what the CL actually does. The rest of the description talks about the problem being solved, why this is a good solution, and a bit more information about the specific implementation.</p><p>There are many good examples of CL in the doc, you can take a look for yourself. At the same time, remember that CL is preferably all English.</p><h3 id="small"><a class="markdownIt-Anchor" href="#small"></a> Small</h3><h4 id="why"><a class="markdownIt-Anchor" href="#why"></a> Why</h4><ul><li><strong>Reviewed more quickly.</strong> It’s easier for a reviewer to find five minutes several times to review small CLs than to set aside a 30 minute block to review one large CL.</li><li><strong>Reviewed more thoroughly.</strong> With large changes, reviewers and authors tend to get frustrated by large volumes of detailed commentary shifting back and forth—sometimes to the point where important points get missed or dropped.</li><li><strong>Less likely to introduce bugs.</strong> Since you’re making fewer changes, it’s easier for you and your reviewer to reason effectively about the impact of the CL and see if a bug has been introduced.</li><li><strong>Less wasted work if they are rejected.</strong> If you write a huge CL and then your reviewer says that the overall direction is wrong, you’ve wasted a lot of work.</li><li><strong>Easier to merge.</strong> Working on a large CL takes a long time, so you will have lots of conflicts when you merge, and you will have to merge frequently.</li><li><strong>Easier to design well.</strong> It’s a lot easier to polish the design and code health of a small change than it is to refine all the details of a large change.</li><li><strong>Less blocking on reviews.</strong> Sending self-contained portions of your overall change allows you to continue coding while you wait for your current CL in review.</li><li><strong>Simpler to roll back.</strong> A large CL will more likely touch files that get updated between the initial CL submission and a rollback CL, complicating the rollback (the intermediate CLs will probably need to be rolled back too).</li></ul><p>Simply put, it is easier to know what you are doing with each commit, so that when you have a problem, you can quickly locate the problem, and if the problem needs to be rolled back, it will not be affected by the existing code.</p><h4 id="what"><a class="markdownIt-Anchor" href="#what"></a> What</h4><p>In general, the right size for a CL is <strong>one self-contained change</strong>. This means that:</p><ul><li>The CL makes a minimal change that addresses <strong>just one thing</strong>. This is usually just one part of a feature, rather than a whole feature at once. In general it’s better to err on the side of writing CLs that are too small vs. CLs that are too large. Work with your reviewer to find out what an acceptable size is.</li><li>Everything the reviewer needs to understand about the CL (except future development) is in the CL, the CL’s description, the existing codebase, or a CL they’ve already reviewed.</li><li>The system will continue to work well for its users and for the developers after the CL is checked in.</li><li>The CL is not so small that its implications are difficult to understand. If you add a new API, you should include a usage of the API in the same CL so that reviewers can better understand how the API will be used. This also prevents checking in unused APIs.</li></ul><p>For the size of each commit, about 100 lines per commit is a reasonable size, and 1000 lines is too big. But this is not an absolute criterion. If 100 lines of code are distributed in 50 files, it is also a big modification.</p><h4 id="when"><a class="markdownIt-Anchor" href="#when"></a> When</h4><p>There are a few situations in which large changes aren’t as bad:</p><ul><li>You can usually count deletion of an entire file as being just one line of change, because it doesn’t take the reviewer very long to review.</li><li>Sometimes a large CL has been generated by an automatic refactoring tool that you trust completely, and the reviewer’s job is just to sanity check and say that they really do want the change. These CLs can be larger, although some of the caveats from above (such as merging and testing) still apply.</li></ul><h5 id="splitting"><a class="markdownIt-Anchor" href="#splitting"></a> Splitting</h5><p>Relatively independent changes that require different reviewers can be split into different CLs</p><h5 id="separate"><a class="markdownIt-Anchor" href="#separate"></a> Separate</h5><p>It is usually best to refactor in a separate CL without including feature changes or bug fixes. For example, modifying a class and calling it should be placed in two different CLs.</p><h5 id="keep"><a class="markdownIt-Anchor" href="#keep"></a> Keep</h5><p>Try not to put the test code in different CLs, because the test will ensure the correctness of your code, even if the test code may make your submission huge.</p><p>However, we can put independent tests into a separate CL, for example:</p><ul><li>validating pre-existing, submitted code with new tests.</li><li>refactoring the test code (e.g. introduce helper functions).</li><li>introducing larger test framework code (e.g. an integration test).</li></ul><h5 id="dont"><a class="markdownIt-Anchor" href="#dont"></a> Don’t</h5><p>If multiple CLs will depend on each other, it is best to ensure that the system can operate normally after each CL is submitted for modification.</p><h5 id="cant"><a class="markdownIt-Anchor" href="#cant"></a> Can’t</h5><h3 id="how"><a class="markdownIt-Anchor" href="#how"></a> How</h3><p>When you’ve sent a CL out for review, it’s likely that your reviewer will respond with several comments on your CL. Here are some useful things to know about handling reviewer comments.</p><h4 id="dont-2"><a class="markdownIt-Anchor" href="#dont-2"></a> Don’t</h4><p>The goal of review is to maintain the quality of our codebase and our products. When a reviewer provides a critique of your code, think of it as their attempt to help you, the codebase, and Google, rather than as a personal attack on you or your abilities.</p><p>In other words, try not to add your own negative emotions to the code review process. If someone adds negative emotions to your code review process, first consider what they really want to say, and then find a way to communicate with them privately, such as an interview or email.</p><h4 id="fix"><a class="markdownIt-Anchor" href="#fix"></a> Fix</h4><p>If the reviewer doesn’t understand your code, then you should find a way to explain what your code is doing. Because your reviewer can’t understand it, other colleagues may not understand it in the future.</p><h4 id="think"><a class="markdownIt-Anchor" href="#think"></a> Think</h4><p>Because we may spend a lot of time on each submission, when we see reviewers give us comments, our first reaction is to reject.</p><p>But we’d better first consider whether the reviewer’s opinion is correct. If we can’t answer this question, we may need to find the reviewer to make his point clear, and then judge.</p><h4 id="resolving"><a class="markdownIt-Anchor" href="#resolving"></a> Resolving</h4><p>Your first step in resolving conflicts should always be to try to come to consensus with your reviewer. If you can’t achieve consensus, see <a target="_blank" rel="external nofollow noopener noreferrer" href="https://google.github.io/eng-practices/review/reviewer/standard.html">The Standard of Code Review</a>, which gives principles to follow in such a situation.</p><h2 id="how-2"><a class="markdownIt-Anchor" href="#how-2"></a> How</h2><p>This doc contains advice on the best way to conduct code reviews. It is a very complete doc, divided into many separate sections. Reading this doc will definitely be very helpful for everyone, and it is definitely one thing that will benefit everyone a lot.</p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://google.github.io/eng-practices/review/reviewer/">https://google.github.io/eng-practices/review/reviewer/</a></p><h3 id="the-2"><a class="markdownIt-Anchor" href="#the-2"></a> The</h3><p>The main purpose of code review is to ensure that the overall code health of Google’s codebase continues to improve over time.</p><p>First of all, developers must be able to make progress on their tasks. If you have never submitted improvements to the codebase, the codebase will never be improved. Also, if it is difficult for reviewers to make any changes, then developers have no incentive to make improvements in the future.</p><p>On the other hand, the reviewer is responsible for ensuring that the quality of each CL is such that the overall code health of its codebase does not decrease over time.</p><p>Thus, we get the following rule as the standard we expect in code reviews:</p><p><strong>In general, reviewers should favor approving a CL once it is in a state where it definitely improves the overall code health of the system being worked on, even if the CL isn’t perfect.</strong></p><p>That is <em>the</em> senior principle among all of the code review guidelines.</p><h4 id="mentoring"><a class="markdownIt-Anchor" href="#mentoring"></a> Mentoring</h4><p>Code review has an important function that can teach developers new knowledge about languages, frameworks, or general software design principles. It is always good to leave comments that help developers learn new knowledge. Sharing knowledge is part of improving the performance of system code over time.</p><h4 id="principles"><a class="markdownIt-Anchor" href="#principles"></a> Principles</h4><ul><li>Technical facts and data overrule opinions and personal preferences.</li><li>On matters of style, the <a target="_blank" rel="external nofollow noopener noreferrer" href="http://google.github.io/styleguide/">style guide</a> is the absolute authority. Any purely style point (whitespace, etc.) that is not in the style guide is a matter of personal preference. The style should be consistent with what is there. If there is no previous style, accept the author’s.</li><li><strong>Aspects of software design are almost never a pure style issue or just a personal preference.</strong> They are based on underlying principles and should be weighed on those principles, not simply by personal opinion. Sometimes there are a few valid options. If the author can demonstrate (either through data or based on solid engineering principles) that several approaches are equally valid, then the reviewer should accept the preference of the author. Otherwise the choice is dictated by standard principles of software design.</li><li>If no other rule applies, then the reviewer may ask the author to be consistent with what is in the current codebase, as long as that doesn’t worsen the overall code health of the system.</li></ul><h3 id="what-2"><a class="markdownIt-Anchor" href="#what-2"></a> What</h3><h4 id="design"><a class="markdownIt-Anchor" href="#design"></a> Design</h4><p>The most important content in the review is the overall design of CL. Does the interaction of various codes in CL make sense?</p><h4 id="functionality-2"><a class="markdownIt-Anchor" href="#functionality-2"></a> Functionality</h4><p>Does this CL achieve the intended purpose of the developer? What benefits does the developer intend to bring to the users of this code?</p><p>“Users” are usually both end users (when they are affected by changes) and developers (who will have to “use” this code in the future). Usually, we want developers to test the CL well to ensure that they work properly when doing code reviews.</p><p>However, as a reviewer, you should still consider edge cases, look for concurrency issues, try to think like a user, and ensure that there are no errors that you can see just by reading the code.</p><p>You can verify the CL as needed, and the most important time for reviewers to check the behavior of the CL is the impact on users (such as UI changes).</p><p>When you are only reading the code, it is difficult to understand how certain changes will affect users. When making such changes, if it is too cumbersome to patch in CL and try it yourself, you can let the developer demonstrate the feature to you.</p><p>Another time when it is particularly important to consider functionality during code review is whether there is some kind of parallel programming going on in the CL that could theoretically lead to deadlocks or race conditions. Such issues are difficult to detect just by running the code, and usually require someone (developers and reviewers) to carefully consider them to ensure that they do not introduce problems.</p><h4 id="complex"><a class="markdownIt-Anchor" href="#complex"></a> Complex</h4><p>Simply put, don’t overdesign.</p><h4 id="tests"><a class="markdownIt-Anchor" href="#tests"></a> Tests</h4><p>Unit Test, Integration Test, or E2E Test as required by the change. Typically, tests should be added in the same CL as the production code unless the CL handles an emergency. Make sure the tests in the CL are correct, reasonable, and useful. Tests don’t self-test, we rarely write tests for tests - people have to make sure the tests work.</p><h4 id="naming"><a class="markdownIt-Anchor" href="#naming"></a> Naming</h4><p>The name should be long enough until he can fully express what it is or what it wants to do.</p><h4 id="comments"><a class="markdownIt-Anchor" href="#comments"></a> Comments</h4><p>Does the developer write clear comments in understandable English? Are all comments actually necessary? Usually, comments are useful when they explain why certain code exists and should not explain what certain code is doing. If the code is not clear enough to explain itself, the code should be simplified. There are some exceptions (for example, Regular Expression and complex algorithms often benefit greatly from comments explaining their role), but most comments are for information that the code itself may not be able to contain, such as the reason behind the decision.</p><h4 id="style"><a class="markdownIt-Anchor" href="#style"></a> Style</h4><p>Make sure the CL follows the appropriate style guide. If you want to improve a style point that is not in the style guide, preface the comment with “Nit:” to let the developer know that this is an option that you think can improve the code but is not mandatory.</p><p>Authors of CL should not combine major style changes with other changes. This makes it difficult to see changes in CL, makes merging and rollback more complicated, and causes other issues.</p><h4 id="documentation"><a class="markdownIt-Anchor" href="#documentation"></a> Documentation</h4><p>If CL changes the way users build, test, interact with code, or release code, please check if it also updates the relevant doc, including the readme file</p><h4 id="every"><a class="markdownIt-Anchor" href="#every"></a> Every</h4><p>Look at every line of code that has been assigned to you for inspection. Sometimes you can scan data files, generated code, or things like large data structures, but not manually written classes, functions, or Code Blocks and think what’s in them is okay. Obviously, some code needs to be scrutinized more than others - this is a call to judgment you have to make - but you should at least make sure you understand what all the code is doing. If you are having too much difficulty reading the code and are making the review slow, then you should let the developers know this and wait for them to clarify before attempting the review</p><h4 id="context"><a class="markdownIt-Anchor" href="#context"></a> Context</h4><p>Usually, the code review tool will only show you a few lines of code around the part you want to change. Sometimes, you have to look at the entire file to make sure the changes really make sense.</p><h4 id="good-2"><a class="markdownIt-Anchor" href="#good-2"></a> Good</h4><p>If you see something nice in CL, please tell the developer, especially when they answered one of your comments in an excellent way.</p><h4 id="summary"><a class="markdownIt-Anchor" href="#summary"></a> Summary</h4><p>In doing a code review, you should make sure that:</p><ul><li>The code is well-designed.</li><li>The functionality is good for the users of the code.</li><li>Any UI changes are sensible and look good.</li><li>Any parallel programming is done safely.</li><li>The code isn’t more complex than it needs to be.</li><li>The developer isn’t implementing things they <em>might</em> need in the future but don’t know they need now.</li><li>Code has appropriate unit tests.</li><li>Tests are well-designed.</li><li>The developer used clear names for everything.</li><li>Comments are clear and useful, and mostly explain <em>why</em> instead of <em>what</em>.</li><li>Code is appropriately documented (generally in g3doc).</li><li>The code conforms to our style guides.</li></ul><h3 id="navigating"><a class="markdownIt-Anchor" href="#navigating"></a> Navigating</h3><p>Now that you know <a target="_blank" rel="external nofollow noopener noreferrer" href="https://google.github.io/eng-practices/review/reviewer/looking-for.html">what to look for</a>, what’s the most efficient way to manage a review that’s spread across multiple files?</p><ol><li>Does the change make sense? Does it have a good <a target="_blank" rel="external nofollow noopener noreferrer" href="https://google.github.io/eng-practices/review/developer/cl-descriptions.html">description</a>?</li><li>Look at the most important part of the change first. Is it well-designed overall?</li><li>Look at the rest of the CL in an appropriate sequence.</li></ol><h3 id="speed"><a class="markdownIt-Anchor" href="#speed"></a> Speed</h3><h4 id="why-2"><a class="markdownIt-Anchor" href="#why-2"></a> Why</h4><p><strong>At Google, we optimize for the speed at which a team of developers can produce a product together</strong>, as opposed to optimizing for the speed at which an individual developer can write code. The speed of individual development is important, it’s just not <em>as</em> important as the velocity of the entire team.</p><p>When code reviews are slow, several things happen:</p><ul><li><strong>The velocity of the team as a whole is decreased.</strong> Yes, the individual, who doesn’t respond quickly to the review, gets other work done. However, new features and bug fixes for the rest of the team are delayed by days, weeks, or months as each CL waits for review and re-review.</li><li><strong>Developers start to protest the code review process.</strong> If a reviewer only responds every few days, but requests major changes to the CL each time, that can be frustrating and difficult for developers. Often, this is expressed as complaints about how “strict” the reviewer is being. If the reviewer requests the <em>same</em> substantial changes (changes which really do improve code health) but responds <em>quickly</em> every time the developer makes an update, the complaints tend to disappear. <strong>Most complaints about the code review process are actually resolved by making the process faster.</strong></li><li><strong>Code health can be impacted.</strong> When reviews are slow, there is increased pressure to allow developers to submit CLs that are not as good as they could be. Slow reviews also discourage code cleanups, refactorings, and further improvements to existing CLs.</li></ul><h3 id="how-3"><a class="markdownIt-Anchor" href="#how-3"></a> How</h3><ul><li>Be kind.</li><li>Explain your reasoning.</li><li>Balance giving explicit directions with just pointing out problems and letting the developer decide.</li><li>Encourage developers to simplify code or add code comments instead of just explaining the complexity to you.</li></ul></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/posts/1f2e7416/" title="codereview">https://sunra.top/en/posts/1f2e7416/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/posts/861b6bf3/" rel="prev" title="Pay attention to sharing variables when Node processes in parallel"><i class="fa fa-chevron-left"></i> Pay attention to sharing variables when Node processes in parallel</a></div><div class="post-nav-item"> <a href="/en/posts/ce2f5630/" rel="next" title="Iterator">Iterator<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" integrity="sha256-hLTCMFlKxdNgPXyWlSSxYN0ykJmxxq9Yt3MNfdRGWeA=" crossorigin="anonymous"><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/posts/1f2e7416/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>