<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="This week POC several penetration testing tools, namely Burp Suite, OWASP Zap. Many of the features of Burp are charged, and the free version is basically only used for request interception. So finall"><meta property="og:type" content="article"><meta property="og:title" content="Use of Zap and Bugfix"><meta property="og:url" content="https://sunra.top/en/posts/527c5341/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="This week POC several penetration testing tools, namely Burp Suite, OWASP Zap. Many of the features of Burp are charged, and the free version is basically only used for request interception. So finall"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1604662591/Security/WeChat_Screenshot_20201106193621_gkboit.png"><meta property="article:published_time" content="2020-11-06T10:57:01.000Z"><meta property="article:modified_time" content="2025-10-25T13:45:41.572Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1604662591/Security/WeChat_Screenshot_20201106193621_gkboit.png"><link rel="canonical" href="https://sunra.top/en/posts/527c5341/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/posts/527c5341/","path":"posts/527c5341/","title":"Use of Zap and Bugfix"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Use of Zap and Bugfix | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#installation"><span class="nav-number">1.</span> <span class="nav-text">Installation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#proxy-configuration"><span class="nav-number">2.</span> <span class="nav-text">Proxy configuration</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#use"><span class="nav-number">3.</span> <span class="nav-text">Use</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#zap"><span class="nav-number">3.1.</span> <span class="nav-text">Zap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#client"><span class="nav-number">3.2.</span> <span class="nav-text">Client</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#express-security-practices"><span class="nav-number">4.</span> <span class="nav-text">Express security practices</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#do-not-use-unrecommended-or-vulnerable"><span class="nav-number">4.1.</span> <span class="nav-text">Do not use unrecommended or vulnerable</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#use-2"><span class="nav-number">4.2.</span> <span class="nav-text">Use</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#use-3"><span class="nav-number">4.3.</span> <span class="nav-text">Use</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#at-least-disable"><span class="nav-number">4.3.1.</span> <span class="nav-text">At least disable</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#safe-use"><span class="nav-number">4.4.</span> <span class="nav-text">Safe use</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#do-not-use-the-default-session"><span class="nav-number">4.4.1.</span> <span class="nav-text">Do not use the default session</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#settings"><span class="nav-number">4.4.1.1.</span> <span class="nav-text">Settings</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ensure-the-security-of-dependencies"><span class="nav-number">4.5.</span> <span class="nav-text">Ensure the security of dependencies</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/posts/527c5341/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Use of Zap and Bugfix | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Use of Zap and Bugfix</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-11-06 18:57:01" itemprop="dateCreated datePublished" datetime="2020-11-06T18:57:01+08:00">2020-11-06</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2025-10-25 21:45:41" itemprop="dateModified" datetime="2025-10-25T21:45:41+08:00">2025-10-25</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Sundry/" itemprop="url" rel="index"><span itemprop="name">Sundry</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/posts/527c5341/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/posts/527c5341/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>This week POC several penetration testing tools, namely Burp Suite, OWASP Zap.</p><p>Many of the features of Burp are charged, and the free version is basically only used for request interception.</p><p>So finally chose Zap to scan a vulnerability fix for an Express project. Here is a brief record of the Zap tutorial and some security practices of Express.</p><span id="more"></span><h2 id="installation"><a class="markdownIt-Anchor" href="#installation"></a> Installation</h2><p>Zap installation is very simple, go directly to the official website <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.zaproxy.org/">https://www.zaproxy.org/</a> download and then step by step installation.</p><h2 id="proxy-configuration"><a class="markdownIt-Anchor" href="#proxy-configuration"></a> Proxy configuration</h2><p>The principle of Zap is actually to play a proxy, and then we configure the proxy strategy of the browser to direct the requests that need to be tested to the proxy, and Zap will record and analyze these requests and attempt to attack.</p><p>So the first step is to configure the proxy, this step can go to the official website doc: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.zaproxy.org/docs/desktop/start/proxies/">https://www.zaproxy.org/docs/desktop/start/proxies/</a></p><p>It should be noted here that Zap 2.9.0 only supports Chrome and Firefox browsers, and ** support for Chrome should only reach version 79. The author’s version 86 will crash as soon as Chrome starts. **</p><p>Regarding the proxy configuration of firefox, everyone can go directly to the official website, which is simply a tutorial at the nanny level.</p><p>The author needs to remind here is that a prompt in the doc, this prompt is about the configuration of the localhost, because this prompt does not use a special format, it is easy to ignore:</p><p><strong>Note:</strong> To proxy <code>localhost</code> (and related addresses) with newer Firefox versions (&gt;= 67) the preference <code>network.proxy.allow_hijacking_localhost</code> (accessible through the <code>about:config</code> page) must be set to <code>true</code>.</p><h2 id="use"><a class="markdownIt-Anchor" href="#use"></a> Use</h2><h3 id="zap"><a class="markdownIt-Anchor" href="#zap"></a> Zap</h3><p>Zap Hub is a very useful tool set provided by zap. It actually adds an entry to the functions of the Zap client on both sides of the browser, so that we do not need to switch back and forth between the browser and Zap during the testing process.</p><p>Of course, we can also use Zap Hub, but if you want to use it and find that Zap Hub is not loaded:</p><p>Check if Zap doesn’t have the hub open.</p><ul><li>If open, see if the Hub is blocked by some security policies of the project itself, such as CSP</li></ul><p>If you load Zap Hub for the first time, it will also prompt you whether to enter the novice tutorial. This tutorial is very detailed and will guide you step by step. It is also more verbose. If you are in a hurry to use it, you can first take a look at my screenshot below:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1604662591/Security/WeChat_Screenshot_20201106193621_gkboit.png" alt></p><h3 id="client"><a class="markdownIt-Anchor" href="#client"></a> Client</h3><p>The function of Zap Client is no different from that of Hub. If you know how to use Hub, you will naturally use Client.</p><p>But here’s a reminder: ** It’s best to use Passive Scan to scan a website at the beginning, only if you confirm that you can scan a website, and then actively scan, because active scanning will try various schemes to attack the target website. **</p><h2 id="express-security-practices"><a class="markdownIt-Anchor" href="#express-security-practices"></a> Express security practices</h2><p>When we finish scanning a website, we can export the scan report, and there are many formats to choose from.</p><p>After the author exported the report, although there were not many vulnerabilities, it was still those commonplace problems, such as XSS, SqlInjection, MIME sniffing, etc.</p><p>However, this also shows the prevalence of these problems, even impossible to guard against.</p><p>Here are a few Express security practices:</p><h3 id="do-not-use-unrecommended-or-vulnerable"><a class="markdownIt-Anchor" href="#do-not-use-unrecommended-or-vulnerable"></a> Do not use unrecommended or vulnerable</h3><p>Express 2.x and 3.x are no longer maintained. Security and performance issues in these versions will not be corrected. Do not use these versions! If you have not migrated to V4, follow the<a target="_blank" rel="external nofollow noopener noreferrer" href="https://expressjs.com/zh-cn/guide/migrating-4.html">迁移指南</a>Carry out migration.</p><p>Also make sure you are not using<a target="_blank" rel="external nofollow noopener noreferrer" href="https://expressjs.com/zh-cn/advanced/security-updates.html">安全性更新页面</a>Any of the vulnerable Express versions listed in. If in use, please update to a stable published version, preferably the latest version.</p><h3 id="use-2"><a class="markdownIt-Anchor" href="#use-2"></a> Use</h3><p>If the application processes or transmits sensitive data, please use<a target="_blank" rel="external nofollow noopener noreferrer" href="https://en.wikipedia.org/wiki/Transport_Layer_Security">传输层安全性</a> (TLS) to protect connections and data. This technique is used to encrypt data and then send it from the client to the server to prevent some common (and easy) hacking attacks. Although Ajax and POST requests may not be obvious and seem to be “hidden” in the browser, their network traffic is vulnerable<a target="_blank" rel="external nofollow noopener noreferrer" href="https://en.wikipedia.org/wiki/Packet_analyzer">包嗅探</a>Attacks and<a target="_blank" rel="external nofollow noopener noreferrer" href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">中间人攻击</a>。</p><p>You may be familiar with Secure Sockets Layer (SSL) encryption.[TLS 就是下一代的 SSL](<a target="_blank" rel="external nofollow noopener noreferrer" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa380515(v=vs.85)In">https://msdn.microsoft.com/en-us/library/windows/desktop/aa380515(v=vs.85)In</a> other words, if you have used SSL before, consider upgrading to TLS. In general, we recommend using Nginx to handle TLS. For excellent reference information on configuring TLS on Nginx (and other servers), please refer to <a target="_blank" rel="external nofollow noopener noreferrer" href="https://wiki.mozilla.org/Security/Server_Side_TLS#Recommended_Server_Configurations">Recommended Server Configurations</a> (Mozilla Wiki)。</p><p>In addition, a convenient <a target="_blank" rel="external nofollow noopener noreferrer" href="https://letsencrypt.org/about/">Let’s Encrypt</a> Tool to get free TLS certificate, which is provided by<a target="_blank" rel="external nofollow noopener noreferrer" href="https://letsencrypt.org/isrg/">因特网安全研究组 (ISRG)</a> Provide free, automated open certification center (CA).</p><h3 id="use-3"><a class="markdownIt-Anchor" href="#use-3"></a> Use</h3><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.npmjs.com/package/helmet">Helmet</a> 通过适当地设置 HTTP 头，帮助您保护应用程序避免一些众所周知的 Web 漏洞。</p><p>Helmet actually only uses the following set of nine smaller Middleware functions for setting security-related HTTP headers:</p><ul><li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/helmetjs/csp">csp</a> Used to set the Content-Security-Policy header to help defend against cross-site scripting attacks and other cross-site injection attacks.</li><li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/helmetjs/hide-powered-by">hidePoweredBy</a> Used to remove the X-Powered-By header.</li><li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/helmetjs/hsts">hsts</a> Use to set the Strict-Transport-Security header to enforce a secure server connection (HTTP over SSL/TLS).</li><li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/helmetjs/ienoopen">ieNoOpen</a> Used to set’X-Download-Options’ for IE8 +.</li><li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/helmetjs/nocache">noCache</a> Use to set the Cache-Control and Pragma headers to disable Client caching.</li><li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/helmetjs/dont-sniff-mimetype">noSniff</a> Used to set X-Content-Type-Options to prevent attackers from MIME-sniffing the content-type declared in the response from the browser.</li><li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/helmetjs/frameguard">frameguard</a> Used to set the X-Frame-Options header, providing <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.owasp.org/index.php/Clickjacking">clickjacking</a> Protection.</li><li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/helmetjs/x-xss-protection">xssFilter</a> Use to set X-XSS-Protection to enable cross-site scripting (XSS) filters in the latest web browsers.</li></ul><p>Install Helmet like other modules:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save helmet</span><br></pre></td></tr></table></figure><p>Then use it for your code.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">var</span> helmet = <span class="built_in">require</span>(<span class="string">&#x27;helmet&#x27;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">helmet</span>());</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h4 id="at-least-disable"><a class="markdownIt-Anchor" href="#at-least-disable"></a> At least disable</h4><p>If you do not wish to use Helmet, you should at least disable the X-Powered-By header. Attackers may use this header (enabled by default) to detect applications running Express and then launch attacks against specific targets.</p><p>So, the best practice is to disable this header using the app.disable () method:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">disable</span>(<span class="string">&#x27;x-powered-by&#x27;</span>);</span><br></pre></td></tr></table></figure><p>If you use helmet.js, it will perform this function for you.</p><h3 id="safe-use"><a class="markdownIt-Anchor" href="#safe-use"></a> Safe use</h3><p>To ensure that cookies do not open applications and expose them to risk, do not use the default session cookie name and set cookie security options accordingly.</p><p>There are two main Middleware cookie session modules:</p><ul><li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.npmjs.com/package/express-session">express-session</a>, used to replace the’express.session 'Middleware built into Express 3.x.</li><li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.npmjs.com/package/cookie-session">cookie-session</a>, used to replace the’express.cookieSession 'Middleware built into Express 3.x.</li></ul><p>The main difference between these two modules is the way they save cookie session data.<a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.npmjs.com/package/express-session">express-session</a> Middleware stores session data on the server; it only stores session identifiers, not session data, in cookies. By default, it uses in-memory storage and is not intended for use in a production environment. In a production environment, you need to set up scalable session storage; see<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/expressjs/session#compatible-session-stores">兼容的会话存储</a>List.</p><p>On the contrary,<a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.npmjs.com/package/cookie-session">cookie-session</a> Middleware implements cookie-supported storage: it serializes the entire session into the cookie, not just the session key. This Middleware is only used if the session data is relatively small and easy to encode as primitive values (rather than objects). Although it is assumed that the browser supports at least 4096 bytes per cookie to ensure that the limit is not exceeded, the size of each domain will not exceed 4093 bytes. Also note that the client has access to cookie data, so express-session may be a better choice if there is any reason to keep it secure or hidden.</p><h4 id="do-not-use-the-default-session"><a class="markdownIt-Anchor" href="#do-not-use-the-default-session"></a> Do not use the default session</h4><p>Using the default session cookie name leaves the application open to attacks. Values such as X-Powered-By can cause problems: potential attackers can use such values to “fingerprint” the server and determine attack targets accordingly.</p><p>To avoid this problem, use generic cookie names; for example, use <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.npmjs.com/package/express-session">express-session</a> Middleware:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> session = <span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>);</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;trust proxy&#x27;</span>, <span class="number">1</span>) <span class="comment">// trust first proxy</span></span><br><span class="line">app.<span class="title function_">use</span>( <span class="title function_">session</span>(&#123;</span><br><span class="line">   secret : <span class="string">&#x27;s3Cur3&#x27;</span>,</span><br><span class="line">   name : <span class="string">&#x27;sessionId&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h5 id="settings"><a class="markdownIt-Anchor" href="#settings"></a> Settings</h5><p>Set the following cookie options to enhance security:</p><ul><li>‘Secure’ - Ensure that the browser only sends cookies over HTTPS.<br> HttpOnly ensures that cookies are only sent over HTTP (S), not client JavaScript, which helps protect against cross-site scripting attacks.</li><li>‘Domain’ - Represents the domain of the cookie; used for comparison with the domain of the server requesting the URL. If it matches, then the path attribute is checked next.</li><li>‘Path’ - indicates the path of the cookie; used for comparison with the request path. If both the path and domain match, the cookie is sent in the request.</li><li>‘expires’ - Used to set an expiration date for persistent cookies.</li></ul><p>Following is the use <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.npmjs.com/package/cookie-session">cookie-session</a> Examples of Middleware:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> session = <span class="built_in">require</span>(<span class="string">&#x27;cookie-session&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> expiryDate = <span class="keyword">new</span> <span class="title class_">Date</span>( <span class="title class_">Date</span>.<span class="title function_">now</span>() + <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> ); <span class="comment">// 1 hour</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;session&#x27;</span>,</span><br><span class="line">  <span class="attr">keys</span>: [<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>],</span><br><span class="line">  <span class="attr">cookie</span>: &#123; <span class="attr">secure</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">httpOnly</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">domain</span>: <span class="string">&#x27;example.com&#x27;</span>,</span><br><span class="line">            <span class="attr">path</span>: <span class="string">&#x27;foo/bar&#x27;</span>,</span><br><span class="line">            <span class="attr">expires</span>: expiryDate</span><br><span class="line">          &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="ensure-the-security-of-dependencies"><a class="markdownIt-Anchor" href="#ensure-the-security-of-dependencies"></a> Ensure the security of dependencies</h3><p>Npm itself has a dependency checking tool, ‘npm audit’, very easy to use, this is doc, doc is very short, and it is also very simple to use: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.npmjs.com/cli/v6/commands/npm-audit/">https://docs.npmjs.com/cli/v6/commands/npm-audit/</a></p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/posts/527c5341/" title="Use of Zap and Bugfix">https://sunra.top/en/posts/527c5341/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/posts/7a981791/" rel="prev" title="Element UI Table tree component lazy loading problem fix"><i class="fa fa-chevron-left"></i> Element UI Table tree component lazy loading problem fix</a></div><div class="post-nav-item"> <a href="/en/posts/fb40efc5/" rel="next" title="Topological Sorting">Topological Sorting<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" integrity="sha256-hLTCMFlKxdNgPXyWlSSxYN0ykJmxxq9Yt3MNfdRGWeA=" crossorigin="anonymous"><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/posts/527c5341/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>