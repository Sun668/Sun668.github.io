<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="The reason why this article suddenly started, because this week’s work, the use of singleton mode to achieve a function, in the code review, was pointed out as far as possible not to use singleton mod"><meta property="og:type" content="article"><meta property="og:title" content="Singleton Pattern and Its Controversies"><meta property="og:url" content="https://sunra.top/en/2022/07/08/why-singletons-are-controversial/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="The reason why this article suddenly started, because this week’s work, the use of singleton mode to achieve a function, in the code review, was pointed out as far as possible not to use singleton mod"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2022-07-08T14:10:22.000Z"><meta property="article:modified_time" content="2024-10-18T08:01:21.676Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://sunra.top/en/2022/07/08/why-singletons-are-controversial/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/2022/07/08/why-singletons-are-controversial/","path":"2022/07/08/why-singletons-are-controversial/","title":"Singleton Pattern and Its Controversies"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Singleton Pattern and Its Controversies | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#singleton-mode"><span class="nav-number">1.</span> <span class="nav-text">Singleton mode</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#what-is-singleton-mode"><span class="nav-number">1.1.</span> <span class="nav-text">What is Singleton Mode?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#several-ways-to-implement-the-singleton-pattern"><span class="nav-number">1.2.</span> <span class="nav-text">Several ways to implement the singleton pattern</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#hungry-man-style"><span class="nav-number">1.2.1.</span> <span class="nav-text">Hungry man style</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#lazy-man-style"><span class="nav-number">1.2.2.</span> <span class="nav-text">Lazy man style</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#why-try-not-to-use-singleton-mode"><span class="nav-number">2.</span> <span class="nav-text">Why try not to use singleton mode</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#difficult-to-test"><span class="nav-number">2.1.</span> <span class="nav-text">Difficult to test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#violation-of-inversion-of-control"><span class="nav-number">2.2.</span> <span class="nav-text">Violation of inversion of control</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#violation-of-the-open-closed-principle"><span class="nav-number">2.3.</span> <span class="nav-text">Violation of the Open Closed Principle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#violation-of-the-single-responsibility-principle"><span class="nav-number">2.4.</span> <span class="nav-text">Violation of the Single Responsibility Principle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#violation-of-the-dependence-inversion-principle"><span class="nav-number">2.5.</span> <span class="nav-text">Violation of the Dependence Inversion Principle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#violation-of-high-cohesion-low-coupling"><span class="nav-number">2.6.</span> <span class="nav-text">Violation of high cohesion, low coupling</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#how-to-use-the-singleton-pattern-better"><span class="nav-number">3.</span> <span class="nav-text">How to use the Singleton pattern better</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#stateful-singletons-and-stateless-singletons"><span class="nav-number">3.1.</span> <span class="nav-text">Stateful Singletons and Stateless Singletons</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/2022/07/08/why-singletons-are-controversial/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Singleton Pattern and Its Controversies | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Singleton Pattern and Its Controversies</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2022-07-08 22:10:22" itemprop="dateCreated datePublished" datetime="2022-07-08T22:10:22+08:00">2022-07-08</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2024-10-18 16:01:21" itemprop="dateModified" datetime="2024-10-18T16:01:21+08:00">2024-10-18</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Sundry/" itemprop="url" rel="index"><span itemprop="name">Sundry</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/2022/07/08/why-singletons-are-controversial/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/2022/07/08/why-singletons-are-controversial/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>The reason why this article suddenly started, because this week’s work, the use of singleton mode to achieve a function, in the code review, was pointed out as far as possible not to use singleton mode, gave me a few articles to see, harvest some content, so systematically summarize.</p><span id="more"></span><h2 id="singleton-mode"><a class="markdownIt-Anchor" href="#singleton-mode"></a> Singleton mode</h2><p>First, let’s talk about what the singleton pattern is and how it is implemented.</p><h3 id="what-is-singleton-mode"><a class="markdownIt-Anchor" href="#what-is-singleton-mode"></a> What is Singleton Mode?</h3><p>Here is the Lingo definition:</p><p>Singleton pattern, also known as monolithic pattern, is a commonly used software Design pattern and belongs to one of the creation patterns. When applying this pattern, the class of a singleton object must ensure that only one instance exists. Many times the entire system only needs to have one global object, which is conducive to coordinating the behavior of the entire system. For example, in a server program, the configuration information of the server is stored in a file, which is uniformly read by a singleton object, and then other objects in the service process obtain the configuration information through this singleton object. This approach simplifies configuration management in complex environments.</p><p>The idea of implementing the singleton pattern is: a class can return a reference to an object (always the same) and a method to obtain the instance (must be a static method, usually using the name getInstance); when we call this method, if the class The reference held by the class is not null, the reference is returned, and if the reference held by the class is null, an instance of the class is created and the reference of the instance is assigned to the reference held by the class; at the same time, we also define the constructor function of the class as a private method, so that code elsewhere cannot instantiate the object of the class by calling the constructor function of the class, only through the Class provides a static method to obtain a unique instance of the class.</p><p>Singleton mode must be used carefully in multi-threaded applications. If two threads call the create method at the same time when the unique instance has not yet been created, then they do not detect the existence of the unique instance at the same time, so that two instances are constructed at the same time, which violates the singleton mode. The principle of instance uniqueness. The solution to this problem is to provide a mutual exclusion for variables indicating whether the class has been instantiated (although this will reduce efficiency).</p><h3 id="several-ways-to-implement-the-singleton-pattern"><a class="markdownIt-Anchor" href="#several-ways-to-implement-the-singleton-pattern"></a> Several ways to implement the singleton pattern</h3><p>There are many ways to implement the singleton mode, as long as only one instance is guaranteed, which is also different in single-threaded and multi-threaded situations. We will briefly introduce several</p><h4 id="hungry-man-style"><a class="markdownIt-Anchor" href="#hungry-man-style"></a> Hungry man style</h4><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SingletonEH</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Whether Lazy is initialized: No</span></span><br><span class="line"><span class="comment">     Whether it is multi-thread safe: Yes</span></span><br><span class="line"><span class="comment">     * Implementation difficulty: easy</span></span><br><span class="line"><span class="comment">     This method is more commonly used, but it is easy to generate garbage objects.</span></span><br><span class="line"><span class="comment">     Advantages: Without locking, execution efficiency will be improved.</span></span><br><span class="line"><span class="comment">     Disadvantages: Class is initialized when loaded, wasting memory.</span></span><br><span class="line"><span class="comment">     It avoids multi-threaded synchronization issues based on the classloder mechanism.</span></span><br><span class="line"><span class="comment">     However, instance is instantiated when the class is loaded, although there are many reasons for class loading.</span></span><br><span class="line"><span class="comment">    In singleton mode, most calls are made to the getInstance method.</span></span><br><span class="line"><span class="comment">     However, it is not certain that there are other ways (or other static methods) to cause class loading.</span></span><br><span class="line"><span class="comment">     At this time, initializing instance obviously does not achieve the effect of lazy loading.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SingletonEH instance = <span class="keyword">new</span> SingletonEH();</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SingletonEH</span> ()</span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SingletonEH <span class="title">getInstance</span>()</span> &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">&quot;instance:&quot;</span>+instance);</span><br><span class="line">        System.<span class="keyword">out</span>.println (<span class="string">&quot;Load Hungry Han Style....&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Hungry Han style is inherently thread-safe and can be used directly for multi-threading without problems</p><h4 id="lazy-man-style"><a class="markdownIt-Anchor" href="#lazy-man-style"></a> Lazy man style</h4><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span>Implementation of singleton pattern</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Singleton</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Define a Static Variable to hold an instance of the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton uniqueInstance;</span><br><span class="line"></span><br><span class="line">    <span class="function">Define a <span class="keyword">private</span> constructor function so that the outside world cannot create an instance of the <span class="keyword">class</span></span></span><br><span class="line"><span class="function">    <span class="keyword">private</span> <span class="title">Singleton</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span>Define public methods to provide a global access point, and you can also define public properties to provide global access points</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">GetInstance</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//Create if the instance of the class does not exist, otherwise return directly</span></span><br><span class="line">        <span class="keyword">if</span> (uniqueInstance  <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The implementation of the singleton pattern above is indeed perfect under single thread, but in the case of multi-threading, you will get multiple Singleton instances, because when two threads run the GetInstance method at the same time, the two threads judge (uniqueInstance null)这个条件时都返回真，此时两个线程就都会创建Singleton的实例，这样就违背了我们单例模式初衷了，既然上面的实现会运行多个线程执行，那我们对于多线程的解决方案自然就是使GetInstance方法在同一时间只运行一个线程运行就好了，也就是我们线程同步的问题了</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span>Implementation of singleton pattern</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Singleton</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Define a Static Variable to hold an instance of the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton uniqueInstance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Define an identifier to ensure thread synchronization</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">object</span> locker = <span class="keyword">new</span> <span class="built_in">object</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function">Define a <span class="keyword">private</span> constructor function so that the outside world cannot create an instance of the <span class="keyword">class</span></span></span><br><span class="line"><span class="function">    <span class="keyword">private</span> <span class="title">Singleton</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span>Define public methods to provide a global access point, and you can also define public properties to provide global access points</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">GetInstance</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//When the first thread runs here, the locker object will be &quot;locked&quot; at this time,</span></span><br><span class="line">        <span class="comment">//When the second thread runs this method, it first detects that the locker object is in &quot;locked&quot; state, and the thread will suspend waiting for the first thread to unlock</span></span><br><span class="line">        <span class="comment">//The object is &quot;unlocked&quot; after the lock statement has run (that is, after the thread has run)</span></span><br><span class="line">        <span class="keyword">lock</span> (locker)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//Create if the instance of the class does not exist, otherwise return directly</span></span><br><span class="line">            <span class="keyword">if</span> (uniqueInstance  <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The above solution can indeed solve the problem of multi-threading, but the above code will lock the thread auxiliary object locker for each thread and then determine whether the instance exists. It is completely unnecessary for this operation, because when the first thread creates After an instance of this class, the later threads only need to directly judge (uniqueInstancenull）为假，此时完全没必要对线程辅助对象加锁之后再去判断，所以上面的实现方式增加了额外的开销，损失了性能，为了改进上面实现方式的缺陷，我们只需要在lock语句前面加一句（uniqueInstanceThe judgment of null can avoid the extra overhead added by locking. We call this implementation “double locking”. Let’s take a look at the implementation code below:</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span>Implementation of singleton pattern</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Singleton</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Define a Static Variable to hold an instance of the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton uniqueInstance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Define an identifier to ensure thread synchronization</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">object</span> locker = <span class="keyword">new</span> <span class="built_in">object</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function">Define a <span class="keyword">private</span> constructor function so that the outside world cannot create an instance of the <span class="keyword">class</span></span></span><br><span class="line"><span class="function">    <span class="keyword">private</span> <span class="title">Singleton</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span>Define public methods to provide a global access point, and you can also define public properties to provide global access points</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">GetInstance</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//When the first thread runs here, the locker object will be &quot;locked&quot; at this time,</span></span><br><span class="line">        <span class="comment">//When the second thread runs this method, it first detects that the locker object is in &quot;locked&quot; state, and the thread will suspend waiting for the first thread to unlock</span></span><br><span class="line">        <span class="comment">//The object is &quot;unlocked&quot; after the lock statement has run (that is, after the thread has run)</span></span><br><span class="line">        <span class="function">Double locking only requires one sentence of judgment</span></span><br><span class="line"><span class="function">        <span class="title">if</span> (<span class="params">uniqueInstance  <span class="literal">null</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">lock</span> (locker)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//Create if the instance of the class does not exist, otherwise return directly</span></span><br><span class="line">                <span class="keyword">if</span> (uniqueInstance  <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="why-try-not-to-use-singleton-mode"><a class="markdownIt-Anchor" href="#why-try-not-to-use-singleton-mode"></a> Why try not to use singleton mode</h2><p>First of all, programs that use global state are difficult to test. One of the hallmarks of testability is the loose coupling of classes, allowing you to isolate a single class and test it completely. When a class uses a singleton (I’m talking about a classic singleton, a singularity that enforces itself through a static getInstance () method), singleton users and singletons are inevitably coupled together. If you don’t test the singleton pattern, it’s impossible to test the singleton’s user (because that user is bound to call the singleton). In many cases, this is a deal breaker and can prevent developers from testing a class, especially if the singleton represents a resource that should not be updated by testing (e.g. an important database). ** The ideal solution here is to pass the singleton as an argument in the user’s constructor function **, allowing testers to easily simulate the singleton for testing. The singleton pattern then does not have to enforce its own singularity; this can be handled by the client or factory class, which can generate an actual or test version, eliminating the global state completely. In fact, making an object responsible for its own singular and normal tasks should be considered a violation of the single responsibility principle of OO design.</p><p>Secondly, programs that rely on global state hide their dependencies. One of the unique features of the singleton pattern is that it can be accessed anywhere through its globally available static method (i.e. getInstance ()), allowing programmers to use it inside the method without having to explicitly pass it through parameters. Although this seems easier for programmers, ** relying on this static instance means that the signature of the method no longer shows their dependencies **, because this method can get a singleton “out of thin air”. This means that users need to understand the inner workings of the code to use it correctly, which makes it more difficult to use and test.</p><p>Connecting these two issues shows another problem with the singleton pattern. In today’s world of test-driven and agile development, it is more important than ever to have small tests that cover most of the code. An important thing about these tests is that they must be able to run in any order (without interdependencies), which can become an issue for singleton usage. Since the dependencies of some given methods when they depend on singletons (taken from static getters) are not clear, testers may not know to write two tests that actually depend on each other by modifying shared resources (singletons). This can result in flaky tests that pass when run in one order but fail when run in another, which are of little use.</p><p>Actually, ** there is nothing wrong with having only one object instance. But utilizing the “singleton pattern” to achieve this is never the best solution **. At the end of this article, I will tell you why and how to do it better.</p><p>Let’s use an example to illustrate what design principles the singleton pattern violates</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">InterestingThingsDoer</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> InterestingThingsDoer instance = <span class="keyword">new</span> InterestingThingsDoer();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//possible some instance state</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">InterestingThingsDoer</span>()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> InterestingThingsDoer <span class="title">getInstance</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResultType <span class="title">doSomethingInteresting</span>()</span> &#123;</span><br><span class="line">        <span class="comment">//something interesting</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Then we call this singleton in a function of another class</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">evenMoreInteresting</span>()</span> &#123;</span><br><span class="line">    InterestingThingsDoer doer = InterestingThingsDoer.getInstance();</span><br><span class="line">    ResultType result = doer.doSomethingInteresting();</span><br><span class="line">    <span class="comment">//do something even more interesting...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="difficult-to-test"><a class="markdownIt-Anchor" href="#difficult-to-test"></a> Difficult to test</h3><p>A singleton couples all callers into the concrete implementation of a singleton because the callee demands a singleton object. Your classes become harder to test: you can’t test them individually, you can’t run code in Singleton.</p><p>In the example above, the method “evenMoreInteresting” cannot be tested without running some code from “InterestingThingsDoer”.</p><p>So what’s wrong with this?</p><p>Imagine the following scenario:</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">evenMoreInteresting</span>()</span> &#123;</span><br><span class="line">    InterestingThingsDoer doer = InterestingThingsDoer.getInstance();</span><br><span class="line">    ResultType result = doer.doSomethingInteresting();</span><br><span class="line">    ResultTypeDao dao = ResultTypeDao.getInstance();</span><br><span class="line">    dao.save(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Now, you need a database to test “evenMoreInteresting”. And, if “evenMoreInteresting” is defined in a singleton again (for example, because it is part of a stateless service, and everyone knows that you only need one instance of a stateless service), then you will need a database to test every method that calls “evenMoreInteresting”. And so on. A large part of your testing will be integration testing, and those are evil</p><h3 id="violation-of-inversion-of-control"><a class="markdownIt-Anchor" href="#violation-of-inversion-of-control"></a> Violation of inversion of control</h3><p>When you use a singleton object in a class, you violate “inversion of control”: your class does not inject collaborators (singleton objects).</p><p>In the above code, evenMoreInteresting () has full control over the flow of control, because it takes the concrete implementations of all necessary collaborators and decides what to do with them.</p><p>To achieve inversion of control, you must ensure that the class is not responsible for finding/creating their collaborators (among other things). You can use a technique called “dependency injection” - preferably “construct function injection”.</p><p>However, if you inject too much, it may cause the constructor function signature to become too large!</p><p>If you change some existing code for dependency injection, especially constructor function injection, you will notice that some of your constructor functions have many, many parameters. Take the opportunity to refactor: this class is obviously doing too much!</p><h3 id="violation-of-the-open-closed-principle"><a class="markdownIt-Anchor" href="#violation-of-the-open-closed-principle"></a> Violation of the Open Closed Principle</h3><p>The singleton itself violates the “open/closed principle”: if you want to extend or change the behavior of the singleton, you must change the class. In other words, you cannot change the behavior of “InterestingThingsDoer” from above without opening the file and editing the code.</p><p>Changing code is more risky than adding new code. When you change existing code, it is always possible to introduce unwanted side effects (i.e. “defects” or “bugs”) in completely different areas of the code that depend on changing the code.</p><p>When you can extend the functionality of existing code by adding new code, the possibility of introducing side effects in “irrelevant” parts of the code is greatly reduced (but still may be greater than zero, depending on your architecture and design).</p><p>Therefore, classes/modules/functions that violate the open/closed principle increase the likelihood of introducing defects later when they need to be changed.</p><h3 id="violation-of-the-single-responsibility-principle"><a class="markdownIt-Anchor" href="#violation-of-the-single-responsibility-principle"></a> Violation of the Single Responsibility Principle</h3><p>The singleton model itself violates the “single responsibility principle”: in addition to their primary responsibility, they are also responsible for fulfilling their own lifecycle.</p><p>Classes that use singletons also violate the “single responsibility principle”: in addition to their primary responsibility, they are also responsible for determining the specific class (at least one) of their collaborators.</p><p>The responsibility of each class is also a reason to change. Whenever the “InterestingThingsDoer” needs to be changed, whenever its lifecycle changes, you must change it. When the lifecycle of the “InterestingThingsDoer” changes, you must change all callers because they also have multiple responsibilities.</p><p>And, as mentioned earlier, changing the code is inherently risky: if you change the code because some responsibilities of the class have changed, there is also a certain risk that you may break the code that handles other responsibilities of the same class.</p><p>In addition, if the class has multiple responsibilities, all of them must be tested. You may not be able to test them individually. This means you have to write more complex/difficult to understand tests.</p><h3 id="violation-of-the-dependence-inversion-principle"><a class="markdownIt-Anchor" href="#violation-of-the-dependence-inversion-principle"></a> Violation of the Dependence Inversion Principle</h3><p>&quot;The Dependency Inversion Principle states that a system’s high-level strategy should not depend on low-level details. Furthermore, abstractions should not depend on details.</p><p>Singletons usually implement some low-level details. When you use them from business logic (the system’s high-level policy), you violate the “Dependency Inversion Principle”.</p><p>This dependency inversion principle ensures that you can change the low-level details of the system without having to change the high-level “business logic”.</p><p>Imagine a vending machine: you choose a product, pay the price, and get the product. When the implementation of this high-level workflow has any dependencies on low-level details, such as how payment works, when you add some new payment method (such as NFC payment), you may have to change the code that handles this high-level workflow. You don’t want this because changing the code is dangerous.</p><h3 id="violation-of-high-cohesion-low-coupling"><a class="markdownIt-Anchor" href="#violation-of-high-cohesion-low-coupling"></a> Violation of high cohesion, low coupling</h3><p>Often, multiple classes depend on the concrete implementation of a singleton. This increases coupling in the system: when you want to change the behavior of a singleton, you may have to check and change all callers. There is always a common coupling between all classes that use singletons: they share a global variable - the singleton!</p><p>Sometimes, moving code to singletons (for example, to minimize code duplication) also reduces cohesion: you move things to different classes/packages that should conceptually be part of the original class/package.</p><p>In a tightly coupled system, changes ripple through the system: you want to change a little bit of functionality, but to do that you have to modify 20 classes and 50 tests.</p><p>In a system with low cohesion, it can be difficult to even find where to make changes: it could be any of 10 different modules. It could also be all of them. Sometimes it’s even hard to know if you’ve found all the places you need to make changes to fix a small flaw.</p><h2 id="how-to-use-the-singleton-pattern-better"><a class="markdownIt-Anchor" href="#how-to-use-the-singleton-pattern-better"></a> How to use the Singleton pattern better</h2><p>As mentioned earlier, there is no problem with only one object instance, but we can completely not use getInstance</p><p>Here are two better practices:</p><p>If you really only want one instance of a class, implement an inversion of control for your dependencies. If you are already using a dependency injection container (such as Guice or Spring), just make sure that all singleton objects are managed by this container. All of these containers have a way to declare objects as singletons.</p><p>If you don’t want to use one of these containers, just create all the object instances that need singletons in one place and inject them into other objects through their constructor function. You may only need one instance for the entire lifecycle of the application, but you don’t need the singleton pattern. Just construct one and inject it into the class as needed.</p><h3 id="stateful-singletons-and-stateless-singletons"><a class="markdownIt-Anchor" href="#stateful-singletons-and-stateless-singletons"></a> Stateful Singletons and Stateless Singletons</h3><p>There are basically two types of singletons:</p><ul><li>Stateless Singleton: This class doesn’t need multiple instances because it has no state. But you can have many instances of this: it doesn’t matter. Because they have no state</li></ul><p>Stateful Singleton: You must have an instance of this class because it represents some globally shared state.</p><p>The first class is not a problem. Just use one of the “sensible” methods to create a singleton from above, don’t use the “singleton pattern”. Even if you construct more than one class, this is not a problem: the class is stateless anyway, and you just end up consuming more resources. For most applications (but not all), this overhead may be negligible.</p><p>The second category can even be a problem when you use a “sensible” approach to ensuring that there is only one object: shared, mutable state makes it easy to introduce defects when changing content and makes it difficult to scale the application.</p><p>Reference article:<br> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://zh.m.wikipedia.org/zh-hans/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F">什么是单例模式</a><br> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.csdn.net/qq_35098526/article/details/79893628">单例懒汉式和饿汉式的区别</a><br> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.cnblogs.com/zhili/p/singletonpatterm.html">单例实现的几种方法</a><br> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://code.google.com/archive/p/google-singleton-detector/wikis/WhySingletonsAreControversial.wiki">为什么单例模式令人困扰</a><br> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.davidtanzer.net/david's%20blog/2016/03/14/6-reasons-why-you-should-avoid-singletons.html">为什么要尽量避免单例模式</a></p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/2022/07/08/why-singletons-are-controversial/" title="Singleton Pattern and Its Controversies">https://sunra.top/en/2022/07/08/why-singletons-are-controversial/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/2022/07/03/unity-render-pipeline-11/" rel="prev" title="Unity Rendering Principle (11) Unity Basic Textures (gradual change textures and mask textures)"><i class="fa fa-chevron-left"></i> Unity Rendering Principle (11) Unity Basic Textures (gradual change textures and mask textures)</a></div><div class="post-nav-item"> <a href="/en/2022/07/16/advanced-mathematic-summary/" rel="next" title="higher mathematics knowledge point combing summary">higher mathematics knowledge point combing summary<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" integrity="sha256-hLTCMFlKxdNgPXyWlSSxYN0ykJmxxq9Yt3MNfdRGWeA=" crossorigin="anonymous"><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/2022/07/08/why-singletons-are-controversial/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>