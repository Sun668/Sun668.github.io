<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="I&#x2F;O devicesI&#x2F;O Facility Management is the most messy and challenging part of operating system design. Because it includes different devices and device-related applications in many fields, it is diffic"><meta property="og:type" content="article"><meta property="og:title" content="Operating System Learning Notes (7) Overview of I&#x2F;O Management"><meta property="og:url" content="https://sunra.top/en/2022/01/07/operating-system-note-7-io-introduction/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="I&#x2F;O devicesI&#x2F;O Facility Management is the most messy and challenging part of operating system design. Because it includes different devices and device-related applications in many fields, it is diffic"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1641603821/origin-of-ray/asynccode_mozf3x.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1641603845/origin-of-ray/asynccode_ci8aj8.png"><meta property="article:published_time" content="2022-01-07T00:45:16.000Z"><meta property="article:modified_time" content="2024-01-14T08:05:48.538Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1641603821/origin-of-ray/asynccode_mozf3x.png"><link rel="canonical" href="https://sunra.top/en/2022/01/07/operating-system-note-7-io-introduction/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/2022/01/07/operating-system-note-7-io-introduction/","path":"2022/01/07/operating-system-note-7-io-introduction/","title":"Operating System Learning Notes (7) Overview of I/O Management"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Operating System Learning Notes (7) Overview of I/O Management | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#I-O-devices"><span class="nav-number">1.</span> <span class="nav-text">I&#x2F;O devices</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#I-O-control-mode"><span class="nav-number">2.</span> <span class="nav-text">I&#x2F;O control mode</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-way-the-program-is-directly-controlled"><span class="nav-number">2.1.</span> <span class="nav-text">The way the program is directly controlled</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Interrupt-driven-mode"><span class="nav-number">2.2.</span> <span class="nav-text">Interrupt driven mode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DMA-mode"><span class="nav-number">2.3.</span> <span class="nav-text">DMA mode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Channel-control-mode"><span class="nav-number">2.4.</span> <span class="nav-text">Channel control mode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Difference-between-DMA-control-mode-and-interrupt-control-mode"><span class="nav-number">2.5.</span> <span class="nav-text">Difference between DMA control mode and interrupt control mode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Difference-between-DMA-control-mode-and-channel-control-mode"><span class="nav-number">2.6.</span> <span class="nav-text">Difference between DMA control mode and channel control mode</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hierarchy-of-I-O-subsystems"><span class="nav-number">3.</span> <span class="nav-text">Hierarchy of I&#x2F;O subsystems</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#User-layer-I-O-software"><span class="nav-number">3.1.</span> <span class="nav-text">User layer I&#x2F;O software</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Device-independent-software"><span class="nav-number">3.2.</span> <span class="nav-text">Device independent software</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Device-driver"><span class="nav-number">3.3.</span> <span class="nav-text">Device driver</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Interrupt-handler"><span class="nav-number">3.4.</span> <span class="nav-text">Interrupt handler</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hardware-equipment"><span class="nav-number">3.5.</span> <span class="nav-text">Hardware equipment</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/2022/01/07/operating-system-note-7-io-introduction/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Operating System Learning Notes (7) Overview of I/O Management | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Operating System Learning Notes (7) Overview of I/O Management</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2022-01-07 08:45:16" itemprop="dateCreated datePublished" datetime="2022-01-07T08:45:16+08:00">2022-01-07</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2024-01-14 16:05:48" itemprop="dateModified" datetime="2024-01-14T16:05:48+08:00">2024-01-14</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/2022/01/07/operating-system-note-7-io-introduction/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/2022/01/07/operating-system-note-7-io-introduction/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="I-O-devices"><a href="#I-O-devices" class="headerlink" title="I/O devices"></a>I/O devices</h2><p>I/O Facility Management is the most messy and challenging part of operating system design. Because it includes different devices and device-related applications in many fields, it is difficult to have a universal and consistent design solution. So before understanding Facility Management, you should first understand the specific types of I/O devices.</p><span id="more"></span><p>I/O devices in computer systems can be divided into the following types according to their usage characteristics:</p><ol><li>human-machine interaction External devices. Devices used to interact with computer users, such as printers, monitors, mice, keyboards, etc. The data exchange speed of such devices is relatively slow, usually in bytes.</li><li>Storage devices. Devices used to store programs and data, such as disks, tapes, optical disks, etc. This type of device is used for data exchange, which is fast and usually uses blocks composed of multiple bytes for data exchange.</li><li>Network communication equipment. Equipment used for remote device communication, such as various network interfaces, modems, etc. Its speed is between the first two types of devices. Network communication equipment is also very different from the first two types of devices in use and management.</li></ol><p>Divided by transmission rate:</p><ol><li>Low-speed devices. A class of devices with a transmission rate of only a few bytes to hundreds of bytes per second, such as a keyboard, mouse, etc.</li><li>Medium-speed equipment. A class of equipment with a transmission rate of thousands of bytes to tens of thousands of bytes per second, such as line printers, laser printers, etc.</li><li>High-speed equipment. A class of equipment with a transmission rate of hundreds of kilobytes to gigabytes, such as tape drives, disk drives, optical drives, etc.</li></ol><p>According to the information exchange unit, it is divided into:</p><ol><li>Block device. Since the access to information is always in units of data blocks, the device that stores information is called a block device, which belongs to structured devices, such as disks. The basic characteristics of disk devices are high transmission rates and addressable, that is, any block can be read and written randomly.</li><li>Character equipment. The device used for data input and output is a character device, because the basic unit of transmission is a character. It belongs to the unstructured type, such as interactive end point machines, printers, etc., which is characterized by low transmission rate, unaddressable, and interrupt driving mode is often used in input and output.</li></ol><h2 id="I-O-control-mode"><a href="#I-O-control-mode" class="headerlink" title="I/O control mode"></a>I/O control mode</h2><p>One of the main tasks of Facility Management is to control the transfer of data between devices and memory or processors.</p><p>There are 4 types of input and output between peripheral devices and memory.</p><h3 id="The-way-the-program-is-directly-controlled"><a href="#The-way-the-program-is-directly-controlled" class="headerlink" title="The way the program is directly controlled"></a>The way the program is directly controlled</h3><p>The computer reads data from external devices into memory, one word at a time. For each word read, the CPU needs to cycle through the peripheral state until it is determined that the word is already in the register of the I/O controller.</p><p>Due to the high speed of the CPU and the low speed of the I/O device, the CPU is in the cycle test of waiting for the I/O device to complete the data I/O most of the time, resulting in a great waste of CPU resources.</p><p>In this way, the reason why the CPU needs to constantly test whether it is completed is that the CPU does not use an interrupt mechanism, so that the I/O device cannot report to the CPU that it has completed the input of a word.</p><p>This method is simple to implement, but the disadvantage is that the CPU and I/O devices can only be serial.</p><h3 id="Interrupt-driven-mode"><a href="#Interrupt-driven-mode" class="headerlink" title="Interrupt driven mode"></a>Interrupt driven mode</h3><p>Allows I/O devices to actively interrupt the CPU and request services, thereby freeing the CPU to continue doing other useful work after sending read commands to the I/O controller.</p><p>We can look at the working process of interrupt-driven mode from the perspective of I/O controller and CPU respectively.</p><p>From an I/O controller perspective:</p><ul><li>The I/O controller received a read command from the CPU</li><li>Read data from the peripheral to the controller’s registers</li><li>Send an interrupt signal to the CPU through the control line, indicating that the data is ready, and then wait for the CPU to request the data.</li><li>After the controller receives the signal from the CPU requesting data, it puts the data on the data bus and transmits it to the registers of the CPU.</li></ul><p>From a CPU perspective:</p><ul><li>The CPU issues a read command, then saves the context of the currently running program (such as program counters and processor registers, etc.), and then proceeds to execute other programs.<br>At the end of each instruction cycle, the CPU checks for interrupts.</li><li>If there is an interrupt from the I/O controller, the CPU saves the context of the current program and goes to execute the interrupt handler to process the interrupt. At this time, the CPU reads the data of this word from the I/O controller to the register and stores it in main memory.</li><li>The CPU restores the program context that issued the I/O command and then continues execution.</li></ul><blockquote><p>What is an instruction cycle? [[Analysis] Instruction cycle, CPU cycle and clock cycle in CPU] (<a target="_blank" rel="external nofollow noopener noreferrer" href="https://zhuanlan.zhihu.com/p/90829922">https://zhuanlan.zhihu.com/p/90829922</a>)</p><p>Can I/O interrupts interrupt the time slice? [Normally, the thread can only use up the time slice to give up the cpu execution right?</p><p>Restore the original program context by reading a word?</p></blockquote><h3 id="DMA-mode"><a href="#DMA-mode" class="headerlink" title="DMA mode"></a>DMA mode</h3><p>The interrupt-driven mode is more effective than the direct program control mode, but since each word in the data is transmitted between the memory and the I/O controller through the CPU, the interrupt-driven mode still consumes a lot of CPU.</p><p>The basic idea of DMA (Direct Memory Access) is to open a direct data exchange channel between I/O devices and memory.</p><p>DMA mode features are as follows:</p><p>The basic unit is a data block.</p><ul><li>The data transferred is directly into memory from the device, or vice versa.</li><li>CPU intervention is only required at the beginning and end of the transmission of one or more data blocks. The transfer of the entire block of data is done under the control of the DMA controller.</li></ul><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1641603821/origin-of-ray/asynccode_mozf3x.png" alt="img"></p><p>To achieve direct exchange of block data between the host and the controller, the following four types of registers need to be set in the DMA controller:</p><ul><li>Command/Status Register (CR). Used to receive I/O commands or related control information from the CPU, or device status words.</li><li>Memory Address Register (MAR). On input, it stores the starting destination address for transferring data from the device to memory, and on output, it stores the memory source address from internal to the device.</li><li>Data Register (DR). Used to temporarily store data from device to memory or from memory to device</li><li>Data counter (DC). Stores the number of bytes (sections) to be transmitted this time.</li></ul><p>As shown in the figure above, the working mode of DMA is: after the CPU receives the DMA request from the I/O device, it sends a command to the I/O controller, starts the DMA controller, and then continues other work. After that, the CPU delegates the control operation to the DMA controller, which is responsible for processing. The DMA controller interacts directly with the memory, transmitting the entire data block, one word at a time, and the entire process does not require CPU participation. After the transfer is completed, the DMA sends an interrupt signal to the CPU.</p><p>The main difference between the DMA control mode and the interrupt driving mode is that the interrupt driving mode interrupts the CPU when each data needs to be transmitted, while the DMA control mode interrupts the CPU only when the required batch of data is all transmitted.</p><h3 id="Channel-control-mode"><a href="#Channel-control-mode" class="headerlink" title="Channel control mode"></a>Channel control mode</h3><p>The I/O channel refers to a processor that is specifically responsible for input and output (note that this is not a controller). The I/O channel method is the development of the DMA method, which can further reduce the interference of the CPU, that is, the intervention of reading and writing a data block is reduced to the intervention of reading and writing a group of data blocks and related control and management.</p><p>At the same time, the parallel operation of CPU, channel and I/O devices can be realized, which can effectively improve the resource utilization rate of the entire system.</p><p>For example, when the CPU wants to complete a set of related read or write operations and related controls, it only needs to send one I/O instruction to the I/O channel to give the first address of the channel program to be executed and the I to be accessed./O device, after the channel receives the instruction, the channel program can be executed to complete the specified I/O task, and an interrupt request is sent to the CPU at the end of the data transfer.</p><p>The difference between I/O channels and general processors is:</p><ul><li>Single type of channel instruction.<br>Without its own memory, the channel program executed by the channel is placed in the memory of the host, that is, the channel shares memory with the CPU</li></ul><h3 id="Difference-between-DMA-control-mode-and-interrupt-control-mode"><a href="#Difference-between-DMA-control-mode-and-interrupt-control-mode" class="headerlink" title="Difference between DMA control mode and interrupt control mode"></a>Difference between DMA control mode and interrupt control mode</h3><ol><li>The interrupt control mode interrupts the CPU after each data transfer is completed, while the DMA control mode interrupts the CPU after all the required data transfer is completed.</li><li>The data transfer in the interrupt control mode is controlled by the CPU during interrupt processing, while the DMA control mode is completed under the control of the DMA controller. However, in the DMA control mode, the direction of data transfer, the memory address where the data is stored and the length of the transmitted data are still controlled by the CPU.</li><li>The DMA mode takes the memory as the core, and the interrupt control mode takes the CPU as the core, so the DMA mode can work in parallel with the CPU.</li><li>The DMA mode can transmit data in batches, and the interrupt control mode can only be in bytes.</li></ol><h3 id="Difference-between-DMA-control-mode-and-channel-control-mode"><a href="#Difference-between-DMA-control-mode-and-channel-control-mode" class="headerlink" title="Difference between DMA control mode and channel control mode"></a>Difference between DMA control mode and channel control mode</h3><p>In the DMA control mode, data exchange can be performed in batches without CPU intervention between the device and the main memory under the control of the DMA controller, which not only reduces the burden on the CPU, but also improves the transmission speed of the I/O data.</p><p>The channel control mode is similar to the DMA control mode, and it is also a control mode that directly exchanges data between the device and the memory based on the memory. However, in the channel control mode, the CPU only needs to issue a start instruction to indicate the corresponding operation and I/O device of the channel., this instruction can start the channel and make the channel call out the corresponding channel execution program from the memory.</p><p>Compared with the DMA method, the channel control method requires less CPU intervention, and one channel can control multiple devices at the same time, further reducing the burden on the CPU.</p><p>In addition, for the channel, you can use some instructions to flexibly change the channel program, which DMA control can not do.</p><h2 id="Hierarchy-of-I-O-subsystems"><a href="#Hierarchy-of-I-O-subsystems" class="headerlink" title="Hierarchy of I/O subsystems"></a>Hierarchy of I/O subsystems</h2><div class="table-container"><table><thead><tr><th>User layer I/O software</th></tr></thead><tbody><tr><td>Device Independent Software</td></tr><tr><td>Device Drivers</td></tr></tbody></table></div><p>Interrupt handler.<br>| hardware |</p><p>The entire I/O system can be regarded as a system structure with 4 levels, each level and its function are as follows:</p><h3 id="User-layer-I-O-software"><a href="#User-layer-I-O-software" class="headerlink" title="User layer I/O software"></a>User layer I/O software</h3><p>Implement the interface to interact with the user. The user can directly call the library functions related to I/O operations provided at the user layer to operate the device. Generally speaking, most of the I/O software is inside the operating system, but there is still a small part at the user layer, including library functions linked with user programs, and some programs that run completely outside the kernel. User layer software must obtain operating system services through a set of system calls.</p><h3 id="Device-independent-software"><a href="#Device-independent-software" class="headerlink" title="Device independent software"></a>Device independent software</h3><p>It is used to realize the unified interface between user program and device driver, device command, device protection, device allocation and release, etc., and provide necessary storage space for Facility Management and data transmission.</p><p>Device independence also becomes device independence, making the application independent of the specific use of physical devices, in order to achieve device independence and the introduction of logical devices and physical devices two concepts.</p><p>In an application, a certain type of device is requested based on the logical device name; in actual execution of the system, the logical device name must be mapped to the physical device name for use.</p><p>The benefits of using logical device names are:</p><p>Increase the flexibility of equipment allocation.<br>Retargeting of I/O devices is easy.</p><p>In order to achieve device independence, another layer of device independence software must be set on top of the driver. Overall, the main functions of device independence software can be divided into two aspects:</p><ul><li>Perform common operations for all devices. Including: allocating and recycling devices; mapping logical devices to physical device names; protecting devices from direct user access to devices; buffer management; error control; providing unified logical blocks independent of devices, shielding between devices Differences in information exchange unit size and transmission rate.</li><li>Provide a unified interface to the user layer (file layer). Regardless of the device, the interface they provide to the user should be the same, for example, read and write operations on various devices, read/write commands are used uniformly in the application program, etc.</li></ul><h3 id="Device-driver"><a href="#Device-driver" class="headerlink" title="Device driver"></a>Device driver</h3><p>Directly related to hardware, responsible for the specific implementation of the operating instructions issued by the system to the device, driving the driver of the I/O device.</p><p>Usually, each type of device provides a device driver, which is a communication program between the I/O process and the device controller, often in the form of a process. The device driver provides a set of standard interfaces to the upper-level user program. The specific differences of the device are encapsulated by the device driver, which is used to receive abstract I/O requests from the upper-level software, such as read or write commands, which are converted into specific requirements and sent to the device controller. It also transmits the signals sent by the device controller to the upper-level software, thereby hiding the differences between device controllers for the I/O kernel subsystem.</p><h3 id="Interrupt-handler"><a href="#Interrupt-handler" class="headerlink" title="Interrupt handler"></a>Interrupt handler</h3><p>The CPU environment used to save the interrupted process is transferred to the corresponding interrupt handler for processing. After processing and resuming the site of the interrupted process, the interrupted process is returned.</p><p>The main tasks of the interrupt processing layer are: switching the process context, testing the processing end point signal source, reading the device state and modifying the process state.</p><p>Since interrupt handling is closely related to hardware, it should be shielded as much as possible for users, so it should be placed at the bottom of the operating system, and other parts of the system should have as little relationship with it as possible.</p><h3 id="Hardware-equipment"><a href="#Hardware-equipment" class="headerlink" title="Hardware equipment"></a>Hardware equipment</h3><p>I/O devices usually contain a mechanical component and an electronic component. In order to achieve the modularity and versatility of the design, they are generally separated:</p><ul><li>The electronic component is called a device controller (or adapter), and in a personal computer, it is usually a printed circuit board inserted into the main board expansion slot.<br>The mechanical part is the equipment itself.</li></ul><blockquote><p>A few points to note:</p><p>The device controller mentioned here refers to the controller inside the hardware device, not the controller in the previous DMA controller.</p><p>Device independence is the public operation of the device, such as permission authentication, error checking, and using caching to unify blocks of different sizes from different devices into blocks of the same logical size.</p><p>Specific system command parsing and execution require underlying device drivers.</p><p>Interrupt handlers are at the level of the entire operating system, not just used in I/O.</p></blockquote><p>The device controller communicates with the CPU through registers. On some computers, these registers occupy a portion of the memory address, called memory image I/O; other computers use I/O-specific addresses, and the registers are addressed independently.</p><p>The operating system performs I/O functions by writing command words to the controller register. After the controller receives a command, the CPU can switch to other tasks and let the device controller complete the specific I/O operations on its own.</p><p>When the command is executed, the controller sends an interrupt signal, the operating system to re-obtain the execution authority of the CPU and check the execution result, then the CPU still reads information from the controller register to obtain the execution result and the status information of the device.</p><p>The main functions of the device controller are as follows:</p><ul><li>Receive and recognize commands sent by the CPU or channel, such as the disk controller can accept read, write, and find commands.</li><li>Implement data exchange, including data transmission between devices and controllers, through data buses or channels, between controllers and main memory.</li><li>Discover and record the status information of the device and itself for CPU processing.</li><li>Device address recognition.</li></ul><p>In order to achieve the above functions, the device controller must contain the following parts:</p><ul><li>Device controller and CPU interface. This interface has three types of signal lines: data lines, address lines and control lines. Data lines are usually connected to two types of registers, data registers (which store input data sent from the device or output data sent from the CPU) and control/status registers (which store control information sent from the CPU or device status information)</li><li>Device controller and device interface. The device controller needs a corresponding number of interfaces to connect the device. One interface connects a device. There are three types of signals: data, control and status in each interface.</li><li>I/O control logic. It is used to realize the control of the device. It interacts with the CPU through a set of control lines and decodes the I/O commands received from the CPU. When the CPU starts the device, it sends the start command to the controller, and at the same time sends the address to the controller through the address line. The I/O logic of the controller decodes the address and selects the device accordingly for control.</li></ul><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1641603845/origin-of-ray/asynccode_ci8aj8.png" alt="img"></p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/2022/01/07/operating-system-note-7-io-introduction/" title="Operating System Learning Notes (7) Overview of I&#x2F;O Management">https://sunra.top/en/2022/01/07/operating-system-note-7-io-introduction/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/2022/01/02/operating-system-note-6-file-system-implementation/" rel="prev" title="Operating System Learning Notes (6) Implementation of File Management System"><i class="fa fa-chevron-left"></i> Operating System Learning Notes (6) Implementation of File Management System</a></div><div class="post-nav-item"> <a href="/en/2022/01/14/operating-system-note-8-io-subsystem/" rel="next" title="Operating System Learning Notes (8) I/O Management Subsystem">Operating System Learning Notes (8) I/O Management Subsystem<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/en/js/third-party/math/mathjax.js"></script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/2022/01/07/operating-system-note-7-io-introduction/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>