<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="Today, I accidentally clicked on a series of articles on Performance optimization in MDN, learned a lot of new things, and reorganized a lot of old things. For example, the loading order of different"><meta property="og:type" content="article"><meta property="og:title" content="Web Performance Indicators and Optimization Methods"><meta property="og:url" content="https://sunra.top/en/2022/09/30/web-performance-indicators-and-optimization-method/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="Today, I accidentally clicked on a series of articles on Performance optimization in MDN, learned a lot of new things, and reorganized a lot of old things. For example, the loading order of different"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2022-09-30T08:23:12.000Z"><meta property="article:modified_time" content="2025-06-10T14:26:28.286Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://sunra.top/en/2022/09/30/web-performance-indicators-and-optimization-method/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/2022/09/30/web-performance-indicators-and-optimization-method/","path":"2022/09/30/web-performance-indicators-and-optimization-method/","title":"Web Performance Indicators and Optimization Methods"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Web Performance Indicators and Optimization Methods | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#performance-metrics-for-web-rendering"><span class="nav-number">1.</span> <span class="nav-text">Performance Metrics for Web Rendering</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#browser-rendering-principle-and-critical-rendering-path"><span class="nav-number">2.</span> <span class="nav-text">Browser rendering principle and critical rendering path</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#step-1-navigation"><span class="nav-number">2.1.</span> <span class="nav-text">Step 1: Navigation</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#dns-query"><span class="nav-number">2.1.1.</span> <span class="nav-text">DNS query</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tcp-handshake"><span class="nav-number">2.1.2.</span> <span class="nav-text">TCP handshake</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tls-negotiation"><span class="nav-number">2.1.3.</span> <span class="nav-text">TLS Negotiation</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step-2-respond"><span class="nav-number">2.2.</span> <span class="nav-text">Step 2: Respond</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#tcp-slow-start14kb-rule"><span class="nav-number">2.2.1.</span> <span class="nav-text">TCP slow start&#x2F;14kB rule</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step-3-parsing-and-rendering"><span class="nav-number">2.3.</span> <span class="nav-text">Step 3: Parsing and Rendering</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#critical-rendering-path-crp"><span class="nav-number">2.3.1.</span> <span class="nav-text">Critical Rendering Path (CRP)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#dom-document-object-model"><span class="nav-number">2.3.1.1.</span> <span class="nav-text">DOM (Document Object Model)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#cssom"><span class="nav-number">2.3.1.2.</span> <span class="nav-text">CSSOM</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#rendering-tree"><span class="nav-number">2.3.1.3.</span> <span class="nav-text">Rendering tree</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#layout"><span class="nav-number">2.3.1.4.</span> <span class="nav-text">Layout</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#draw"><span class="nav-number">2.3.1.5.</span> <span class="nav-text">Draw</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#preload-scanner"><span class="nav-number">2.3.2.</span> <span class="nav-text">Preload scanner</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step-4-interaction"><span class="nav-number">2.4.</span> <span class="nav-text">Step 4: Interaction</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#summary-of-optimization-methods"><span class="nav-number">3.</span> <span class="nav-text">Summary of optimization methods</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#navigation-phase"><span class="nav-number">3.1.</span> <span class="nav-text">Navigation phase</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#response-phase"><span class="nav-number">3.2.</span> <span class="nav-text">Response phase</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#analytic-phase"><span class="nav-number">3.3.</span> <span class="nav-text">Analytic phase</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#interaction-phase"><span class="nav-number">3.4.</span> <span class="nav-text">Interaction phase</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#optimize-the-first-screen-time"><span class="nav-number">3.5.</span> <span class="nav-text">Optimize the first screen time</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#coding-optimization"><span class="nav-number">3.6.</span> <span class="nav-text">Coding optimization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#static-resource-optimization"><span class="nav-number">3.7.</span> <span class="nav-text">Static resource optimization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#network-optimization"><span class="nav-number">3.8.</span> <span class="nav-text">Network optimization</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/2022/09/30/web-performance-indicators-and-optimization-method/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Web Performance Indicators and Optimization Methods | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Web Performance Indicators and Optimization Methods</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2022-09-30 16:23:12" itemprop="dateCreated datePublished" datetime="2022-09-30T16:23:12+08:00">2022-09-30</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2025-06-10 22:26:28" itemprop="dateModified" datetime="2025-06-10T22:26:28+08:00">2025-06-10</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Sundry/" itemprop="url" rel="index"><span itemprop="name">Sundry</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/2022/09/30/web-performance-indicators-and-optimization-method/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/2022/09/30/web-performance-indicators-and-optimization-method/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>Today, I accidentally clicked on a series of articles on Performance optimization in MDN, learned a lot of new things, and reorganized a lot of old things.</p><p>For example, the loading order of different types of HTML resources, whether they will block each other, etc., and for example, learned some new optimization methods, such as 14K optimization, dns-prefetch, etc</p><p>This is the entry address: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/zh-CN/docs/Web/Performance">https://developer.mozilla.org/zh-CN/docs/Web/Performance</a></p><span id="more"></span><h2 id="performance-metrics-for-web-rendering"><a class="markdownIt-Anchor" href="#performance-metrics-for-web-rendering"></a> Performance Metrics for Web Rendering</h2><p>Before proceeding with Performance optimization, we need to choose the right metric (performance metric) for the application and set a reasonable optimization goal.</p><p>Not all metrics are equally important, depending on your application. Finally, set a realistic goal based on the metric.</p><p>Here are some indicators worth considering:</p><p>First effective drawing (First Meaningful Paint, or FMP for short, when the main content is rendered on the page)</p><ul><li><p>Hero Rendering Times (a new metric for measuring User Experience when the content users care about most is rendered)</p></li><li><p>Time to Interactive (TTI for short, refers to the fact that the page layout has been stabilized, key page fonts are visible, and the main process can be used to process user input, basically the user can click on the UI and interact with it)</p></li></ul><p>Input responsiveness (the time it takes for the interface to respond to user input)</p><ul><li>Perceptual Speed Index (PSI for short, measures the visual change speed of the page during loading, the lower the score, the better)</li></ul><p>Custom metrics, determined by business needs and User Experience.</p><p>FMP is very similar to hero rendering time, but they are different in that FMP does not distinguish whether the content is useful or not, and does not distinguish whether the rendered content is of concern to the user.</p><p>Based on these metrics and the RAIL performance model, we can set some goals, such as</p><ul><li><p>100ms interface response time with 60FPS</p></li><li><p>Speed Index less than 1250ms</p></li><li><p>3G network environment interaction time is less than 5s</p></li><li><p>The size budget of important files is less than 170kb</p></li></ul><h2 id="browser-rendering-principle-and-critical-rendering-path"><a class="markdownIt-Anchor" href="#browser-rendering-principle-and-critical-rendering-path"></a> Browser rendering principle and critical rendering path</h2><p>Responsive websites provide a better User Experience. Users expect fast content loading and smooth interactive web experiences.</p><p>Waiting for resources to load and single-threaded browser execution in most cases are the two main reasons that affect web performance.</p><p>Latency is a major threat that needs to be overcome to get the browser to load resources quickly. In order to achieve fast loading, the developer’s goal is to send the requested information as quickly as possible, at least seemingly fairly fast. Network latency is the link transfer time it takes to transfer the binary on the link to the computer. All Web Performance optimization needs to do is to make the page load as fast as possible.</p><p>In most cases, browsers execute single-threaded. In order to have smooth interactions, developers aim to ensure interactive performance of the website from smooth page scrolling to click-response. Rendering time is a key element, ensuring that the main thread can complete all the tasks given to it and still handle user interactions all the time. By understanding the single-threaded nature of browsers and minimizing the responsibility of the main thread, web performance can be optimized to ensure smooth rendering and timely interaction responses.</p><h3 id="step-1-navigation"><a class="markdownIt-Anchor" href="#step-1-navigation"></a> Step 1: Navigation</h3><p>Navigation is the first step in loading a web page. It occurs in the following situations: users enter a URL in the address bar, click a link, submit a form, or other actions.</p><p>One of the goals of Web Performance optimization is to reduce the time it takes for navigation to complete. Ideally, it usually doesn’t take much time, but waiting time and bandwidth can cause it to lag.</p><h4 id="dns-query"><a class="markdownIt-Anchor" href="#dns-query"></a> DNS query</h4><p>The first step in navigating a web page is to find the location of the page resource. If you navigate to the <a target="_blank" rel="external nofollow noopener noreferrer" href="https://example.com">https://example.com</a>, the HTML page is located on a server with an IP address of 93.184.216.34. If you have not visited this website before, you need to do a DNS query.</p><p>The browser initiates a DNS query request to the name server and finally gets an IP address. After the first request, this IP address may be cached for a period of time, which can speed up subsequent requests by retrieving the IP address from the cache instead of querying it through the name server.</p><p>Loading a page by hostname usually requires only one DNS query. However, multiple DNS queries are required for different hostnames pointed to by the page. If fonts, images, scripts, ads, and metrics all have different hostnames, a DNS query is required for each hostname.</p><h4 id="tcp-handshake"><a class="markdownIt-Anchor" href="#tcp-handshake"></a> TCP handshake</h4><p>Once the server IP address is obtained, the browser will establish a connection with the server through the TCP “three-way handshake” (en-US). This mechanism is used to allow both ends to try to communicate - some parameters of the network TCP socket connection can be negotiated before the browser and server send data through the upper layer protocol HTTPS.</p><p>TCP’s “three-way handshake” technique is often referred to as “SYN-SYN-ACK” - more specifically SYN, SYN-ACK, ACK - because three messages are first sent over TCP for negotiation, and then a TCP session is started between two computers. Yes, this means that three messages are sent back and forth between the end point and each server, and the request has not yet been issued.</p><h4 id="tls-negotiation"><a class="markdownIt-Anchor" href="#tls-negotiation"></a> TLS Negotiation</h4><p>In order to establish a secure connection over HTTPS, another handshake is necessary. More specifically, TLS negotiation, which determines what password will be used to encrypt communication, authenticate the server, and establish a secure connection before the real data transmission takes place. Three round trips to the server are required before sending the real requested content.</p><p>Although establishing a secure connection increases the waiting time for loading pages, it is worth the cost of increasing the waiting time for establishing a secure connection, because the data transmitted between the browser and the web server cannot be decrypted by a third party.</p><p>After 8 round trips, the browser can finally make the request.</p><h3 id="step-2-respond"><a class="markdownIt-Anchor" href="#step-2-respond"></a> Step 2: Respond</h3><p>Once we establish a connection to the web server, the browser sends an initial HTTP GET request on behalf of the user. For websites, this request is usually an HTML file. Once the server receives the request, it will reply with the relevant response headers and HTML content.</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>My simple page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">src</span>=<span class="string">&quot;styles.css&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;myscript.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;heading&quot;</span>&gt;</span>My Page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>A paragraph with a <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://example.com/about&quot;</span>&gt;</span>link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;myimage.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;image description&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;anotherscript.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>The response to the initial request contains the first byte of the received data. Time to First Byte (TTFB) is the time between the user making the request by clicking on the link and receiving the first HTML data packet. The first content block is usually 14KB of data.</p><p>In the above example, this request is definitely less than 14KB, but it will not request the linked resource until the browser encounters the link in the parsing phase, which is described below.</p><h4 id="tcp-slow-start14kb-rule"><a class="markdownIt-Anchor" href="#tcp-slow-start14kb-rule"></a> TCP slow start/14kB rule</h4><p>The first response data packet is 14KB in size. This is part of Slow Start, an algorithm to equalize network connection speeds. Slow Start gradually increases the amount of data sent until the maximum bandwidth of the network is reached.</p><p>In TCP Slow Start, after receiving the initial packet, the server doubles the size of the next data packet to approximately 28KB. Subsequent data packets in turn double the size of the previous packet until a predetermined threshold is reached, or congestion is encountered.</p><p>If you’ve heard of the 14KB rule for initial page load, TCP slow start is the reason why the initial response is 14KB, and why web Performance optimization needs to make this initial 14KB response the focus of optimization. TCP slow start gradually establishes a transmission speed suitable for network capacity to avoid congestion.</p><h3 id="step-3-parsing-and-rendering"><a class="markdownIt-Anchor" href="#step-3-parsing-and-rendering"></a> Step 3: Parsing and Rendering</h3><p>Once the browser receives the first piece of data, it can start parsing the received information. “Parsing” is the step by which the browser converts the data received over the network into DOM and CSSOM, which are drawn on the screen as pages through renderers.</p><p>The DOM is the internal representation of browser markup. The DOM is also exposed and can be manipulated through various APIs in JavaScript.</p><p>Even if the HTML of the requested page is larger than the initial 14KB data packet, the browser will start parsing and trying to render based on the data it has. This is why it is important for web Performance optimization to include everything the browser needs to start rendering the page in the first 14KB, or at least page templates (CSS and HTML required for the first render). But before rendering onto the screen, HTML, CSS, JavaScript must be parsed.</p><h4 id="critical-rendering-path-crp"><a class="markdownIt-Anchor" href="#critical-rendering-path-crp"></a> Critical Rendering Path (CRP)</h4><p>A Document Object Model is created when parsing HTML. HTML can request JavaScript, which in turn, can change the DOM. HTML contains or requests styles, which in turn build the CSS object model. The browser engine combines the two to create a render tree. Layout determines the size and position of everything on the page. Once layout is determined, pixels are drawn onto the screen.</p><p>Optimizing the critical rendering path can shorten the time to first render. Understanding and optimizing the critical rendering path is important to ensure that rearrangements and repaints can be done at a speed of 60 frames per second to ensure efficient user interaction and avoid nuisance.</p><p>Web performance includes server requests and responses, loading, executing scripts, rendering, layout, and drawing each pixel to the screen.</p><p>A web page request starts with a request for an HTML file. The server returns HTML – response headers and data. Then the browser starts parsing the HTML, transforming the received data into a DOM tree. The browser initializes the request every time it finds an external resource, whether it’s a style, script, or embedded image reference. Sometimes requests block, which means parsing the remaining HTML is terminated until important resources are processed. The browser then parses the HTML, sends requests and constructs the DOM until the end of the file, at which point it starts constructing the CSS object model. Once the DOM and CSSOM are complete, the browser constructs the render tree and calculates the style of all visible content. Once the render tree is complete, the layout begins, defining the location and size of all render tree elements. After completion, the page is rendered, or drawn onto the screen.</p><h5 id="dom-document-object-model"><a class="markdownIt-Anchor" href="#dom-document-object-model"></a> DOM (Document Object Model)</h5><p>DOM builds are incremental. HTML responses become tokens, tokens become nodes, and nodes become DOM trees. A single DOM node starts with a startTag token and ends with an endTag token. Nodes contain all relevant information about HTML elements. This information is described using tokens. Nodes are connected into the DOM tree according to the token hierarchy. If another set of startTag and endTag tokens is between a set of startTag and endTag, you have a node within the node, which is how we define the DOM tree hierarchy.</p><p>The greater the number of nodes, the longer subsequent events in the critical rendering path will take.</p><h5 id="cssom"><a class="markdownIt-Anchor" href="#cssom"></a> CSSOM</h5><p>The DOM contains all the content of the page. CSSOM contains all the styles of the page, that is, how to display information about the DOM. CSSOM is similar to DOM, but different. DOM construction is incremental, CSSOM is not. CSS is render-blocking: the browser blocks the page rendering until it has received and executed all CSS. CSS is render-blocking because rules can be overridden, so content cannot be rendered until CSSOM is complete.</p><p>CSS has its own set of rules for defining tags. Note that the C in CSS stands for “cascading”. CSS rules are cascaded. As the parser transforms tags into nodes, descendants of nodes inherit styles. Incremental processing functions like processing HTML are not applied to CSS because subsequent rules may be overwritten by previous ones. The CSS object model is built as CSS is parsed, but cannot be used to build render trees until it is finished, because styles will be overwritten by subsequent parsing and should not be rendered to the screen.</p><p>From a selector performance perspective, fewer specific selectors are faster than more. For example, .foo {} is faster than .bar.foo {} because when the browser finds .foo, it must then go up the DOM to check if .foo has an ancestor .bar. The more specific the tag browser requires more work, but such drawbacks are not necessarily worth optimizing.</p><p>If you measure the time it takes to parse CSS, you’ll be amazed at how fast browsers are. More specific rules are more expensive because they have to traverse more DOM tree nodes, but the additional overhead is usually small. Measure first. Then optimize on demand. Specification may not be your low-hanging fruit. Performance optimization of selectors in CSS, the improvement is only millisecond-level. There are other ways to optimize CSS, such as compression and using media queries to asynchronously handle requests that CSS is non-blocking.</p><h5 id="rendering-tree"><a class="markdownIt-Anchor" href="#rendering-tree"></a> Rendering tree</h5><p>The render tree includes content and styles: the DOM and CSSOM trees are combined into a render tree. To construct the render tree, the browser checks each node, starting from the root node of the DOM tree, and decides which CSS rules to add.</p><p>The render tree only contains visible content. The header (usually) does not contain any visible information, so it will not be included in the render tree. If there is an element with display: none; on it, neither it nor its descendants will appear in the render tree.</p><h5 id="layout"><a class="markdownIt-Anchor" href="#layout"></a> Layout</h5><p>Once the render tree is built, layout becomes possible. Layout depends on the size of the screen. Layout This step determines where and how elements are placed on the page, the width and height of each element, and the correlation between them.</p><p>What is the width of an element? Block-level elements, by definition, have 100% of the parent’s width by default. An element with a width of 50%, will occupy half of the parent’s width. Unless otherwise defined, the body is 100% wide, meaning it occupies 100% of the window. The width of the device affects the layout.</p><p>The meta tag of the window defines the width of the layout window, thus affecting the layout. If not, the browser uses the default width of the window, and the default full-screen browser is usually 960px. By default in a full-screen browser like your mobile browser, by setting &lt; meta name = “viewport” content = “width = device-width” &gt;, the width will be the width of the device instead of the default window width. Device width will change when users rotate their phone in landscape and portrait modes. Layout occurs every time the device rotates or the browser scales.</p><p>Layout performance is affected by the DOM - the more nodes, the longer the layout takes. The layout will become a bottleneck and will cause hysteresis if scrolling or other animation is required during the process. A 20ms delay may be acceptable for loading or direction changes, but it will be sluggish for animation or scrolling. Layout occurs whenever the render tree changes, such as adding nodes, changing content, or updating the box model style at a node.</p><p>To reduce the frequency and duration of layout events, batch update or avoid changing box model properties.</p><h5 id="draw"><a class="markdownIt-Anchor" href="#draw"></a> Draw</h5><p>The final step is to draw the pixels on the screen. Once the render tree is created and the layout is complete, the pixels can be drawn on the screen. When loaded, the entire screen is drawn. After that, only the affected screen area will be redrawn, and the browser is optimized to redraw only the smallest area that needs to be drawn. Draw time depends on what type of update is attached to the render tree. Drawing is a very fast process, so focusing on improving performance is probably not the most effective part. The important thing to remember is that when measuring the time required for an animation frame, layout and redraw time need to be taken into account. Styles added to the node will increase the render time, but removing the 0.001ms added by the style may not give your optimization value for money. Remember to measure first. Then you can decide its optimization priority.</p><h4 id="preload-scanner"><a class="markdownIt-Anchor" href="#preload-scanner"></a> Preload scanner</h4><p>When the browser builds the DOM tree, this process takes up the main thread. When this happens, the preload scanner will parse the available content and request high-priority resources such as CSS, JavaScript, and web fonts. Thanks to the preload scanner, we don’t have to wait until the parser finds a reference to an external resource to request it. It will retrieve resources in the background so that by the time the main HTML parser reaches the requested resource, they may already be running, or have already been downloaded. The optimization provided by the preload scanner reduces blocking.</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">src</span>=<span class="string">&quot;styles.css&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;myscript.js&quot;</span> <span class="attr">async</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;myimage.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;image description&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;anotherscript.js&quot;</span> <span class="attr">async</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>In this example, when the main thread is parsing HTML and CSS, the preload scanner will find the script and image and start downloading them. To ensure that the script does not block the process, the async attribute or defer attribute can be added when the order of JavaScript parsing and execution is not important.</p><p>Waiting to fetch CSS will not block HTML parsing or downloading, but it does block JavaScript, because JavaScript is often used to query CSS properties of elements.</p><h3 id="step-4-interaction"><a class="markdownIt-Anchor" href="#step-4-interaction"></a> Step 4: Interaction</h3><p>Once the main thread draws the page, you would think we are “ready”, but this is not the case. If the load contains JavaScript (and is delayed until the onload event fires), the main thread may be busy and cannot be used for scrolling, touching, and other interactions.</p><p>Time to Interactive (en-US) (TTI) is a measure of the time it takes from the first request to cause DNS queries and SSL connections to make the page interactive - interoperable is the point in time after First Contentful Paint (en-US), and the page responds to user interaction within 50ms. If the main thread is parsing, compiling, and executing JavaScript, it is unavailable and therefore cannot respond to user interaction in a timely manner (less than 50ms).</p><p>In our example, the image may load quickly, but the anotherscript.js file may be 2MB, and the user’s network connection is slow. In this case, the user can see the page very quickly, but cannot scroll until the script is downloaded, parsed, and executed. This is not a good User Experience. Avoid occupying the main thread</p><h2 id="summary-of-optimization-methods"><a class="markdownIt-Anchor" href="#summary-of-optimization-methods"></a> Summary of optimization methods</h2><h3 id="navigation-phase"><a class="markdownIt-Anchor" href="#navigation-phase"></a> Navigation phase</h3><ul><li>Pre-resolve the IP Address corresponding to the domain name through dns-prefetch, reducing navigation time</li><li>Try to put different resources under the same server domain name to reduce the need for DNS resolution</li></ul><h3 id="response-phase"><a class="markdownIt-Anchor" href="#response-phase"></a> Response phase</h3><ul><li>Render the first screen page through SSR.</li><li>The required content of the first screen page should be as small as 14kb as possible, so that it can be returned and loaded at one time in the first packet of TCP</li></ul><h3 id="analytic-phase"><a class="markdownIt-Anchor" href="#analytic-phase"></a> Analytic phase</h3><ul><li>Use preload scanner, Resource Hints like preload, prefetch etc</li><li>Reasonably plan the location of css and script tags, because css will not block html parsing, but will block js parsing and execution, and js will block html parsing if it is not defer or async</li><li>Use CDN to speed up the loading of resources</li><li>Load key CSS first, and split the CSS required for the first screen separately</li></ul><h3 id="interaction-phase"><a class="markdownIt-Anchor" href="#interaction-phase"></a> Interaction phase</h3><ul><li>Optimize the writing of JS: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Learn/Performance/JavaScript">https://developer.mozilla.org/en-US/docs/Learn/Performance/JavaScript</a></li></ul><h3 id="optimize-the-first-screen-time"><a class="markdownIt-Anchor" href="#optimize-the-first-screen-time"></a> Optimize the first screen time</h3><p>Improving page loading speed requires prioritizing resources being loaded, controlling the order in which they are loaded, and reducing the size of these resources.</p><ul><li>Reduce the number of requests by downloading important resources asynchronously</li><li>Optimize the number of requests required and the file size per request</li><li>Reduce Critical Path length by prioritizing critical resources to optimize the order in which critical resources are loaded.</li></ul><h3 id="coding-optimization"><a class="markdownIt-Anchor" href="#coding-optimization"></a> Coding optimization</h3><p>In fact, the speed of data access is divided into speed. Here are several factors that affect the speed of data access:</p><p>Literals and local variables have the fastest access speed, while array elements and object members are relatively slow</p><ul><li><p>The longer the search process of variables from local scope to global scope, the slower it is</p></li><li><p>The deeper the object is nested, the slower the read speed</p></li><li><p>The deeper an object exists in the prototype chain, the slower it will be to find it</p></li><li><p>The recommended practice is to cache object member values. Caching object member values in local variables will speed up access</p></li></ul><p>When the application is running, the performance bottleneck is mainly that the cost of DOM operations is very expensive. Here are some suggestions for improving performance related to DOM operations:</p><ul><li><p>Accessing the DOM in JS is very expensive. Please try to reduce the number of times you access the DOM (it is recommended to cache DOM attributes and elements, cache the length of the DOM collection into variables and use them in iterations. Reading variables is much faster than reading DOM.)</p></li><li><p>Rearrangements and repaints are very expensive. If the operation requires multiple rearrangements and repaints, it is recommended to remove the element from the doc stream first, and then return the element to the doc stream after processing, so that the browser will only rearrange and repaint twice (during detachment and during regression).</p></li><li><p>Good at using event delegation</p></li></ul><p>Here are some details related to process control that can slightly improve performance, which are widely used in large open source projects (such as Vue).</p><ul><li><p>Avoid using for… in (it can enumerate to the prototype, so it is slow)</p></li><li><p>Reverse looping in JS will slightly improve performance</p></li><li><p>Reduce the number of iterations</p></li><li><p>Loop-based iteration is 8x faster than function-based iteration</p></li><li><p>Replacing a lot of if-else and switch with Map tables will improve performance</p></li></ul><h3 id="static-resource-optimization"><a class="markdownIt-Anchor" href="#static-resource-optimization"></a> Static resource optimization</h3><ul><li><p>Plain text compression with Brotli or Zopfli</p></li><li><p>Use responsive images via srcset, sizes and &lt; picture &gt; elements whenever possible. You can also use WebP formatted images via the &lt; picture &gt; element.</p></li><li><p>Compression and resolution of products using Tree-shaking, code-splitting, etc</p></li></ul><h3 id="network-optimization"><a class="markdownIt-Anchor" href="#network-optimization"></a> Network optimization</h3><ul><li>Use HTTP cache</li></ul><p>Use HTTP2 to reuse Merge Requests</p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/2022/09/30/web-performance-indicators-and-optimization-method/" title="Web Performance Indicators and Optimization Methods">https://sunra.top/en/2022/09/30/web-performance-indicators-and-optimization-method/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/2022/09/26/missing-two-lcci/" rel="prev" title="The Two Numbers That Disappeared"><i class="fa fa-chevron-left"></i> The Two Numbers That Disappeared</a></div><div class="post-nav-item"> <a href="/en/2022/10/08/flexbox-introduction/" rel="next" title="Basic concepts of flex layout">Basic concepts of flex layout<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" integrity="sha256-hLTCMFlKxdNgPXyWlSSxYN0ykJmxxq9Yt3MNfdRGWeA=" crossorigin="anonymous"><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/2022/09/30/web-performance-indicators-and-optimization-method/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>