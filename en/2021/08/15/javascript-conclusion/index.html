<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="How Google V8 executes a piece of JavaScript code This article is mainly a simple and unified summary of some old-fashioned JavaScript features, and a certain explanation of how V8 implements these fe"><meta property="og:type" content="article"><meta property="og:title" content="JavaScript Execution Mechanism (9) Phase Summary"><meta property="og:url" content="https://sunra.top/en/2021/08/15/javascript-conclusion/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="How Google V8 executes a piece of JavaScript code This article is mainly a simple and unified summary of some old-fashioned JavaScript features, and a certain explanation of how V8 implements these fe"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629333912/origin-of-ray/image_i6nsuc.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629333910/origin-of-ray/image_1_brpduf.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629333911/origin-of-ray/image_2_oggn7i.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629333910/origin-of-ray/34853ef8-c9f1-4b94-b697-128e4aeb7ef0_ktq7xf.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1615119851/origin-of-ray/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20210307201954_os3t8h.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1608036133/origin-of-ray/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20201215204157_g15aka.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1639981643/origin-of-ray/6d3f803c-7ad8-4cff-8160-478a702f7475_rmgbzn.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1615206965/origin-of-ray/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20210308203554_ww6kdz.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1608035556/origin-of-ray/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20201215203215_aj5gbh.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334292/origin-of-ray/4380eae2-e84e-412d-a72f-7a95180fb897_wxblbk.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629333909/origin-of-ray/4b286cfd-0164-4d55-b9bb-29568b622b81_wqnhy4.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334393/origin-of-ray/1_gkzipy.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334394/origin-of-ray/5c4d6601-2746-4ebe-92a8-69f4721bb956_rt0a1c.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334395/origin-of-ray/7d99c846-3ad9-435a-8947-3218c8587e77_cx6wnz.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334396/origin-of-ray/657aecbf-c219-42f2-a2d3-89bc3a2a299b_vgprhc.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334394/origin-of-ray/6d0c4f0a-6126-419b-a0af-0d0a1c56a408_mkfmzt.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334521/origin-of-ray/1f181f36-9544-4b9b-850c-70630a8a8f17_st0vsg.png"><meta property="article:published_time" content="2021-08-15T07:44:39.000Z"><meta property="article:modified_time" content="2024-09-07T00:05:28.490Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629333912/origin-of-ray/image_i6nsuc.png"><link rel="canonical" href="https://sunra.top/en/2021/08/15/javascript-conclusion/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/2021/08/15/javascript-conclusion/","path":"2021/08/15/javascript-conclusion/","title":"JavaScript Execution Mechanism (9) Phase Summary"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>JavaScript Execution Mechanism (9) Phase Summary | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#how-to-execute-javascript-in-v8"><span class="nav-number">1.</span> <span class="nav-text">How to Execute JavaScript in V8</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#two-ways-of-high-level-language-execution"><span class="nav-number">1.1.</span> <span class="nav-text">Two ways of high-level language execution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#why-does-v8-use-bytecode"><span class="nav-number">1.2.</span> <span class="nav-text">Why does V8 use bytecode?</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#variables-how-to-store-and-find-them-quickly"><span class="nav-number">2.</span> <span class="nav-text">Variables: How to store and find them quickly</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#scope-promotion-if-there-is-no-block-level-context-then-no-block-level-scope-is-designed"><span class="nav-number">2.1.</span> <span class="nav-text">Scope promotion: If there is no block-level context, then no block-level scope is designed</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#scope-add-block-level-scope-how-to-find-variables-in-the-current-context"><span class="nav-number">2.2.</span> <span class="nav-text">Scope: Add block-level scope, how to find variables in the current context</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#scope-chain-how-to-find-variables-in-the-call-stack-if-they-cannot-be-found-in-the-current-context"><span class="nav-number">2.3.</span> <span class="nav-text">Scope chain: How to find variables in the call stack if they cannot be found in the current context</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#after-finding-a-variable-how-to-find-a-property-on-a-variable-itself"><span class="nav-number">2.4.</span> <span class="nav-text">After finding a variable, how to find a property on a variable itself?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#prototype-chain-if-the-variable-itself-does-not-have-this-property-where-to-find-it"><span class="nav-number">2.5.</span> <span class="nav-text">Prototype chain: If the variable itself does not have this property, where to find it</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#thinking-what-code-security-issues-will-the-prototype-chain-bring"><span class="nav-number">2.5.1.</span> <span class="nav-text">Thinking: What code security issues will the prototype chain bring?</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#where-do-variables-exist-heap-stack"><span class="nav-number">2.6.</span> <span class="nav-text">Where do variables exist? heap? stack?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#this"><span class="nav-number">2.7.</span> <span class="nav-text">This</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#garbage-collection-mechanism"><span class="nav-number">2.8.</span> <span class="nav-text">Garbage collection mechanism</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#thinking-several-common-memory-problems"><span class="nav-number">2.9.</span> <span class="nav-text">Thinking: Several common memory problems</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#memory-leak"><span class="nav-number">2.9.1.</span> <span class="nav-text">Memory leak</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#memory-inflation"><span class="nav-number">2.9.2.</span> <span class="nav-text">Memory inflation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#frequent-garbage-collection"><span class="nav-number">2.9.3.</span> <span class="nav-text">Frequent garbage collection</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#function"><span class="nav-number">3.</span> <span class="nav-text">Function</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#why-functions-are-first-class-citizens-in-javascript"><span class="nav-number">3.1.</span> <span class="nav-text">Why functions are first class citizens in JavaScript.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#delayed-resolution-and-closure"><span class="nav-number">3.2.</span> <span class="nav-text">Delayed resolution and closure</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#delay-resolution"><span class="nav-number">3.2.1.</span> <span class="nav-text">Delay resolution</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#basis-of-closure-functioning-as-first-class-citizens"><span class="nav-number">3.2.2.</span> <span class="nav-text">Basis of closure: functioning as first-class citizens</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#thinking-how-to-achieve-closure-under-delayed-analysis"><span class="nav-number">3.2.3.</span> <span class="nav-text">Thinking: How to achieve closure under delayed analysis</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#event"><span class="nav-number">4.</span> <span class="nav-text">Event</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#prior-knowledge"><span class="nav-number">4.1.</span> <span class="nav-text">Prior knowledge:</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#process-thread-coroutine"><span class="nav-number">4.1.1.</span> <span class="nav-text">Process, thread, coroutine</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#message-queue-macro-task"><span class="nav-number">4.1.2.</span> <span class="nav-text">Message queue (macro task)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#micro-tasks-solved-the-problem-of-uncontrollable-macro-task-execution-timing"><span class="nav-number">4.1.3.</span> <span class="nav-text">Micro-tasks (solved the problem of uncontrollable macro task execution timing)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#advance-of-asynchronous-syntax"><span class="nav-number">4.2.</span> <span class="nav-text">Advance of asynchronous syntax</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#think-many-apis-in-node-provide-synchronous-and-asynchronous-functions-what-is-the-difference"><span class="nav-number">4.3.</span> <span class="nav-text">Think: Many APIs in Node provide synchronous and asynchronous functions. What is the difference?</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#read-files-asynchronously"><span class="nav-number">4.3.1.</span> <span class="nav-text">Read files asynchronously</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#synchronous-read-file"><span class="nav-number">4.3.2.</span> <span class="nav-text">Synchronous read file</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#summary"><span class="nav-number">5.</span> <span class="nav-text">Summary</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#implementation-process"><span class="nav-number">5.1.</span> <span class="nav-text">Implementation process</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#coding-attention"><span class="nav-number">5.2.</span> <span class="nav-text">Coding attention</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/2021/08/15/javascript-conclusion/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="JavaScript Execution Mechanism (9) Phase Summary | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> JavaScript Execution Mechanism (9) Phase Summary</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2021-08-15 15:44:39" itemprop="dateCreated datePublished" datetime="2021-08-15T15:44:39+08:00">2021-08-15</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2024-09-07 08:05:28" itemprop="dateModified" datetime="2024-09-07T08:05:28+08:00">2024-09-07</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/2021/08/15/javascript-conclusion/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/2021/08/15/javascript-conclusion/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>How Google V8 executes a piece of JavaScript code</p><p>This article is mainly a simple and unified summary of some old-fashioned JavaScript features, and a certain explanation of how V8 implements these features.</p><p>The main purpose is to introduce the execution flow of V8 and string together familiar features to form an overall understanding and why JavaScript is designed the way it is.</p><p>There will be some thoughts interspersed in the middle, such as some problems we should avoid in coding.</p><span id="more"></span><h2 id="how-to-execute-javascript-in-v8"><a class="markdownIt-Anchor" href="#how-to-execute-javascript-in-v8"></a> How to Execute JavaScript in V8</h2><h3 id="two-ways-of-high-level-language-execution"><a class="markdownIt-Anchor" href="#two-ways-of-high-level-language-execution"></a> Two ways of high-level language execution</h3><p>A piece of code must eventually become binary code that the CPU can recognize before it can run.</p><p>Therefore, the code of the high-level language must be compiled before it can be executed.</p><p>But there are two ways of execution, the first is interpretation execution and the other is compile execution.</p><blockquote><p>Note that the interpreted execution and compiled execution here are not exactly the same as the usual interpreted language and compiled language: [Difference between interpreted language and compiled language</p></blockquote><p>The so-called interpreted execution means that the parser parses the high-level language into intermediate code, and then the virtual machine that comes with the language simulates the characteristics of the CPU stack to execute this intermediate code.</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629333912/origin-of-ray/image_i6nsuc.png" alt="img"></p><p>The so-called compile execution means that the compiler compiles the intermediate code into binary code, and then directly hands it over to the CPU for execution.</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629333910/origin-of-ray/image_1_brpduf.png" alt="img"></p><p>It looks like we can only choose one, but V8 says that only children make choices, and I want them all.</p><p>V8 adopts a JIT (Just In Time) technology that mixes compiler and interpreter. This is a trade-off strategy, because each of these two methods has its own advantages and disadvantages. Explanation execution starts fast, but the execution speed is slow, while compile execution starts slowly, but the execution speed is fast. You can refer to the following complete flowchart of V8 executing JavaScript:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629333911/origin-of-ray/image_2_oggn7i.png" alt="img"></p><p>After V8 is started, Memory Space for the heap and stack will be applied from memory. The storage of the stack is contiguous, while the data storage in the heap can be discontinuous.</p><p>Then V8 will initialize the global context, which contains a lot of information, such as the variable environment of the current context and the variables in the global scope in this variable environment.</p><p>Initialize the event loop system. In fact, it is a message queue, and each function in this message queue is what we usually call a macro task.</p><h3 id="why-does-v8-use-bytecode"><a class="markdownIt-Anchor" href="#why-does-v8-use-bytecode"></a> Why does V8 use bytecode?</h3><p>The so-called bytecode refers to the intermediate code in the compile process. You can think of bytecode as an abstraction of machine code. In V8, bytecode has two functions:</p><ul><li>The first is that the interpreter can directly interpret the execution bytecode;</li><li>The second is that the optimization compiler can compile bytecode into binary code and then execute binary machine code.</li></ul><p>Although the current architecture used bytecode, the early V8 was not designed in this way. At that time, the V8 team believed that this method of “generating bytecode and then executing bytecode” had an extra intermediate link, and the extra intermediate link would sacrifice the execution speed of the code.</p><p>In order to improve the execution speed of the code, the early V8 directly compiled the JavaScript source code into binary machine code without optimization. If a certain piece of binary code is executed too frequently, V8 will mark it as hot code, and the hot code will be Optimized by the compiler, the optimized machine code execution efficiency is higher.</p><p>When JavaScript code is executed in the browser, it needs to be compiled by V8 first. Early V8 would compile JavaScript into unoptimized binary machine code, and then execute these unoptimized binary code. Usually, compile occupies a large part of the time. The following is a graph of the compile and execution time of a piece of code:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629333910/origin-of-ray/34853ef8-c9f1-4b94-b697-128e4aeb7ef0_ktq7xf.png" alt="img"></p><p>As can be seen from the figure, the time consumed by compile and the time consumed by execution are about the same. Imagine if the same page is opened again in the browser, when the JavaScript file in the page is not modified, then after compiling again The binary code will also remain unchanged, which means that the compile step is a waste of CPU resources, because it has already been compiled once before.</p><p>This is why Chrome browsers introduced binary code caching, which eliminates redundant compiles by keeping binaries in memory and reusing them for subsequent calls, thus saving the time to compile again.</p><p>However, with the popularity of mobile devices, the V8 team gradually discovered that there are two fatal problems in compiling JavaScript source code directly into binary code.</p><ul><li>Time problem: compiling time is too long, affecting the code startup speed;<br> Space issues: The compiled binary code takes up more memory after caching.</li></ul><p>These two problems will undoubtedly hinder the popularity of V8 on mobile devices, so the V8 team refactored the code on a large scale and introduced bytecode in the middle. The advantages of bytecode are as follows:</p><ul><li>Solve the startup problem: the time to generate bytecode is very short;</li><li>Solve the space problem: bytecode does not occupy much memory, and caching bytecode will greatly reduce memory usage;</li><li>Clear code architecture: Using bytecode can simplify the complexity of the program and make it easier to port V8 to different CPU architecture platforms.</li></ul><h2 id="variables-how-to-store-and-find-them-quickly"><a class="markdownIt-Anchor" href="#variables-how-to-store-and-find-them-quickly"></a> Variables: How to store and find them quickly</h2><h3 id="scope-promotion-if-there-is-no-block-level-context-then-no-block-level-scope-is-designed"><a class="markdownIt-Anchor" href="#scope-promotion-if-there-is-no-block-level-context-then-no-block-level-scope-is-designed"></a> Scope promotion: If there is no block-level context, then no block-level scope is designed</h3><p><a href="https://sunra.top/posts/480b6b42/">Javascript执行机制（一）变量提升</a></p><p>The reason for the scope increase is that JavaScript takes a short time to create, and only the global scope and function scope are relatively simple for compile.</p><p>Why do you say that? We can take a look at the stack to understand that there are only global context and function context in the JavaScript call stack, which can naturally be mapped to global scope and function scope.</p><blockquote><p>Without a block-level context, a block-level scope is not designed.</p></blockquote><blockquote><p>Since the scope of this variable is at the function level, the entire function must be accessible, so the variable is promoted</p></blockquote><p>“Variable promotion” means that the declarations of variables and functions are physically moved to the front of the code, as we simulated. However, this is not accurate. ** In fact, the position of variable and function declarations in the code does not change, and they are put into memory by the JavaScript engine during the compile stage **.</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1615119851/origin-of-ray/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20210307201954_os3t8h.png" alt="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1615119851/origin-of-ray/微信截图_20210307201954_os3t8h.png"></p><h3 id="scope-add-block-level-scope-how-to-find-variables-in-the-current-context"><a class="markdownIt-Anchor" href="#scope-add-block-level-scope-how-to-find-variables-in-the-current-context"></a> Scope: Add block-level scope, how to find variables in the current context</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">1</span></span><br><span class="line">    <span class="keyword">let</span> b = <span class="number">2</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">let</span> b = <span class="number">3</span></span><br><span class="line">      <span class="keyword">var</span> c = <span class="number">4</span></span><br><span class="line">      <span class="keyword">let</span> d = <span class="number">5</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(b)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(b) </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(c)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(d)</span><br><span class="line">&#125;   </span><br><span class="line"><span class="title function_">foo</span>()</span><br></pre></td></tr></table></figure><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1608036133/origin-of-ray/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20201215204157_g15aka.png" alt></p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1639981643/origin-of-ray/6d3f803c-7ad8-4cff-8160-478a702f7475_rmgbzn.png" alt="img"></p><p><a href="https://sunra.top/posts/'48445981'/">Javascript执行机制（二）作用域</a></p><h3 id="scope-chain-how-to-find-variables-in-the-call-stack-if-they-cannot-be-found-in-the-current-context"><a class="markdownIt-Anchor" href="#scope-chain-how-to-find-variables-in-the-call-stack-if-they-cannot-be-found-in-the-current-context"></a> Scope chain: How to find variables in the call stack if they cannot be found in the current context</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(myName)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Var</span> myName = <span class="string">&quot;big tree&quot;</span></span><br><span class="line">    <span class="title function_">bar</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> myName = <span class="string">&quot;bigTree&quot;</span></span><br><span class="line"><span class="title function_">foo</span>()</span><br></pre></td></tr></table></figure><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1615206965/origin-of-ray/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20210308203554_ww6kdz.png" alt></p><h3 id="after-finding-a-variable-how-to-find-a-property-on-a-variable-itself"><a class="markdownIt-Anchor" href="#after-finding-a-variable-how-to-find-a-property-on-a-variable-itself"></a> After finding a variable, how to find a property on a variable itself?</h3><p><a href="https://sunra.top/posts/37711/">Javascript执行机制（七）如何快速查找对象上的属性</a></p><h3 id="prototype-chain-if-the-variable-itself-does-not-have-this-property-where-to-find-it"><a class="markdownIt-Anchor" href="#prototype-chain-if-the-variable-itself-does-not-have-this-property-where-to-find-it"></a> Prototype chain: If the variable itself does not have this property, where to find it</h3><p><a href="https://sunra.top/posts/7a3d3c75/">Javascript执行机制（五）用公式讲清楚原型链</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Parent</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Parent</span>();</span><br></pre></td></tr></table></figure><p>const a = new A(); 那么 a.<code>__proto__</code> = A.prototype(Object.prototype.<code>__proto__</code> = null special)</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1608035556/origin-of-ray/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20201215203215_aj5gbh.png" alt></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Parent</span>(); <span class="comment">// 因为</span></span><br><span class="line">p1.<span class="property">__proto__</span> = <span class="title class_">Parent</span>.<span class="property"><span class="keyword">prototype</span></span>; <span class="comment">// 所以</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Parent</span> = <span class="keyword">new</span> <span class="title class_">Function</span>();</span><br><span class="line"><span class="title class_">Parent</span>.<span class="property">__proto__</span> = <span class="title class_">Fuction</span>.<span class="property"><span class="keyword">prototype</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Function</span> = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line"><span class="title class_">Function</span>.<span class="property">__proto__</span> = <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line"></span><br><span class="line"><span class="title class_">All</span> prototypes are ordinary objects, that is, they come <span class="keyword">from</span> <span class="keyword">new</span> <span class="title class_">Object</span> ()</span><br><span class="line"><span class="title class_">Parent</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> = <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>;</span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> = <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Because</span> <span class="title class_">Object</span>, <span class="title class_">Function</span> can be placed after <span class="keyword">new</span>, it is also a constructor <span class="keyword">function</span>, that is, <span class="title class_">Object</span> = <span class="keyword">new</span> <span class="title class_">Function</span> ()</span><br><span class="line"><span class="title class_">Object</span>.<span class="property">__proto__</span> = <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line"><span class="title class_">Function</span>.<span class="property">__proto__</span> = <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span></span><br></pre></td></tr></table></figure><h4 id="thinking-what-code-security-issues-will-the-prototype-chain-bring"><a class="markdownIt-Anchor" href="#thinking-what-code-security-issues-will-the-prototype-chain-bring"></a> Thinking: What code security issues will the prototype chain bring?</h4><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://juejin.cn/post/6963950629240733727">前端原型链污染漏洞竟可以拿下服务器shell?</a></p><h3 id="where-do-variables-exist-heap-stack"><a class="markdownIt-Anchor" href="#where-do-variables-exist-heap-stack"></a> Where do variables exist? heap? stack?</h3><p>Ordinary types exist in the call stack, objects, functions exist in the heap???</p><blockquote><p>If normal types exist on the stack, how can closures be implemented?</p></blockquote><h3 id="this"><a class="markdownIt-Anchor" href="#this"></a> This</h3><p>This is a pointer that stores the address of the variable, just like a normal object variable stores the address of the object in the heap</p><p><a href="https://sunra.top/posts/5f6c244e/">Javascript执行机制（四）this指向的是什么？</a></p><h3 id="garbage-collection-mechanism"><a class="markdownIt-Anchor" href="#garbage-collection-mechanism"></a> Garbage collection mechanism</h3><p>The first step is to determine whether the objects in the heap are active objects through the “reachability” algorithm currently used by V8 for active and inactive objects in the GC Root markup space.</p><p>The second step is to reclaim the memory occupied by the inactive object. In fact, after all the markers are completed, all the objects marked as recyclable in the memory are cleaned up uniformly.</p><p>The third step is to do memory defragmentation. Generally speaking, after frequent collection of objects, there will be a large amount of discontinuous space in memory. We call these discontinuous Memory Spaces memory fragments. When a large number of memory fragments appear in the memory, if a large contiguous memory needs to be allocated, there may be insufficient memory, so the last step is to defragment these memory fragments. But this step is actually optional, because some garbage collectors do not generate memory fragments, such as the secondary garbage collector we will introduce next.</p><p>V8 currently uses two garbage collectors, the main garbage collector - Major GC and the secondary garbage collector - Minor GC (Scavenger). The reason why V8 uses two garbage collectors is mainly influenced by The Generational Hypothesis.</p><ul><li>The first is that most objects are “live and die”, which means that most objects live in memory for a short time, such as variables declared inside a function, or variables in a block-level scope. When the function or Code Block ends, the variables defined in the scope will be destroyed. Therefore, once this type of object is allocated memory, it quickly becomes inaccessible;</li><li>The second is immortal objects that will live longer, such as global window, DOM, Web API, etc.</li></ul><p>Therefore, in V8, the heap will be divided into two areas: the new generation and the old generation. The objects stored in the new generation are objects with short survival time, and the objects stored in the old generation have long survival time.</p><p>The new generation usually only supports 1~ 8M capacity, while the old generation supports much larger capacity. For these two regions, V8 uses two different garbage collectors to implement garbage collection more efficiently.</p><p>Secondary garbage collector - Minor GC (Scavenger), mainly responsible for garbage collection of the new generation. Main garbage collector - Major GC, mainly responsible for garbage collection of the old generation.</p><p><a href="https://sunra.top/posts/29695/">Javascript执行机制（八）垃圾回收机制</a></p><h3 id="thinking-several-common-memory-problems"><a class="markdownIt-Anchor" href="#thinking-several-common-memory-problems"></a> Thinking: Several common memory problems</h3><p>Memory problems can be defined in the following three categories:</p><ul><li>Memory leak, which can cause the performance of the page to deteriorate.</li><li>Memory bloat, which can cause page performance to remain poor;<br> Frequent garbage collection, which can cause pages to be delayed or paused frequently.</li></ul><h4 id="memory-leak"><a class="markdownIt-Anchor" href="#memory-leak"></a> Memory leak</h4><p>Essentially, a memory leak can be defined as: when the process no longer needs some memory, the memory that is no longer needed is still not reclaimed by the process. In JavaScript, the main cause of memory leaks is that memory data that is no longer needed (useless) is still referenced by other objects.</p><ol><li>Mount data to window</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Create</span> a temporary temp_array</span><br><span class="line">    temp_array = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">200000</span>)</span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Use temp_array</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>When this code is executed, since the object in the function body is not declared with the keywords var, let, const, V8 will replace temp_array with this. temp_array.</p><p>In browsers, by default, this points to the window object, and the window object is resident in memory, so even if the foo function exits, the temp_array is still referenced by the window object, so temp_array will still be the same as the window object, will be resident in memory. Because temp_array is no longer used object, but is still referenced by the window object, which causes temp_array leakage.</p><ol><li>closure</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123;  </span><br><span class="line">    <span class="keyword">var</span> temp_object = <span class="keyword">new</span> <span class="title class_">Object</span>()</span><br><span class="line">    temp_object.<span class="property">x</span> = <span class="number">1</span></span><br><span class="line">    temp_object.<span class="property">y</span> = <span class="number">2</span></span><br><span class="line">    temp_object.<span class="property">array</span> = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">200000</span>)</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Use temp_object</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(temp_object.<span class="property">x</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>As you can see, foo function uses a local temporary variable temp_object, temp_object object has three properties, x, y, and a very memory-intensive array property. Finally, foo function returns an anonymous function that references temp_object. Then after calling foo function, because the returned anonymous function references temp_object in foo function, this will cause temp_object to be destroyed, even if it only references temp_object, it will cause the entire temp_object object to remain in memory.</p><p>To solve this problem, I need according to the actual situation, to determine the closure of the function returned in the end need to reference what data, do not need to reference the data will never reference, because the above example, the return function only needs temp_object value, so we can transform this code:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123;  </span><br><span class="line">    <span class="keyword">var</span> temp_object = <span class="keyword">new</span> <span class="title class_">Object</span>()</span><br><span class="line">    temp_object.<span class="property">x</span> = <span class="number">1</span></span><br><span class="line">    temp_object.<span class="property">y</span> = <span class="number">2</span></span><br><span class="line">    temp_object.<span class="property">array</span> = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">200000</span>)</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Use temp_object</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">let</span> closure = temp_object.<span class="property">x</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(closure);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>detached &quot;Node</li></ol><p>Due to memory leaks caused by JavaScript referencing DOM nodes, a DOM node will only be garbage collected if both the DOM tree and JavaScript code do not reference it. If a node has been removed from the DOM tree, but JavaScript still references it, we call this node “detached”.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> detachedTree;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">create</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> ul = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;ul&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> li = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        ul.<span class="title function_">appendChild</span>(li);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    detachedTree = ul;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">create</span>() </span><br></pre></td></tr></table></figure><h4 id="memory-inflation"><a class="markdownIt-Anchor" href="#memory-inflation"></a> Memory inflation</h4><p>There are some differences between memory expansion and memory leakage. Memory expansion is mainly manifested in the unscientific memory management of programmers. For example, only 50M memory is needed, but some programmers spend 500M memory.</p><p>Excessive use of additional memory may be due to insufficient utilization of the cache, or it may load some unnecessary resources. It is usually manifested as a rapid growth of memory for a certain period of time, and then reaches a stable peak to continue running.</p><h4 id="frequent-garbage-collection"><a class="markdownIt-Anchor" href="#frequent-garbage-collection"></a> Frequent garbage collection</h4><p>In addition to memory leaks and memory inflation, there is another type of memory problem, that is, frequent use of large temporary variables, resulting in the new generation space being filled quickly, which frequently triggers garbage collection. Frequent garbage collection operations will make you feel the page Stuttering. For example, the following code:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">strToArray</span>(<span class="params">str</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span></span><br><span class="line">  <span class="keyword">const</span> len = str.<span class="property">length</span></span><br><span class="line">  <span class="keyword">let</span> arr = <span class="keyword">new</span> <span class="title class_">Uint16Array</span>(str.<span class="property">length</span>)</span><br><span class="line">  <span class="keyword">for</span> (; i &lt; len; ++i) &#123;</span><br><span class="line">    arr[i] = str.<span class="title function_">charCodeAt</span>(i)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span></span><br><span class="line">  <span class="keyword">let</span> str = <span class="string">&#x27;test V8 GC&#x27;</span></span><br><span class="line">  <span class="keyword">while</span> (i++ &lt; <span class="number">1e5</span>) &#123;</span><br><span class="line">    <span class="title function_">strToArray</span>(str);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>()</span><br></pre></td></tr></table></figure><p>This code will frequently create temporary variables, which will soon cause the new generation of memory to fill up, which will frequently trigger garbage collection. To solve the problem of frequent garbage collection, you can consider setting these temporary variables to variables in the upper scope.</p><h2 id="function"><a class="markdownIt-Anchor" href="#function"></a> Function</h2><h3 id="why-functions-are-first-class-citizens-in-javascript"><a class="markdownIt-Anchor" href="#why-functions-are-first-class-citizens-in-javascript"></a> Why functions are first class citizens in JavaScript.</h3><p>If a function in a programming language can do the same thing as a data type in that language, we call the function in that language a first-class citizen.</p><ul><li>function as an object, it has its own properties and values, so function is associated with the underlying properties and values;</li><li>The reason why function is a special object is that function can be “called”, so when a function is called, it also needs to be associated with the relevant execution context.</li></ul><p>Based on the design of function as a first-class citizen, JavaScript is very easy to implement some features, such as closures, and functional programming, which are more difficult to implement in other languages.</p><h3 id="delayed-resolution-and-closure"><a class="markdownIt-Anchor" href="#delayed-resolution-and-closure"></a> Delayed resolution and closure</h3><h4 id="delay-resolution"><a class="markdownIt-Anchor" href="#delay-resolution"></a> Delay resolution</h4><p>During the process of compiling JavaScript code, V8 does not parse all JavaScript into intermediate code at once. This is mainly based on the following two points:</p><ul><li>first of all, if all the JavaScript code is parsed and compiled at once, too much code will increase the compile time, which will seriously affect the speed of executing the JavaScript code for the first time and make users feel stuck. Because sometimes the JavaScript code of a page has more than 10 Megabytes, if all the code is parsed and compiled at one time, it will greatly increase the waiting time of users;</li><li>Secondly, the parsed bytecode and compiled machine code will be stored in memory. If all JavaScript codes are parsed and compiled at once, these intermediate codes and machine codes will always occupy memory, especially in the popularity of mobile phones. In the era, memory is a very valuable resource. Based on the above reasons, all mainstream JavaScript virtual machines have implemented lazy parsing. The so-called lazy parsing means that during the parsing process, if the parser encounters a function declaration, it will skip the code inside the function, and will not generate AST and bytecode for it, but only generate AST and bytecode of the top-level code</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">a,b</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> d = <span class="number">100</span></span><br><span class="line">    <span class="keyword">var</span> f = <span class="number">10</span></span><br><span class="line">    <span class="keyword">return</span> d + f + a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> c = <span class="number">4</span></span><br><span class="line"><span class="title function_">foo</span>(<span class="number">1</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure><p>When this piece of code to V8 processing, V8 will parse this code from top to bottom, in the parsing process will first encounter foo function, since this is just a function declaration statement, V8 at this stage only need to convert the function into a function object, as shown in the following figure: Note that here is only the function declaration into a function object, but did not parse and compile the internal code of function, so it will not generate a Syntax Tree for the internal code of foo function.</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334292/origin-of-ray/4380eae2-e84e-412d-a72f-7a95180fb897_wxblbk.png" alt></p><p>After the code parsing is completed, V8 will execute the executable code from top to bottom in order. First, it will execute the two assignment expressions “a = 1” and “c = 4”, and then execute the call of foo function. The process is to extract the function code from the foo function object. Then, like compiling the top-level code, V8 will compile the code of foo function first. When compiling, it also needs to be compiled into Syntax Tree and bytecode, and then interpreted and executed.</p><h4 id="basis-of-closure-functioning-as-first-class-citizens"><a class="markdownIt-Anchor" href="#basis-of-closure-functioning-as-first-class-citizens"></a> Basis of closure: functioning as first-class citizens</h4><p>JavaScript language allows defining new functions inside functions.</p><p>Variables defined in parent function can be accessed in inner function</p><p>Because function is a first-class citizen, function can be used as a return value</p><h4 id="thinking-how-to-achieve-closure-under-delayed-analysis"><a class="markdownIt-Anchor" href="#thinking-how-to-achieve-closure-under-delayed-analysis"></a> Thinking: How to achieve closure under delayed analysis</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> d = <span class="number">20</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">inner</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> c = a + b + d</span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> f = <span class="title function_">foo</span>()</span><br></pre></td></tr></table></figure><p>We can analyze the execution process of the above code:</p><p>When foo function is called, foo function returns its inner function to the global variable f.</p><ul><li>Then the execution of the foo function ends and the execution context is destroyed by V8;<br> Although the execution context of the foo function is destroyed, the inner function that is still alive references the variable d in the scope of the foo function.</li></ul><p>Therefore, if the variable of closure is stored in the call stack, it will be destroyed when the function call ends</p><p>To solve this problem, we need the preparser + to copy variables from the stack to the heap</p><h2 id="event"><a class="markdownIt-Anchor" href="#event"></a> Event</h2><h3 id="prior-knowledge"><a class="markdownIt-Anchor" href="#prior-knowledge"></a> Prior knowledge:</h3><h4 id="process-thread-coroutine"><a class="markdownIt-Anchor" href="#process-thread-coroutine"></a> Process, thread, coroutine</h4><p><a href="https://sunra.top/posts/954dea55/">Electron 多进程方案</a></p><h4 id="message-queue-macro-task"><a class="markdownIt-Anchor" href="#message-queue-macro-task"></a> Message queue (macro task)</h4><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629333909/origin-of-ray/4b286cfd-0164-4d55-b9bb-29568b622b81_wqnhy4.png" alt></p><h4 id="micro-tasks-solved-the-problem-of-uncontrollable-macro-task-execution-timing"><a class="markdownIt-Anchor" href="#micro-tasks-solved-the-problem-of-uncontrollable-macro-task-execution-timing"></a> Micro-tasks (solved the problem of uncontrollable macro task execution timing)</h4><p>Macro tasks need to be placed in the message queue first. If the execution time of some macro tasks is too long, it will affect the execution of the macro tasks behind the message queue, and this impact is uncontrollable because you cannot know the previous How long does the macro task take to execute? So JavaScript introduced microtasks, which will be executed when the current task is about to be executed. Using microtasks, you can control the execution timing of your callback function more accurately.</p><p>V8 maintains a microtask queue for each macro task. When V8 executes a piece of JavaScript, an environment object is created for this piece of code, and the microtask queue is stored in the environment object. When you generate a microtask through Promise.resolve, the microtask will be automatically added to the microtask queue by V8. When the entire code is about to be executed, the environment object will also be destroyed. However, before destruction, V8 will first process the microtasks in the microtask queue.</p><ul><li>First of all, if a microtask is generated in the current task, it will be triggered by Promise.resolve () or Promise.reject (), and the triggered microtask will not be executed in the current function, so when executing the microtask, it will not lead to infinite expansion of the stack;<br> Secondly, unlike asynchronous calls, microtasks will still be executed before the current task execution ends, which means that other tasks in the message queue cannot be executed before the current microtask execution ends.</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;bar&#x27;</span>)</span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(</span><br><span class="line">    <span class="function">(<span class="params">str</span>) =&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;micro-bar&#x27;</span>)</span><br><span class="line">  ) </span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">(<span class="params">str</span>) =&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;macro-bar&#x27;</span>),<span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(</span><br><span class="line">    <span class="function">(<span class="params">str</span>) =&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;micro-foo&#x27;</span>)</span><br><span class="line">  ) </span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">(<span class="params">str</span>) =&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;macro-foo&#x27;</span>),<span class="number">0</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">bar</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">foo</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;global&#x27;</span>)</span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(</span><br><span class="line">  <span class="function">(<span class="params">str</span>) =&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;micro-global&#x27;</span>)</span><br><span class="line">) </span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">(<span class="params">str</span>) =&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;macro-global&#x27;</span>),<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334393/origin-of-ray/1_gkzipy.png" alt></p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334394/origin-of-ray/5c4d6601-2746-4ebe-92a8-69f4721bb956_rt0a1c.png" alt></p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334395/origin-of-ray/7d99c846-3ad9-435a-8947-3218c8587e77_cx6wnz.png" alt></p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334396/origin-of-ray/657aecbf-c219-42f2-a2d3-89bc3a2a299b_vgprhc.png" alt></p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334394/origin-of-ray/6d0c4f0a-6126-419b-a0af-0d0a1c56a408_mkfmzt.png" alt></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">foo</span><br><span class="line">bar</span><br><span class="line">global</span><br><span class="line">micro-foo</span><br><span class="line">micro-bar</span><br><span class="line">micro-global</span><br><span class="line">macro-foo</span><br><span class="line">macro-bar</span><br><span class="line">macro-global</span><br></pre></td></tr></table></figure><h3 id="advance-of-asynchronous-syntax"><a class="markdownIt-Anchor" href="#advance-of-asynchronous-syntax"></a> Advance of asynchronous syntax</h3><p><a href="https://sunra.top/posts/2552a57d/">JavaScript 异步编程语法</a></p><h3 id="think-many-apis-in-node-provide-synchronous-and-asynchronous-functions-what-is-the-difference"><a class="markdownIt-Anchor" href="#think-many-apis-in-node-provide-synchronous-and-asynchronous-functions-what-is-the-difference"></a> Think: Many APIs in Node provide synchronous and asynchronous functions. What is the difference?</h3><p>Take readFile as an example</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> data = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;test.js&#x27;</span>)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fileHanlder</span>(<span class="params">err, data</span>)&#123;</span><br><span class="line">  data.<span class="title function_">toString</span>()  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;test.txt&#x27;</span>, fileHanlder)</span><br></pre></td></tr></table></figure><h4 id="read-files-asynchronously"><a class="markdownIt-Anchor" href="#read-files-asynchronously"></a> Read files asynchronously</h4><p>For example, when executing readFile on the main thread of Node, the main thread will submit the file name and callback function of readFile to the file reading and writing thread for processing. The specific process is as follows:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1629334521/origin-of-ray/1f181f36-9544-4b9b-850c-70630a8a8f17_st0vsg.png" alt></p><p>After the file reading and writing thread completes the file reading, it will encapsulate the result and callback function as new events and add them to the message queue. For example, the file thread stores the read file content in memory and points the data pointer to the memory, and then the file reading and writing thread will encapsulate the data and callback function as new events and throw them into the message queue</p><h4 id="synchronous-read-file"><a class="markdownIt-Anchor" href="#synchronous-read-file"></a> Synchronous read file</h4><p>However, there are always some people who think that asynchronous read and write file operations are too complicated. If the read file is not large or the bottleneck of the project is not in the file reading and writing, then the mode of still using asynchronous calls and callback functions is a bit overly complicated. Therefore, Node also provides a set of synchronous read and write APIs. The readFileSync in the first code is implemented synchronously. The synchronization code is very simple. When libuv reads the readFileSync task, it performs the read and write operations directly on the main thread, waits for the end of the read and write, and returns the result of the read and write directly. This is also an application of synchronous callbacks. Of course, during the reading and writing process, other tasks in the message queue cannot be executed.</p><h2 id="summary"><a class="markdownIt-Anchor" href="#summary"></a> Summary</h2><h3 id="implementation-process"><a class="markdownIt-Anchor" href="#implementation-process"></a> Implementation process</h3><ul><li>Before executing a piece of code, V8 will first initialize the running environment, such as initializing the stack space, message queue, etc.</li><li>first compile the entire code to generate AST, after generating AST:</li><li>Promote the variable declared by var and place it in the variable environment of the global context.</li><li>For let, const declared variables are added to the lexical environment of the global context</li><li>If the variable is an ordinary variable, it is stored directly in the call stack. If it is an object or function, it is stored on the heap and a pointer is stored in the context of the heap. If it is a function, it is not directly generated in the context, but simply pre-parsed. If there is a closure situation, then copy the variable to the heap.</li><li>Throw the entire function into the message queue as a macro task, start the executable code, if you encounter a function, parse the function, generate the context on the stack, and continue to perform the above three steps, but replace the global context with the function context.</li><li>If a macro task callback is encountered during function execution, put it at the end of the message queue. If a microtask callback is encountered, put it in the microtask queue of the global context.</li><li>The global up and down is executed before exiting, and the function in the microtask will be continuously removed.</li><li>After the microtask is executed, the global context is destroyed and the next macro task execution is removed from the message queue.</li></ul><h3 id="coding-attention"><a class="markdownIt-Anchor" href="#coding-attention"></a> Coding attention</h3><ul><li>Do not easily change the structure of the object</li><li>Pay attention to memory issues</li></ul></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/2021/08/15/javascript-conclusion/" title="JavaScript Execution Mechanism (9) Phase Summary">https://sunra.top/en/2021/08/15/javascript-conclusion/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/2021/08/04/javascript-gc/" rel="prev" title="JavaScript Execution Mechanism (8) Garbage Collection Mechanism"><i class="fa fa-chevron-left"></i> JavaScript Execution Mechanism (8) Garbage Collection Mechanism</a></div><div class="post-nav-item"> <a href="/en/2021/08/22/sql-injection-advanced/" rel="next" title="SQL injection study notes">SQL injection study notes<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" integrity="sha256-hLTCMFlKxdNgPXyWlSSxYN0ykJmxxq9Yt3MNfdRGWeA=" crossorigin="anonymous"><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/2021/08/15/javascript-conclusion/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>