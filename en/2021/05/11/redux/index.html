<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="google-site-verification" content="7yRqtT6cCpC-_R-rzM9gUoQGmheV9OZAUKIXrbAsyqE"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/en/","images":"/en/images","scheme":"Muse","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="Recently started to read some knowledge about react, and inevitably came into contact with redux. I took a look at his doc to briefly summarize. Note that most of the original content is outdated, bec"><meta property="og:type" content="article"><meta property="og:title" content="Redux Introduction Notes"><meta property="og:url" content="https://sunra.top/en/2021/05/11/redux/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="Recently started to read some knowledge about react, and inevitably came into contact with redux. I took a look at his doc to briefly summarize. Note that most of the original content is outdated, bec"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2021-05-11T00:30:04.000Z"><meta property="article:modified_time" content="2024-02-07T08:26:25.604Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="Technology Sharing Using Tutorials Principles Front End Computer Graphics"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://sunra.top/en/2021/05/11/redux/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sunra.top/en/2021/05/11/redux/","path":"2021/05/11/redux/","title":"Redux Introduction Notes"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Redux Introduction Notes | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/en/js/third-party/analytics/google-analytics.js"></script><script src="/en/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Lift the fog of the Internet together</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#What-is-Redux"><span class="nav-number">1.</span> <span class="nav-text">What is Redux?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redux-in-brief"><span class="nav-number">2.</span> <span class="nav-text">Redux in brief</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Core-concepts"><span class="nav-number">3.</span> <span class="nav-text">Core concepts</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Three-principles"><span class="nav-number">4.</span> <span class="nav-text">Three principles</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Basic"><span class="nav-number">5.</span> <span class="nav-text">Basic</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Action"><span class="nav-number">5.1.</span> <span class="nav-text">Action</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Action-1"><span class="nav-number">5.1.1.</span> <span class="nav-text">Action</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reducer"><span class="nav-number">5.2.</span> <span class="nav-text">Reducer</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Action-2"><span class="nav-number">5.2.1.</span> <span class="nav-text">Action</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Split-and-Synthesis-of-Reducer"><span class="nav-number">5.2.2.</span> <span class="nav-text">Split and Synthesis of Reducer</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Store"><span class="nav-number">5.3.</span> <span class="nav-text">Store</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#A-few-questions"><span class="nav-number">6.</span> <span class="nav-text">A few questions</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#With-React"><span class="nav-number">6.1.</span> <span class="nav-text">With React</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Container-components-Smart-Container"><span class="nav-number">6.1.1.</span> <span class="nav-text">Container components (Smart&#x2F;Container</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Why-all-components-can-access-the-state-of-redux"><span class="nav-number">6.2.</span> <span class="nav-text">Why all components can access the state of redux</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#index-js"><span class="nav-number">6.2.1.</span> <span class="nav-text">index.js</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Middleware-creates-asynchronous-actions-reducers-with-side-effects"><span class="nav-number">6.3.</span> <span class="nav-text">Middleware creates asynchronous actions, reducers with side effects</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#actions-js"><span class="nav-number">6.3.1.</span> <span class="nav-text">actions.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#index-js-1"><span class="nav-number">6.3.2.</span> <span class="nav-text">index.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#actions-js-1"><span class="nav-number">6.3.3.</span> <span class="nav-text">actions.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#index-js-2"><span class="nav-number">6.3.4.</span> <span class="nav-text">index.js</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">Lift the fog of the Internet together</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/en/archives/"><span class="site-state-item-count">268</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/en/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">categories</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%;margin-bottom:5px"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <span>一站式程序员工具平台</span> <img src="https://origin-of-ray.oss-cn-shenzhen.aliyuncs.com/rannie_share.png"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sunra.top/en/2021/05/11/redux/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="Lift the fog of the Internet together"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Redux Introduction Notes | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Redux Introduction Notes</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2021-05-11 08:30:04" itemprop="dateCreated datePublished" datetime="2021-05-11T08:30:04+08:00">2021-05-11</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2024-02-07 16:26:25" itemprop="dateModified" datetime="2024-02-07T16:26:25+08:00">2024-02-07</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline:</span><a title="waline" href="/en/2021/05/11/redux/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/en/2021/05/11/redux/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>Recently started to read some knowledge about react, and inevitably came into contact with redux.</p><p>I took a look at his doc to briefly summarize.</p><p>Note that most of the original content is outdated, because react updated the hook. I will go back and study what improvements react-redux has made to the hook, and then reexplain it. However, most of the content of this blog is about native redux, which can also be safely eaten.</p><span id="more"></span><h2 id="What-is-Redux"><a href="#What-is-Redux" class="headerlink" title="What is Redux?"></a>What is Redux?</h2><p>Redux is a JavaScript state container that provides predictable state management. (If you need a WordPress framework, check out <a target="_blank" rel="external nofollow noopener noreferrer" href="https://reduxframework.com/">Redux Framework</a>。)</p><p>It allows you to build consistent applications that run in different environments (client, server, native applications) and are easy to test. Not only that, it also provides a super cool development experience, such as having a<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/gaearon/redux-devtools">时间旅行调试器可以编辑后实时预览</a>。</p><p> <strong>Redux except and <a target="_blank" rel="external nofollow noopener noreferrer" href="https://facebook.github.io/react/">React</a> In addition to using it together, it also supports other interface libraries</strong> . It is small and powerful (only 2kB, including dependencies).</p><h2 id="Redux-in-brief"><a href="#Redux-in-brief" class="headerlink" title="Redux in brief"></a>Redux in brief</h2><p>All states in the application are stored in a single <em>store</em> in the form of an object tree. The only way to change the state is to trigger <em>action</em> , an object that describes what happened. To describe how actions change the state tree, you need to write <em>reducers</em> .</p><p>That’s it!</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> This is a pure function of the form (state, action) = &gt; state.</span></span><br><span class="line"><span class="comment"> Describes how an action transforms a state into the next state.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> The form of state depends on you, it can be primitive type, array, object,</span></span><br><span class="line"><span class="comment"> * Even data structures generated by Immutable.js. The only point is</span></span><br><span class="line"><span class="comment"> * When the state changes, it is necessary to return a brand new object instead of modifying the passed parameters.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> The following example uses the&#x27;switch &#x27;statement and string to make judgments, but you can write helper classes</span></span><br><span class="line"><span class="comment"> * Judging by different conventions (such as method mapping), as long as they apply to your project.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">counter</span>(<span class="params">state = <span class="number">0</span>, action</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;INCREMENT&#x27;</span>:</span><br><span class="line">    <span class="keyword">return</span> state + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;DECREMENT&#x27;</span>:</span><br><span class="line">    <span class="keyword">return</span> state - <span class="number">1</span>;</span><br><span class="line">  <span class="attr">default</span>:</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Create</span> a <span class="title class_">Redux</span> store to store the state <span class="keyword">of</span> the application.</span><br><span class="line"><span class="comment">// API 是 &#123; subscribe, dispatch, getState &#125;。</span></span><br><span class="line"><span class="keyword">let</span> store = <span class="title function_">createStore</span>(counter);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Updates</span> can be subscribed manually or events can be bound to the view layer.</span><br><span class="line">store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(store.<span class="title function_">getState</span>())</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title class_">The</span> only way to change the internal state is to dispatch an action.</span><br><span class="line"><span class="comment">//actions can be serialized, journaled and stored, and later executed in playback</span></span><br><span class="line">store.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;INCREMENT&#x27;</span> &#125;);</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line">store.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;INCREMENT&#x27;</span> &#125;);</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line">store.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;DECREMENT&#x27;</span> &#125;);</span><br><span class="line"><span class="comment">// 1</span></span><br></pre></td></tr></table></figure><p>Instead of modifying the state directly, you should make the modification into a normal object called <em>action</em> . Then write a special function to determine how each action changes the state of the application, this function is called <em>reducer</em> .</p><h2 id="Core-concepts"><a href="#Core-concepts" class="headerlink" title="Core concepts"></a>Core concepts</h2><p>Redux itself is simple.</p><p>When using normal objects to describe the state of an application. For example, the state of a todo application might look like this:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">todos</span>: [&#123;</span><br><span class="line">    <span class="attr">text</span>: <span class="string">&#x27;Eat food&#x27;</span>,</span><br><span class="line">    <span class="attr">completed</span>: <span class="literal">true</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="attr">text</span>: <span class="string">&#x27;Exercise&#x27;</span>,</span><br><span class="line">    <span class="attr">completed</span>: <span class="literal">false</span></span><br><span class="line">  &#125;],</span><br><span class="line">  <span class="attr">visibilityFilter</span>: <span class="string">&#x27;SHOW_COMPLETED&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>This object is like “Model”, except that it has no setter (modifier method). Therefore, other code cannot modify it at will, resulting in a bug that is difficult to reproduce.</p><p>To update the data in state, you need to initiate an action. An Action is a normal JavaScript object (notice, there is no magic here) used to describe what happened. Here are some examples of actions:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">type</span>: <span class="string">&#x27;ADD_TODO&#x27;</span>, <span class="attr">text</span>: <span class="string">&#x27;Go to swimming pool&#x27;</span> &#125;</span><br><span class="line">&#123; <span class="attr">type</span>: <span class="string">&#x27;TOGGLE_TODO&#x27;</span>, <span class="attr">index</span>: <span class="number">1</span> &#125;</span><br><span class="line">&#123; <span class="attr">type</span>: <span class="string">&#x27;SET_VISIBILITY_FILTER&#x27;</span>, <span class="attr">filter</span>: <span class="string">&#x27;SHOW_ALL&#x27;</span> &#125;</span><br></pre></td></tr></table></figure><p> <strong>The benefit of forcing action to describe all changes is that you can clearly know what happened in the application</strong> . If something changes, you can know why. Action is like an indicator describing what happened. Eventually, <strong>in order to string action and state together, develop some function, this is the reducer</strong> .</p><p>Again, without any magic, the reducer is just a function that takes state and action and returns the new state. For large applications, it is unlikely to just write one such function, so we write many small functions to manage parts of the state separately:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">visibilityFilter</span>(<span class="params">state = <span class="string">&#x27;SHOW_ALL&#x27;</span>, action</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (action.<span class="property">type</span> = <span class="string">&#x27;SET_VISIBILITY_FILTER&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> action.<span class="property">filter</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">todos</span>(<span class="params">state = [], action</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;ADD_TODO&#x27;</span>:</span><br><span class="line">    <span class="keyword">return</span> state.<span class="title function_">concat</span>([&#123; <span class="attr">text</span>: action.<span class="property">text</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;]);</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;TOGGLE_TODO&#x27;</span>:</span><br><span class="line">    <span class="keyword">return</span> state.<span class="title function_">map</span>(<span class="function">(<span class="params">todo, index</span>) =&gt;</span></span><br><span class="line">      action.<span class="property">index</span> = index ?</span><br><span class="line">        &#123; <span class="attr">text</span>: todo.<span class="property">text</span>, <span class="attr">completed</span>: !todo.<span class="property">completed</span> &#125; :</span><br><span class="line">        todo</span><br><span class="line">   )</span><br><span class="line">  <span class="attr">default</span>:</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Then develop a reducer that calls these two reducers to manage the state of the entire application.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">todoApp</span>(<span class="params">state = &#123;&#125;, action</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">all</span>: all (state.<span class="property">all</span>, action),</span><br><span class="line">    <span class="attr">visibilityFilter</span>: <span class="title function_">visibilityFilter</span>(state.<span class="property">visibilityFilter</span>, action)</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Three-principles"><a href="#Three-principles" class="headerlink" title="Three principles"></a>Three principles</h2><p>Single data source, i.e. only one state</p><ul><li>state is read-only, you cannot assign a value to state directly, the only way to modify state is to trigger action</li><li>Use pure function to perform modification. When an action is triggered, the reducer needs a pure function, that is, it cannot directly modify the state, but returns a new state object.</li></ul><h2 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h2><h3 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h3><p>First, let’s define action.</p><p> <strong>Action</strong> is the payload that transfers data from the application (Translator’s Note: The reason why it is not called a view here is that the data may be server responses, user input or other non-view data) to the store. It is the <em>* only</em> source of stored data. Generally you will pass <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/api/Store.html#dispatch"><code>store.dispatch()</code></a> Pass the action to the store.</p><p>The action to add a new todo task is like this:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">ADD_TODO</span> = <span class="string">&#x27;ADD_TODO&#x27;</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="variable constant_">ADD_TODO</span>,</span><br><span class="line">  <span class="attr">text</span>: <span class="string">&#x27;Build my first Redux app&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <strong>Actions are essentially ordinary JavaScript objects</strong> . We agree that a’type ‘field of type string must be used in the action to represent the action to be performed. In most cases,’ type ‘will be defined as a string constant. When the application scale is getting larger, it is recommended to use a separate module or file to store actions.</p><h4 id="Action-1"><a href="#Action-1" class="headerlink" title="Action"></a>Action</h4><p> <strong>Action creates function</strong> is the method of generating action. The concepts of “action” and “action creates function” are easy to mix together, and it is best to pay attention to the distinction when using them.</p><p>The action creation function in Redux simply returns an action:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addTodo</span>(<span class="params">text</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="variable constant_">ADD_TODO</span>,</span><br><span class="line">    text</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Doing so will make action creation functions easier to port and test.</p><p>In Redux, simply pass the result of the action creation function to the dispatch () method to initiate a dispatch process.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">dispatch</span>(<span class="title function_">addTodo</span>(text))</span><br><span class="line"><span class="title function_">dispatch</span>(<span class="title function_">completeTodo</span>(index))</span><br></pre></td></tr></table></figure><p>Or create a <strong>bound action creation function</strong> to automatically dispatch:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">boundAddTodo</span> = text =&gt; <span class="title function_">dispatch</span>(<span class="title function_">addTodo</span>(text))</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">boundCompleteTodo</span> = index =&gt; <span class="title function_">dispatch</span>(<span class="title function_">completeTodo</span>(index))</span><br></pre></td></tr></table></figure><p>Then call them directly:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">boundAddTodo</span>(text);</span><br><span class="line"><span class="title function_">boundCompleteTodo</span>(index);</span><br></pre></td></tr></table></figure><h3 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h3><p> <strong>Reducers</strong> Specifies how to respond to changes in the application state <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/basics/Actions.html">actions</a> Sent to the store, remember that actions only describe the fact that something happened, and do not describe how the application updates the state.</p><h4 id="Action-2"><a href="#Action-2" class="headerlink" title="Action"></a>Action</h4><p>Now that we have determined the structure of the state object, we can start developing the reducer. A reducer is a pure function that takes the old state and action and returns the new state.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(previousState, action) =&gt; newState</span><br></pre></td></tr></table></figure><p>The reason why such a function is called a reducer is because it is the same as the function being passed in <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce"><code>Array.prototype.reduce(reducer, ?initialValue)</code></a> The callback functions in are of the same type. It is very important to keep the reducer pure. <strong>Never</strong> do these operations in a reducer:</p><ul><li>Modify the incoming parameters;</li><li>Perform operations with side effects, such as API requests and route jumps;<br>Call a non-pure function, such as Date.now () or Math.random ().</li></ul><p>Remember that the reducer must be kept pure. <strong>As long as the passed parameters are the same, the next state returned from the calculation must be the same. No special cases, no side effects, no API requests, no variable modifications, just perform the calculation.</strong></p><h4 id="Split-and-Synthesis-of-Reducer"><a href="#Split-and-Synthesis-of-Reducer" class="headerlink" title="Split and Synthesis of Reducer"></a>Split and Synthesis of Reducer</h4><p>As the state becomes more and more complex, our reducer will inevitably become more and more complex, so we have to find a way to split the reducer and finally combine it like a way, because we can only have one state.</p><p>For the example we started with in the Core Concepts section, Redux provides <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/api/combineReducers.html"><code>combineReducers()</code></a> Utility class</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> todoApp = <span class="title function_">combineReducers</span>(&#123;</span><br><span class="line">  visibilityFilter,</span><br><span class="line">  todos</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> todoApp</span><br></pre></td></tr></table></figure><p>Note that the above writing is exactly equivalent to the following:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">todoApp</span>(<span class="params">state = &#123;&#125;, action</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">visibilityFilter</span>: <span class="title function_">visibilityFilter</span>(state.<span class="property">visibilityFilter</span>, action),</span><br><span class="line">    <span class="attr">all</span>: all (state.<span class="property">all</span>, action)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>You can also give them different keys or call different functions. The following two synthetic reducer methods are exactly equivalent:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reducer = <span class="title function_">combineReducers</span>(&#123;</span><br><span class="line">  <span class="attr">a</span>: doSomethingWithA,</span><br><span class="line">  <span class="attr">b</span>: processB,</span><br><span class="line">  <span class="attr">c</span>: c</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">state = &#123;&#125;, action</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="title function_">doSomethingWithA</span>(state.<span class="property">a</span>, action),</span><br><span class="line">    <span class="attr">b</span>: <span class="title function_">processB</span>(state.<span class="property">b</span>, action),</span><br><span class="line">    <span class="attr">c</span>: <span class="title function_">c</span>(state.<span class="property">c</span>, action)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/api/combineReducers.html"><code>combineReducers()</code></a> 所做的只是生成一个函数，这个函数来调用你的一系列 reducer，每个 reducer <strong>根据它们的 key 来筛选出 state 中的一部分数据并处理</strong>，然后这个生成的函数再将所有 reducer 的结果合并成一个大的对象。</p><h3 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h3><p> <strong>Store</strong> is the object that connects them together. The Store has the following responsibilities:</p><p>Maintain the state of the application;</p><ul><li>Provide <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/api/Store.html#getState"><code>getState()</code></a> Method to obtain state;</li><li>Provide <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/api/Store.html#dispatch"><code>dispatch(action)</code></a> Method update state;</li><li>Through <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/api/Store.html#subscribe"><code>subscribe(listener)</code></a> Registration of listeners;</li><li>Through <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/api/Store.html#subscribe"><code>subscribe(listener)</code></a> The returned function unregisters the listener.</li></ul><p>Again <strong>Redux application only has a single store</strong> . When you need to split data processing logic, you should use <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/basics/Reducers.html#splitting-reducers">reducer 组合</a> Instead of creating multiple stores.</p><p>It is very easy to create a store based on an existing reducer. In<a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/basics/Reducers.html">前一个章节</a>In, we use <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/api/combineReducers.html"><code>combineReducers()</code></a> Merge multiple reducers into one. Now we import it and pass <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/api/createStore.html"><code>createStore()</code></a>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> todoApp <span class="keyword">from</span> <span class="string">&#x27;./reducers&#x27;</span></span><br><span class="line"><span class="keyword">let</span> store = <span class="title function_">createStore</span>(todoApp)</span><br></pre></td></tr></table></figure><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/api/createStore.html"><code>createStore()</code></a> 的第二个参数是可选的, 用于设置 state 初始状态。这对开发同构应用时非常有用，服务器端 redux 应用的 state 结构可以与客户端保持一致, 那么客户端可以将从网络接收到的服务端 state 直接用于本地数据初始化。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> store = <span class="title function_">createStore</span>(todoApp, <span class="variable language_">window</span>.<span class="property">STATE_FROM_SERVER</span>)</span><br></pre></td></tr></table></figure><h2 id="A-few-questions"><a href="#A-few-questions" class="headerlink" title="A few questions"></a>A few questions</h2><p>So far, the basic concepts and usage of Redux have been explained, and we still have several problems</p><p>So far, it seems that React and Redux do not have any linkage, there is no relationship, at least there is no special care in usage.</p><ul><li>Redux looks like a state management, not global state management, so why can you do global state management in react?</li><li>How to implement an asynchronous Action, what if I just want to perform some side effects in the Reducer after triggering the Action?</li></ul><p>Let’s solve it one by one</p><h3 id="With-React"><a href="#With-React" class="headerlink" title="With React"></a>With React</h3><p>There is no connection between Redux and React. Redux supports React, Angular, Ember, jQuery and even pure JavaScript.</p><p>Redux does not include by default <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/reactjs/react-redux">React 绑定库</a>It needs to be installed separately.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save react-redux</span><br></pre></td></tr></table></figure><p>If you don’t use npm, you can also get the latest UMD package from unpkg (including<a target="_blank" rel="external nofollow noopener noreferrer" href="https://unpkg.com/react-redux@latest/dist/react-redux.js">开发环境包</a>And<a target="_blank" rel="external nofollow noopener noreferrer" href="https://unpkg.com/react-redux@latest/dist/react-redux.min.js">生产环境包</a>). If you import a UMD package with the &lt; script &gt; tag, it will throw a window. ReactRedux object globally.</p><h4 id="Container-components-Smart-Container"><a href="#Container-components-Smart-Container" class="headerlink" title="Container components (Smart/Container"></a>Container components (Smart/Container</h4><p>Redux’s React binding library is based on <a target="_blank" rel="external nofollow noopener noreferrer" href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0">容器组件和展示组件相分离</a> Development ideas. So it is recommended to read this article first and then come back to continue learning. This idea is very important.</p><blockquote><p>This article predates hooks and was the most popular development method in the class era, but when hooks appeared, the author acknowledges that hooks are a better practice, but if your version does not support hooks, this idea is still very important.</p></blockquote><p>So let’s summarize the differences again:</p><div class="table-container"><table><thead><tr><th style="text-align:right"></th><th style="text-align:left">Display Components</th><th style="text-align:left">Container Components</th></tr></thead><tbody><tr><td style="text-align:right">Function</td><td style="text-align:left">Describe how to display (skeleton, style)</td><td style="text-align:left">Describe how to run (data acquisition, status update)</td></tr><tr><td style="text-align:right">Direct use of Redux</td><td style="text-align:left">No</td><td style="text-align:left">Yes</td></tr><tr><td style="text-align:right">Data source</td><td style="text-align:left">props</td><td style="text-align:left">Listening to Redux state</td></tr><tr><td style="text-align:right">data modification</td><td style="text-align:left">call callback function from props</td><td style="text-align:left">dispatch actions to Redux</td></tr><tr><td style="text-align:right">Call method</td><td style="text-align:left">Manual</td><td style="text-align:left">Usually generated by React Redux</td></tr></tbody></table></div><p>Most components should be presentational, but generally a few container components are needed to connect them to the Redux store. This and the following design brief do not mean that container components must be at the top of the component tree. If a container component becomes too complex (for example, it has a lot of nested components and passes countless callback functions), then introduce another container in the component tree, like<a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/faq/ReactRedux.html#react-multiple-components">FAQ</a>As mentioned in</p><p>Technically, you can use’store.subscribe () ‘to write container components directly. But the reason why this is not recommended is that you cannot use the Performance optimization brought by React Redux. Therefore, instead of writing container components by hand, use the’connect () ‘ method of React Redux to generate **, which will be described in detail later.</p><h3 id="Why-all-components-can-access-the-state-of-redux"><a href="#Why-all-components-can-access-the-state-of-redux" class="headerlink" title="Why all components can access the state of redux"></a>Why all components can access the state of redux</h3><p>All container components have access to the Redux store, so you can listen to it manually. One way is to pass it as props to all container components. But this is too much trouble because you have to wrap the display component with’store ‘, just because a container component happens to be rendered in the component tree.</p><p>The recommended way is to use the specified React Redux component <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/reactjs/react-redux/blob/master/docs/api.md#provider-store">``</a> Come <a target="_blank" rel="external nofollow noopener noreferrer" href="https://facebook.github.io/react/docs/context.html">魔法般的</a> Make the store accessible to all container components without having to explicitly pass it. Just use it when rendering the root component.</p><h4 id="index-js"><a href="#index-js" class="headerlink" title="index.js"></a><code>index.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> todoApp <span class="keyword">from</span> <span class="string">&#x27;./reducers&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./components/App&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> store = <span class="title function_">createStore</span>(todoApp)</span><br><span class="line"></span><br><span class="line"><span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="Middleware-creates-asynchronous-actions-reducers-with-side-effects"><a href="#Middleware-creates-asynchronous-actions-reducers-with-side-effects" class="headerlink" title="Middleware creates asynchronous actions, reducers with side effects"></a>Middleware creates asynchronous actions, reducers with side effects</h3><p>Standard practice is to use <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/gaearon/redux-thunk">Redux Thunk 中间件</a>To use it, we need to introduce the specialized library of’redux-thunk ‘. We <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/advanced/Middleware.html">后面</a> It will introduce how middleware works in general; for now, you only need to know one important point: by using the specified middleware, the action creating function can return a function in addition to an action object. In this case, the action creating function becomes <a target="_blank" rel="external nofollow noopener noreferrer" href="https://en.wikipedia.org/wiki/Thunk">thunk</a>。</p><p>When an action creates a function and returns a function, the function is executed by Redux Thunk middleware. This function does not need to be pure; it can also have side effects, including executing asynchronous API requests. This function can also dispatch actions, just like dispatch the synchronous action defined earlier.</p><p>We can still define these special thunk action creation functions in actions.js.</p><h4 id="actions-js"><a href="#actions-js" class="headerlink" title="actions.js"></a><code>actions.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> fetch <span class="keyword">from</span> <span class="string">&#x27;cross-fetch&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">REQUEST_POSTS</span> = <span class="string">&#x27;REQUEST_POSTS&#x27;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">requestPosts</span>(<span class="params">subreddit</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="variable constant_">REQUEST_POSTS</span>,</span><br><span class="line">    subreddit</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">RECEIVE_POSTS</span> = <span class="string">&#x27;RECEIVE_POSTS&#x27;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">receivePosts</span>(<span class="params">subreddit, json</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="variable constant_">RECEIVE_POSTS</span>,</span><br><span class="line">    subreddit,</span><br><span class="line">    <span class="attr">posts</span>: json.<span class="property">data</span>.<span class="property">children</span>.<span class="title function_">map</span>(<span class="function"><span class="params">child</span> =&gt;</span> child.<span class="property">data</span>),</span><br><span class="line">    <span class="attr">receivedAt</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">INVALIDATE_SUBREDDIT</span> = ‘<span class="variable constant_">INVALIDATE_SUBREDDIT</span>’</span><br><span class="line"> <span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">invalidateSubreddit</span>(<span class="params">subreddit</span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> &#123;</span><br><span class="line">     <span class="attr">type</span>: <span class="variable constant_">INVALIDATE_SUBREDDIT</span>,</span><br><span class="line">     subreddit</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Take</span> a look at the first thunk action creation <span class="keyword">function</span> we wrote!</span><br><span class="line"><span class="comment">//Although the inner operation is different, you can use it like any other action creates a function:</span></span><br><span class="line"><span class="comment">// store.dispatch(fetchPosts(&#x27;reactjs&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">fetchPosts</span>(<span class="params">subreddit</span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="title class_">Thunk</span> middleware knows how to handle functions.</span><br><span class="line">  <span class="comment">//here the dispatch method is passed to the function as parameters,</span></span><br><span class="line">  <span class="title class_">This</span> allows it to dispatch actions itself.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">dispatch</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//First dispatch: update the application state to notify</span></span><br><span class="line">    <span class="title class_">The</span> <span class="variable constant_">API</span> request has been initiated.</span><br><span class="line"></span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">requestPosts</span>(subreddit))</span><br><span class="line"></span><br><span class="line">    <span class="title class_">The</span> <span class="keyword">function</span> called by thunk middleware can have a <span class="keyword">return</span> value.</span><br><span class="line">    <span class="title class_">It</span> will be passed <span class="keyword">as</span> the <span class="keyword">return</span> value <span class="keyword">of</span> the dispatch method.</span><br><span class="line"></span><br><span class="line">    <span class="title class_">In</span> <span class="variable language_">this</span> <span class="keyword">case</span>, we <span class="keyword">return</span> a promise waiting to be processed.</span><br><span class="line">    <span class="comment">//This is not necessary for redux middleware, but it is convenient for us.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">`http://www.subreddit.com/r/<span class="subst">$&#123;subreddit&#125;</span>.json`</span>)</span><br><span class="line">      .<span class="title function_">then</span>(</span><br><span class="line">        <span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>(),</span><br><span class="line">        <span class="title class_">Do</span> not use <span class="keyword">catch</span> because it will <span class="keyword">catch</span></span><br><span class="line">        <span class="comment">//any errors in dispatch and rendering,</span></span><br><span class="line">        <span class="comment">//Causes an&#x27;Unexpected batch number &#x27;error.</span></span><br><span class="line">        <span class="comment">// https://github.com/facebook/react/issues/6895</span></span><br><span class="line">         error =&gt; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;An error occurred.&#x27;</span>, error)</span><br><span class="line">      )</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">json</span> =&gt;</span></span><br><span class="line">        <span class="comment">//Can be dispatched multiple times!</span></span><br><span class="line">        <span class="comment">//Here, use the API request result to update the state of the application.</span></span><br><span class="line"></span><br><span class="line">        <span class="title function_">dispatch</span>(<span class="title function_">receivePosts</span>(subreddit, json))</span><br><span class="line">      )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>How did we introduce Redux Thunk middleware into the dispatch mechanism? We used <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.redux.org.cn/docs/api/applyMiddleware.html"><code>applyMiddleware()</code></a>, as follows:</p><h4 id="index-js-1"><a href="#index-js-1" class="headerlink" title="index.js"></a><code>index.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> thunkMiddleware <span class="keyword">from</span> <span class="string">&#x27;redux-thunk&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createLogger &#125; <span class="keyword">from</span> <span class="string">&#x27;redux-logger&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; selectSubreddit, fetchPosts &#125; <span class="keyword">from</span> <span class="string">&#x27;./actions&#x27;</span></span><br><span class="line"><span class="keyword">import</span> rootReducer <span class="keyword">from</span> <span class="string">&#x27;./reducers&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> loggerMiddleware = <span class="title function_">createLogger</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(</span><br><span class="line">  rootReducer,</span><br><span class="line">  <span class="title function_">applyMiddleware</span>(</span><br><span class="line">    <span class="title class_">ThunkMiddleware</span>,<span class="comment">//allows us to dispatch () function</span></span><br><span class="line">    <span class="title class_">LoggerMiddleware</span><span class="comment">//A very convenient middleware for printing action logs</span></span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">dispatch</span>(<span class="title function_">selectSubreddit</span>(<span class="string">&#x27;reactjs&#x27;</span>))</span><br><span class="line">store</span><br><span class="line">  .<span class="title function_">dispatch</span>(<span class="title function_">fetchPosts</span>(<span class="string">&#x27;reactjs&#x27;</span>))</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(store.<span class="title function_">getState</span>())</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>One advantage of thunk is that its results can be dispatched again:</p><h4 id="actions-js-1"><a href="#actions-js-1" class="headerlink" title="actions.js"></a><code>actions.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> fetch <span class="keyword">from</span> <span class="string">&#x27;cross-fetch&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">REQUEST_POSTS</span> = <span class="string">&#x27;REQUEST_POSTS&#x27;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">requestPosts</span>(<span class="params">subreddit</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="variable constant_">REQUEST_POSTS</span>,</span><br><span class="line">    subreddit</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">RECEIVE_POSTS</span> = <span class="string">&#x27;RECEIVE_POSTS&#x27;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">receivePosts</span>(<span class="params">subreddit, json</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="variable constant_">RECEIVE_POSTS</span>,</span><br><span class="line">    subreddit,</span><br><span class="line">    <span class="attr">posts</span>: json.<span class="property">data</span>.<span class="property">children</span>.<span class="title function_">map</span>(<span class="function"><span class="params">child</span> =&gt;</span> child.<span class="property">data</span>),</span><br><span class="line">    <span class="attr">receivedAt</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">INVALIDATE_SUBREDDIT</span> = <span class="string">&#x27;INVALIDATE_SUBREDDIT&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">invalidateSubreddit</span>(<span class="params">subreddit</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="variable constant_">INVALIDATE_SUBREDDIT</span>,</span><br><span class="line">    subreddit</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fetchPosts</span>(<span class="params">subreddit</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">dispatch</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">requestPosts</span>(subreddit))</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">`http://www.reddit.com/r/<span class="subst">$&#123;subreddit&#125;</span>.json`</span>)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">json</span> =&gt;</span> <span class="title function_">dispatch</span>(<span class="title function_">receivePosts</span>(subreddit, json)))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">shouldFetchPosts</span>(<span class="params">state, subreddit</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> posts = state.<span class="property">postsBySubreddit</span>[subreddit]</span><br><span class="line">  <span class="keyword">if</span> (!posts) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (posts.<span class="property">isFetching</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> posts.<span class="property">didInvalidate</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">fetchPostsIfNeeded</span>(<span class="params">subreddit</span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Note that this function also receives the getState () method</span></span><br><span class="line">  <span class="title class_">It</span> lets you choose what to dispatch next.</span><br><span class="line"></span><br><span class="line">  <span class="comment">//When the cached value is available,</span></span><br><span class="line">  <span class="title class_">Reducing</span> network requests is very useful.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">dispatch, getState</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">shouldFetchPosts</span>(<span class="title function_">getState</span>(), subreddit)) &#123;</span><br><span class="line">      <span class="comment">//dispatch another thunk in the thunk!</span></span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">dispatch</span>(<span class="title function_">fetchPosts</span>(subreddit))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title class_">Tell</span> the calling code not to wait any longer.</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>This allows us to gradually develop complex asynchronous control flows while keeping the code as clean as ever.</p><h4 id="index-js-2"><a href="#index-js-2" class="headerlink" title="index.js"></a><code>index.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">store</span><br><span class="line">  .<span class="title function_">dispatch</span>(<span class="title function_">fetchPostsIfNeeded</span>(<span class="string">&#x27;reactjs&#x27;</span>))</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(store.<span class="title function_">getState</span>())</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>Post author:</strong> Ray Sun</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://sunra.top/en/2021/05/11/redux/" title="Redux Introduction Notes">https://sunra.top/en/2021/05/11/redux/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="followme"> <span>Welcome to my other publishing channels</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/en/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/en/2021/05/06/ssrf/" rel="prev" title="Principle and Defense Scheme of SSRF Vulnerability"><i class="fa fa-chevron-left"></i> Principle and Defense Scheme of SSRF Vulnerability</a></div><div class="post-nav-item"> <a href="/en/2021/05/13/react-hook/" rel="next" title="History of React Hook and Pits in Actual Combat">History of React Hook and Pits in Actual Combat<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/en/js/third-party/math/mathjax.js"></script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/en/2021/05/11/redux/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>