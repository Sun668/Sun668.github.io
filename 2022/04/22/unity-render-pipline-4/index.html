<!DOCTYPE html>
<html lang>
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"sunra.top","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="前面介绍了渲染流水线的基本内容，接下来就其中的我们可以编程的部分进行介绍，开始之前我们需要先介绍一些基础概念，对其中的一些属性进行简单说明。">
<meta property="og:type" content="article">
<meta property="og:title" content="Unity Shader(四) Unity Shader基础概念">
<meta property="og:url" content="https://sunra.top/2022/04/22/unity-render-pipline-4/index.html">
<meta property="og:site_name" content="Origin of Ray">
<meta property="og:description" content="前面介绍了渲染流水线的基本内容，接下来就其中的我们可以编程的部分进行介绍，开始之前我们需要先介绍一些基础概念，对其中的一些属性进行简单说明。">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2022-04-22T09:31:21.408Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Unity Shader(四) Unity Shader基础概念">
<meta name="twitter:description" content="前面介绍了渲染流水线的基本内容，接下来就其中的我们可以编程的部分进行介绍，开始之前我们需要先介绍一些基础概念，对其中的一些属性进行简单说明。">

<link rel="canonical" href="https://sunra.top/2022/04/22/unity-render-pipline-4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'default'
  };
</script>

  <title>Unity Shader(四) Unity Shader基础概念 | Origin of Ray</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Origin of Ray</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">一起探索互联网的秘密</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" placeholder="Searching..." spellcheck="false" type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://sunra.top/2022/04/22/unity-render-pipline-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg">
      <meta itemprop="name" content="Ray Sun">
      <meta itemprop="description" content="拨开互联网的迷雾">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Origin of Ray">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Unity Shader(四) Unity Shader基础概念
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-04-22 07:42:09 / Modified: 17:31:21" itemprop="dateCreated datePublished" datetime="2022-04-22T07:42:09+08:00">2022-04-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>前面介绍了渲染流水线的基本内容，接下来就其中的我们可以编程的部分进行介绍，开始之前我们需要先介绍一些基础概念，对其中的一些属性进行简单说明。</p>
<a id="more"></a>
<h2 id="Shader-简介"><a href="#Shader-简介" class="headerlink" title="Shader 简介"></a>Shader 简介</h2><h3 id="Shader类型"><a href="#Shader类型" class="headerlink" title="Shader类型"></a>Shader类型</h3><p>Unity中的Shader被分为三种大的类型，分别用于不同的目的：</p>
<ul>
<li>Shader：是渲染流水线的一部分，也是最常使用的一种Shader，这种Shader用于计算屏幕上的每一点的像素值。这种着色器又分为多种类型<ul>
<li>顶点着色器</li>
<li>片元着色器</li>
<li>表面着色器（Unity特有，会被编译出顶点着色器和片元着色器）</li>
</ul>
</li>
<li>计算Shader（Compute Shader）：在GPU中进行计算，不过该过程并不在图形流水线中。</li>
<li>光线追踪Shader（Ray Tracing Shader）：执行与光线追踪有关的计算。</li>
</ul>
<h3 id="术语表"><a href="#术语表" class="headerlink" title="术语表"></a>术语表</h3><ul>
<li>Shader/Shader Program: 一段运行在GPU上的程序，除非特别说明，指的是普通的作为渲染流水线一部分的Shader。</li>
<li>Shader Object：Shader Class的一个实例，内部封装了Shader Program以及其他信息。</li>
<li>Shader Lab：Unity封装的专用的Shader语言</li>
<li>Shader Graph：可视化创建Shader的工具</li>
<li>Shader asset：Unity项目中以“.shader”为扩展名的文件，它定义了一个Shader Object</li>
<li>Shader Graph asset：Unity项目中的一个文件，定义了一个Shader Object</li>
</ul>
<h2 id="Shader-Class"><a href="#Shader-Class" class="headerlink" title="Shader Class"></a>Shader Class</h2><p>在Unity中，当我们使用作为流水线一部分的Shader时，我们使用的是Shader Class的一个实例，即Shader Object<br>Shader Object是Unity专用的一种Shader Program的工作方式，它封装了Shader Program以及其他相关信息，它能够在同一个文件中定义多个Shader Program，并且告知Unity如何使用它们。</p>
<h3 id="Shader-Object基础"><a href="#Shader-Object基础" class="headerlink" title="Shader Object基础"></a>Shader Object基础</h3><p>一个Shader Object包含了Shader Program,修改GPU设置的指令（即render state），以及Unity如何使用它们的信息。</p>
<p>有两种方式可以创建新的Shader Object：</p>
<ul>
<li>通过写代码的方式创建一个Shader asset（以“.shader”为扩展名的文本文件）</li>
<li>使用Shader Graph创建一个Shader Graph asset<br>无论哪种方式，结果都是相同的。</li>
</ul>
<h3 id="Shader-Object-内部结构"><a href="#Shader-Object-内部结构" class="headerlink" title="Shader Object 内部结构"></a>Shader Object 内部结构</h3><p><strong>一个Shader Object有着一个嵌套的结构，把Shader Program组织成Shader Variants，把内部信息组织成叫做SubShader和Pass的结构。</strong></p>
<p>一个Shader Object包含：</p>
<ul>
<li>它自身的信息，如它的名字</li>
<li>可选的fallback Shader Object，用于当自身不可用的时候供Unity调用</li>
<li>一个或者多个SubShader</li>
</ul>
<p>我们也可以定义一些附加的信息，例如共享的Shader code等</p>
<h4 id="SubShader"><a href="#SubShader" class="headerlink" title="SubShader"></a>SubShader</h4><p>SubShader允许我们把Shader Object拆分成多个部分，以适应不同的硬件，流水线和运行时的设置</p>
<p>一个SubShader包含：</p>
<ul>
<li>该SubShader适用的硬件，流水线以及运行时的设置</li>
<li>SubShader Tag，一组提供SubShader相关信息的键值对</li>
<li>一个或者多个Pass</li>
</ul>
<p>我们也可以定义一些附加信息，如适用于所有的所属Pass的render state</p>
<h4 id="Pass"><a href="#Pass" class="headerlink" title="Pass"></a>Pass</h4><p>一个Pass包含：</p>
<ul>
<li>Pass Tag，提供Pass相关信息的键值对</li>
<li>运行Pass所属Shader program之前更新render state的指令</li>
<li>Shader Program，之后会被组织成Shader variants<br>我们还可以定义一些额外信息，如Pass的name</li>
</ul>
<h4 id="Shader-Variants"><a href="#Shader-Variants" class="headerlink" title="Shader Variants"></a>Shader Variants</h4><p>Pass中的Shader Program会被组织称Shader Variant，着色器变体共享公共代码，但在启用或禁用给定关键字时具有不同的功能。</p>
<p>Pass中的着色器变体的数量取决于在着色器代码中定义的关键字和目标平台。每个Pass包含至少一个变体</p>
<blockquote>
<p>说到这个Shader变体，它是我们打包过程中需要重视的一个环节，一个小小的设置不同，就可能会多出几万个变体出来，所以在优化包体积的时候，减少Shader变体数量也是一个很重要的环节，有一篇文章写的不错，记录一下：<a href="https://blog.unity.com/technology/stripping-scriptable-shader-variants" rel="external nofollow noopener noreferrer" target="_blank">https://blog.unity.com/technology/stripping-scriptable-shader-variants</a></p>
</blockquote>
<h3 id="渲染过程中关于Shader的调用流程"><a href="#渲染过程中关于Shader的调用流程" class="headerlink" title="渲染过程中关于Shader的调用流程"></a>渲染过程中关于Shader的调用流程</h3><p>Unity在使用一个Shader Object之前，会创建一个该Shader Object中SubShader的列表，包括自己定义的和fallback中的</p>
<p>当Unity首次渲染几何体或者Shader的LOD值发生变化或者渲染流水线的设置发生变化时，需要决定采取该Shader Object中的哪一个SubShader：</p>
<ul>
<li>Unity会首先遍历列表中的所有SubShader，找出适合当前设备，小于或者等于当前LOD值的，并且符合流水线设置的SubShader</li>
<li>如果有多个SubShader符合上面的要求，那么就选择符合条件的第一个</li>
<li>如果没有符合条件的SubShader，那么<ul>
<li>如果是符合设备要求但是不符合LOD或者流水线设置的要求，那么就在这种SubShader中选择一个</li>
<li>如果是任何要求都不符合，那么就要报错了<br>Unity会识别使用相同Shader变体的几何体，然后打包成batch一起进行渲染</li>
</ul>
</li>
<li>Unity确定当前SubShader中的哪个Pass它应该呈现，并且在帧中的哪一点。此行为因渲染管道而异</li>
<li>每个Pass它会渲染：<ul>
<li>如果当前的render state与Pass中的render state不同，那么改成Pass中的render state</li>
<li>GPU使用相关的Shader Variants进行渲染</li>
</ul>
</li>
</ul>
<h2 id="Shader的编译"><a href="#Shader的编译" class="headerlink" title="Shader的编译"></a>Shader的编译</h2><p>每次构建项目时，Unity 编辑器都会编译构建所需的所有着色器：针对每个所需的图形 API 编译每个所需的着色器变体。<br>当您在 Unity 编辑器中工作时，编辑器不会提前编译所有内容。这是因为为每个图形 API 编译每个变体可能需要很长时间。<br>相反，Unity 编辑器会这样做：</p>
<ul>
<li>当导入一个着色器资源时，会执行一些最小的处理（例如表面着色器生成）。</li>
<li>当需要显示着色器变体时，它会检查 Library/ShaderCache 文件夹。</li>
<li>如果找到使用相同源代码的先前编译的着色器变体，则会使用该着色器变体。</li>
<li>如果没有找到匹配项，则编译所需的着色器变体并将结果保存到缓存中。<ul>
<li>注意：如果您启用异步着色器编译，它在后台执行此操作并同时显示占位着色器。<br>着色器编译使用名为 UnityShaderCompiler 的进程。可启动多个 UnityShaderCompiler 编译器进程（通常在机器中每个 CPU 核心对应一个），这样在播放器构建时就可以并行完成着色器编译。当编辑器不编译着色器时，编译器进程不执行任何操作，也不消耗计算机资源。<br>如果有许多经常更改的着色器，着色器缓存文件夹可能会变得非常大。删除此文件夹是安全的；只会导致 Unity 重新编译着色器变体。<br>在播放器构建时，所有“尚未编译”的着色器变体都将被编译，因此即使编辑器不会使用这些着色器变体，它们也会存在于游戏数据中。</li>
</ul>
</li>
</ul>
<h3 id="构建时剥离"><a href="#构建时剥离" class="headerlink" title="构建时剥离"></a>构建时剥离</h3><p>在构建游戏时，Unity 可能检测到游戏不使用某些内部着色器变体，并从构建数据中排除（“剥离”）它们。构建时剥离将用于以下各项：</p>
<ul>
<li>对于使用 #pragma shader_feature 的着色器，Unity 会自动检查是否使用了变体。如果构建中的材质都不使用某个变体，则该变体不会包含在构建中。请参阅内部着色器变体文档。标准着色器会使用此功能。</li>
<li>任何场景未使用的可处理雾效和光照贴图模式的着色器变体不会包含在游戏数据中。如果要覆盖此行为，请参阅 Graphics 窗口。</li>
<li>还可以手动识别变体并使用 OnProcessShader API 告诉 Unity 将这些变体从构建中排除。<br>上述的组合通常会大大减小着色器数据大小。例如，完全编译后的标准着色器将占用几百兆字节，但在典型的项目中，通常最终仅占用几兆字节（并且通常会由应用程序打包过程进一步压缩）。</li>
</ul>
<h3 id="异步Shader编译"><a href="#异步Shader编译" class="headerlink" title="异步Shader编译"></a>异步Shader编译</h3><p>一个Shader Object可能会编译出成百上千个Shader变体，如果Unity每次加载一个Shader Object都要把所有的Shader变体都编译完成，那么编辑器可能会卡顿。而且实际上，Unity会按需对变体进行编译，同时使用占位的Shader Object。</p>
<p>异步着色器编译的工作原理是：</p>
<ol>
<li>当编辑器第一次遇到未编译的着色器变体时，它会将着色器变体添加到作业线程上的编译队列中。编辑器右下角的进度条会显示编译队列的状态。 </li>
<li>在加载着色器变体时，编辑器使用占位着色器渲染几何体，该着色器显示为纯青色。 </li>
<li>当编辑器完成对着色器变体的编译后，它会使用着色器变体来渲染几何体。</li>
</ol>
<p>具体还有一些通过设置和代码的方式去开关这种异步编译的方法，就不赘述，可以去看一下<a href="https://docs.unity3d.com/cn/current/Manual/AsynchronousShaderCompilation.html" rel="external nofollow noopener noreferrer" target="_blank">异步着色器编译的官方文档</a></p>
<h2 id="Shader中的分支，变体和关键字（keywords）"><a href="#Shader中的分支，变体和关键字（keywords）" class="headerlink" title="Shader中的分支，变体和关键字（keywords）"></a>Shader中的分支，变体和关键字（keywords）</h2><p>有时，我们希望同一个着色器在不同情况下有不同的行为。发生这种情况时，您使用条件来定义不同硬件的不同行为。</p>
<p>本手册的本节包含有关定色器变体和关键字工作以及何时以及如何使用它们的信息。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>页面</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Conditionals in shaders</td>
<td>An introduction to conditionals in shaders, including information on the different types of conditional, and when to use which one.</td>
</tr>
<tr>
<td>Shader branching</td>
<td>An introduction to static and dynamic branching in shaders.</td>
</tr>
<tr>
<td>Shader variants</td>
<td>An introduction to shader variants, and information on how to understand and control how many shader variants Unity compiles.</td>
</tr>
<tr>
<td>Shader keywords</td>
<td>An introduction to shader keywords, and information on how to use them.</td>
</tr>
<tr>
<td>Using shader keywords with C# scripts</td>
<td>Working with shader keywords in C# scripts.</td>
</tr>
<tr>
<td>Using shader keywords with the material Inspector</td>
<td>Working with shader keywords in the Unity Editor, using the material Inspector.</td>
</tr>
<tr>
<td>着色器变体集合</td>
<td>An introduction to shader variant collections, and information on how to use them.</td>
</tr>
</tbody>
</table>
</div>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>Ray Sun
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://sunra.top/2022/04/22/unity-render-pipline-4/" title="Unity Shader(四) Unity Shader基础概念">https://sunra.top/2022/04/22/unity-render-pipline-4/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/04/14/storage-management-1/" rel="prev" title="计算机存储管理全面梳理（一）内存管理的基本原理和要求">
      <i class="fa fa-chevron-left"></i> 计算机存储管理全面梳理（一）内存管理的基本原理和要求
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Shader-简介"><span class="nav-number">1.</span> <span class="nav-text">Shader 简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Shader类型"><span class="nav-number">1.1.</span> <span class="nav-text">Shader类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#术语表"><span class="nav-number">1.2.</span> <span class="nav-text">术语表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Shader-Class"><span class="nav-number">2.</span> <span class="nav-text">Shader Class</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Shader-Object基础"><span class="nav-number">2.1.</span> <span class="nav-text">Shader Object基础</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Shader-Object-内部结构"><span class="nav-number">2.2.</span> <span class="nav-text">Shader Object 内部结构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SubShader"><span class="nav-number">2.2.1.</span> <span class="nav-text">SubShader</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pass"><span class="nav-number">2.2.2.</span> <span class="nav-text">Pass</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Shader-Variants"><span class="nav-number">2.2.3.</span> <span class="nav-text">Shader Variants</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#渲染过程中关于Shader的调用流程"><span class="nav-number">2.3.</span> <span class="nav-text">渲染过程中关于Shader的调用流程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Shader的编译"><span class="nav-number">3.</span> <span class="nav-text">Shader的编译</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#构建时剥离"><span class="nav-number">3.1.</span> <span class="nav-text">构建时剥离</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#异步Shader编译"><span class="nav-number">3.2.</span> <span class="nav-text">异步Shader编译</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Shader中的分支，变体和关键字（keywords）"><span class="nav-number">4.</span> <span class="nav-text">Shader中的分支，变体和关键字（keywords）</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg">
  <p class="site-author-name" itemprop="name">Ray Sun</p>
  <div class="site-description" itemprop="description">拨开互联网的迷雾</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">201</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Sun668" title="GitHub → https://github.com/Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://kingworker.cn/" title="https://kingworker.cn/" rel="external nofollow noopener noreferrer" target="_blank">大树的个人随想</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ray Sun</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  <script src="/js/local-search.js"></script>












  

  

  

</body>
</html>
