<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sunra.top","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.17.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8623125811074939" crossorigin="anonymous"></script><script>!function(e,p,s,r){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var d,t=p.getElementsByTagName(s)[0];(d=p.createElement(s)).id="webpushr-jssdk",d.async=1,d.src="https://cdn.webpushr.com/app.min.js",t.parentNode.appendChild(d)}}(window,document,"script"),webpushr("setup",{key:"BEQjc-0d1Q1CubrYZ2e2XXv5Is0ZCd3CtrNLet06owkUWK68qkxHpho2mKdnj2vpGdxddRDxRYthLuMwrTqfSB4"})</script><meta name="description" content="概述在大致搞清楚比特币的基本概念之后，再来理解以太坊的概念就容易很多，其中最主要的就是搞清楚什么是智能合约。 只是合约其实就是存储在区块链上并运行在矿工机上的一段代码，由于以太坊的限制，这段代码并不能过大，也不能过于复杂。"><meta property="og:type" content="article"><meta property="og:title" content="智能合约概述"><meta property="og:url" content="https://sunra.top/posts/dfe9e270/index.html"><meta property="og:site_name" content="Origin of Ray"><meta property="og:description" content="概述在大致搞清楚比特币的基本概念之后，再来理解以太坊的概念就容易很多，其中最主要的就是搞清楚什么是智能合约。 只是合约其实就是存储在区块链上并运行在矿工机上的一段代码，由于以太坊的限制，这段代码并不能过大，也不能过于复杂。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="d:/document/study/YNote/qq063B60F6CBD116FB4E7479117DADDDEF/c84218cfc20e4f21be8e4befbd9157c4/4660_image3.jpeg"><meta property="article:published_time" content="2019-12-05T11:59:23.000Z"><meta property="article:modified_time" content="2023-06-07T00:10:45.723Z"><meta property="article:author" content="Ray Sun"><meta property="article:tag" content="技术分享 使用教程 原理 前端 计算机图形学"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="d:/document/study/YNote/qq063B60F6CBD116FB4E7479117DADDDEF/c84218cfc20e4f21be8e4befbd9157c4/4660_image3.jpeg"><link rel="canonical" href="https://sunra.top/posts/dfe9e270/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://sunra.top/posts/dfe9e270/","path":"posts/dfe9e270/","title":"智能合约概述"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>智能合约概述 | Origin of Ray</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-KEJ1L66CKC"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KEJ1L66CKC","only_pageview":false}</script><script src="/js/third-party/analytics/google-analytics.js"></script><script src="/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?cc2e15dfd66849cf1d7843d0d532438e"></script><link rel="dns-prefetch" href="https://blog-comments-3w44.vercel.app/"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="Origin of Ray" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Origin of Ray</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">一起探索互联网的秘密</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-english"><a href="https://sunra.top/en" rel="section"><i class="fa fa-language fa-fw"></i>English</a></li><li class="menu-item menu-item-中文"><a href="https://sunra.top/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E6%96%87%E6%A1%A3%E6%91%98%E8%A6%81"><span class="nav-number">2.</span> <span class="nav-text">详细文档摘要</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6"><span class="nav-number">2.1.</span> <span class="nav-text">什么是智能合约</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6"><span class="nav-number">2.2.</span> <span class="nav-text">简单的智能合约</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%98%E5%82%A8"><span class="nav-number">2.2.1.</span> <span class="nav-text">存储</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%A8%E8%A7%A3"><span class="nav-number">2.2.1.1.</span> <span class="nav-text">注解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AD%A6%E5%91%8A"><span class="nav-number">2.2.1.2.</span> <span class="nav-text">警告</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%90%E8%B4%A7%E5%B8%81%EF%BC%88Subcurrency%EF%BC%89%E4%BE%8B%E5%AD%90"><span class="nav-number">2.2.2.</span> <span class="nav-text">子货币（Subcurrency）例子</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A5%E5%A4%AA%E5%9D%8A%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="nav-number">2.3.</span> <span class="nav-text">以太坊虚拟机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E7%82%B9%E6%A6%82%E5%BF%B5%E5%86%8D%E6%AC%A1%E8%A7%A3%E9%87%8A"><span class="nav-number">2.4.</span> <span class="nav-text">重点概念再次解释</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E5%A4%96%E8%AF%9D"><span class="nav-number">3.</span> <span class="nav-text">题外话</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E9%9B%B6%E5%9C%B0%E5%9D%80"><span class="nav-number">3.1.</span> <span class="nav-text">全零地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%A6%82%E4%BD%95%E8%BF%90%E8%A1%8C"><span class="nav-number">3.2.</span> <span class="nav-text">智能合约如何运行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%88%E7%BA%A6%E4%B8%8E%E5%90%88%E7%BA%A6%E8%B4%A6%E6%88%B7"><span class="nav-number">3.3.</span> <span class="nav-text">合约与合约账户</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Ray Sun" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><p class="site-author-name" itemprop="name">Ray Sun</p><div class="site-description" itemprop="description">拨开互联网的迷雾</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">267</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">分类</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Sun668" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sun668" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:947692259@qq.com" title="E-Mail → mailto:947692259@qq.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span></div><div class="cc-license animated" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div><div class="wechat_channel" style="width:50%;margin-left:25%"><br> <img src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://sunra.top/posts/dfe9e270/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1592617514/avatar_rpap6c.jpg"><meta itemprop="name" content="Ray Sun"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Origin of Ray"><meta itemprop="description" content="拨开互联网的迷雾"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="智能合约概述 | Origin of Ray"><meta itemprop="description" content></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 智能合约概述</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-12-05 19:59:23" itemprop="dateCreated datePublished" datetime="2019-12-05T19:59:23+08:00">2019-12-05</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2023-06-07 08:10:45" itemprop="dateModified" datetime="2023-06-07T08:10:45+08:00">2023-06-07</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Blockchain/" itemprop="url" rel="index"><span itemprop="name">Blockchain</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Waline：</span><a title="waline" href="/posts/dfe9e270/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/posts/dfe9e270/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>在大致搞清楚比特币的基本概念之后，再来理解以太坊的概念就容易很多，其中最主要的就是搞清楚什么是智能合约。</p><p>只是合约其实就是存储在区块链上并运行在矿工机上的一段代码，由于以太坊的限制，这段代码并不能过大，也不能过于复杂。</p><span id="more"></span><p>那么智能合约大致是怎么工作的呢？</p><p>目前的理解是以太坊存在两种账户，一种是外部账户，一种是合约账户，二者都有自己的地址和余额，唯一的区别就是合约账户上存储着智能合约合约的codehash，实际的合约代码已经通过一笔交易被矿工存储到了区块链上，所以发布合约实际上也是一笔交易。可以通过向全零地址发送一笔交易来创建合约，然后根据合约内容生成合约的地址用于标识合约账户，这个过程与创建外部账户不同，外部账户地址的生成是有公钥生成私钥，再由私钥计算出地址，这个过程不可逆，这也是为什么只有掌握了私钥就等于掌握了地址；但是合约账户的地址生成依赖的主要是合约代码的hash。</p><p>当我们在dapp上通过界面发出一条指令时，可能就是向某个指定的合约账户发起了一场交易，矿工收到交易消息后通过codehash找到合约代码并运行，当然这笔交易也可以向合约账户转账。矿工运行合约之后在交易的基础上收取一定的费用，之后通过挖矿将这笔交易确认后就可以获取这笔费用。</p><p>并不是说每一笔交易都必须发向某一个合约账户，也可以直接发向某个外部账户，那收到这个交易信息的矿工只需要确认这比交易是否可以成立，比如发送者简单的余额是否足够就可以，不需要去运行合约代码。</p><p>我们可以简单的吧DApp理解为一个前后端分离的项目，前端就是我们平时见过的正常的前端，但是他的后台代码是智能合约，而且二者之间的通信也不是平时我们用到的类似Axios这种工具，而是通过web3.js来进行通信。</p><h2 id="详细文档摘要"><a href="#详细文档摘要" class="headerlink" title="详细文档摘要"></a>详细文档摘要</h2><h3 id="什么是智能合约"><a href="#什么是智能合约" class="headerlink" title="什么是智能合约"></a>什么是智能合约</h3><p>以太坊是一个可编程的区块链应用，像比特币一样，以太坊基于分布式计算机组成的点对点网络协议。但是以太坊不像比特币一样，提供某种特定的功能，事实上，以太坊没有提供任何现成的功能，包括交易，反而是让用户在它的基础上自行编程开发功能，然后将开发好的代码存储在区块链上并提供给所有人使用，这些程序运行在以太坊虚拟机上，也就是所有以太坊的节点组成的网络上，由整个以太坊的网络提供算力，并向最终实际提供算力的节点支付费用，这些运行在以太坊虚拟机上的程序就是智能合约。</p><p>比特币网络中有大量计算机节点负责维护和更新区块链，在ETH中同样存在，被称为EVM（Eth虚拟机）。可以把EVM看作一台超级计算机，拥有网络中所有节点的计算能力，该计算能力用于在区块链上运行智能合约。EVM向用户收取非常小的ETH代币维护费作为回报，以提供智能合约需要使用的计算能力，这个费用被称为“gas”。所以ETH代币的核心意义不是作为一般等价物的货币，而是类似于石油一样作为动力驱动ETH网络。</p><h3 id="简单的智能合约"><a href="#简单的智能合约" class="headerlink" title="简单的智能合约"></a>简单的智能合约</h3><p>我们通过官网的示例来进行解释</p><h4 id="存储"><a href="#存储" class="headerlink" title="存储"></a>存储</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.0</span>;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">SimpleStorage</span> &#123;</span><br><span class="line">    uint storedData;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">set</span>(<span class="params">uint x</span>) public &#123;</span><br><span class="line">        storedData = x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">get</span>(<span class="params"></span>) public view returns (uint) &#123;</span><br><span class="line">        <span class="keyword">return</span> storedData;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第一行就是告诉大家源代码使用Solidity版本0.4.0写的，并且使用0.4.0以上版本运行也没问题（最高到0.5.0，但是不包含0.5.0）。这是为了确保合约不会在新的编译器版本中突然行为异常。关键字 pragma 的含义是，一般来说，pragmas（编译指令）是告知编译器如何处理源代码的指令的（例如， <a target="_blank" rel="external nofollow noopener noreferrer" href="https://en.wikipedia.org/wiki/Pragma_once">pragma once</a> ）。</p><p>Solidity中合约的含义就是一组代码（它的 <em>函数</em> )和数据（它的 <em>状态</em> ），它们位于以太坊区块链的一个特定地址上。 代码行 uint storedData; 声明一个类型为 uint (256位无符号整数）的状态变量，叫做 storedData 。 你可以认为它是数据库里的一个位置，可以通过调用管理数据库代码的函数进行查询和变更。对于以太坊来说，上述的合约就是拥有合约（owning contract）。在这种情况下，函数 set 和 get 可以用来变更或取出变量的值。</p><p>要访问一个状态变量，并不需要像 this. 这样的前缀，虽然这是其他语言常见的做法。</p><p>该合约能完成的事情并不多（由于以太坊构建的基础架构的原因）：它能允许任何人在合约中存储一个单独的数字，并且这个数字可以被世界上任何人访问，且没有可行的办法阻止你发布这个数字。当然，任何人都可以再次调用 set ，传入不同的值，覆盖你的数字，但是这个数字仍会被存储在区块链的历史记录中。随后，我们会看到怎样施加访问限制，以确保只有你才能改变这个数字。</p><h5 id="注解"><a href="#注解" class="headerlink" title="注解"></a><strong>注解</strong></h5><p>所有的标识符（合约名称，函数名称和变量名称）都只能使用ASCII字符集。UTF-8编码的数据可以用字符串变量的形式存储。</p><h5 id="警告"><a href="#警告" class="headerlink" title="警告"></a><strong>警告</strong></h5><p>小心使用Unicode文本，因为有些字符虽然长得相像（甚至一样），但其字符码是不同的，其编码后的字符数组也会不一样。</p><h4 id="子货币（Subcurrency）例子"><a href="#子货币（Subcurrency）例子" class="headerlink" title="子货币（Subcurrency）例子"></a><strong>子货币（Subcurrency）例子</strong></h4><p>下面的合约实现了一个最简单的加密货币。这里，币确实可以无中生有地产生，但是只有创建合约的人才能做到（实现一个不同的发行计划也不难）。而且，任何人都可以给其他人转币，不需要注册用户名和密码 —— 所需要的只是以太坊密钥对。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.21</span>;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">Coin</span> &#123;</span><br><span class="line">    <span class="comment">// 关键字“public”让这些变量可以从外部读取</span></span><br><span class="line">    address public minter;</span><br><span class="line">    mapping (<span class="function"><span class="params">address</span> =&gt;</span> uint) public balances;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 轻客户端可以通过事件针对变化作出高效的反应</span></span><br><span class="line">    event <span class="title class_">Sent</span>(address <span class="keyword">from</span>, address to, uint amount);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这是构造函数，只有当合约创建时运行</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Coin</span>(<span class="params"></span>) public &#123;</span><br><span class="line">        minter = msg.<span class="property">sender</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">mint</span>(<span class="params">address receiver, uint amount</span>) public &#123;</span><br><span class="line">        <span class="keyword">if</span> (msg.<span class="property">sender</span> != minter) <span class="keyword">return</span>;</span><br><span class="line">        balances[receiver] += amount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">send</span>(<span class="params">address receiver, uint amount</span>) public &#123;</span><br><span class="line">        <span class="keyword">if</span> (balances[msg.<span class="property">sender</span>] &lt; amount) <span class="keyword">return</span>;</span><br><span class="line">        balances[msg.<span class="property">sender</span>] -= amount;</span><br><span class="line">        balances[receiver] += amount;</span><br><span class="line">        emit <span class="title class_">Sent</span>(msg.<span class="property">sender</span>, receiver, amount);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个合约引入了一些新的概念，让我们逐一解读。</p><p>address public minter; 这一行声明了一个可以被公开访问的 address 类型的状态变量。 address 类型是一个160位的值，且不允许任何算数操作。这种类型适合存储合约地址或外部人员的密钥对。关键字 public 自动生成一个函数，允许你在这个合约之外访问这个状态变量的当前值。如果没有这个关键字，其他的合约没有办法访问这个变量。由编译器生成的函数的代码大致如下所示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">minter</span>(<span class="params"></span>) returns (address) &#123; <span class="keyword">return</span> minter; &#125;</span><br></pre></td></tr></table></figure><p>当然，加一个和上面完全一样的函数是行不通的，因为我们会有同名的一个函数和一个变量，这里，主要是希望你能明白——编译器已经帮你实现了。</p><p>下一行， mapping (address =&gt; uint) public balances; 也创建一个公共状态变量，但它是一个更复杂的数据类型。 该类型将address映射为无符号整数。 Mappings 可以看作是一个 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://en.wikipedia.org/wiki/Hash_table">哈希表</a> 它会执行虚拟初始化，以使所有可能存在的键都映射到一个字节表示为全零的值。 但是，这种类比并不太恰当，因为它既不能获得映射的所有键的列表，也不能获得所有值的列表。 因此，要么记住你添加到mapping中的数据（使用列表或更高级的数据类型会更好），要么在不需要键列表或值列表的上下文中使用它，就如本例。 而由 public 关键字创建的getter函数 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://solidity-cn.readthedocs.io/zh/develop/contracts.html#getter-functions">getter function</a> 则是更复杂一些的情况， 它大致如下所示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">balances</span>(<span class="params">address _account</span>) public view returns (uint) &#123;</span><br><span class="line">    <span class="keyword">return</span> balances[_account];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>正如你所看到的，你可以通过该函数轻松地查询到账户的余额。</p><p>event Sent(address from, address to, uint amount); 这行声明了一个所谓的“事件（event）”，它会在 send 函数的最后一行被发出。用户界面（当然也包括服务器应用程序）可以监听区块链上正在发送的事件，而不会花费太多成本。一旦它被发出，监听该事件的listener都将收到通知。而所有的事件都包含了 from ， to 和 amount 三个参数，可方便追踪事务。 为了监听这个事件，你可以使用如下代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Coin</span>.<span class="title class_">Sent</span>().<span class="title function_">watch</span>(&#123;&#125;, <span class="string">&#x27;&#x27;</span>, <span class="keyword">function</span>(<span class="params">error, result</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Coin transfer: &quot;</span> + result.<span class="property">args</span>.<span class="property">amount</span> +</span><br><span class="line">            <span class="string">&quot; coins were sent from &quot;</span> + result.<span class="property">args</span>.<span class="property">from</span> +</span><br><span class="line">            <span class="string">&quot; to &quot;</span> + result.<span class="property">args</span>.<span class="property">to</span> + <span class="string">&quot;.&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Balances now:\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;Sender: &quot;</span> + <span class="title class_">Coin</span>.<span class="property">balances</span>.<span class="title function_">call</span>(result.<span class="property">args</span>.<span class="property">from</span>) +</span><br><span class="line">            <span class="string">&quot;Receiver: &quot;</span> + <span class="title class_">Coin</span>.<span class="property">balances</span>.<span class="title function_">call</span>(result.<span class="property">args</span>.<span class="property">to</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>这里请注意自动生成的 balances 函数是如何从用户界面调用的。</p><p>特殊函数 Coin 是在创建合约期间运行的构造函数，不能在事后调用。 它永久存储创建合约的人的地址: msg (以及 tx 和 block ) 是一个神奇的全局变量，其中包含一些允许访问区块链的属性。 msg.sender 始终是当前（外部）函数调用的来源地址。</p><p>最后，真正被用户或其他合约所调用的，以完成本合约功能的方法是 mint 和 send。 如果 mint 被合约创建者外的其他人调用则什么也不会发生。 另一方面， send 函数可被任何人用于向他人发送币 (当然，前提是发送者拥有这些币)。记住，如果你使用合约发送币给一个地址，当你在区块链浏览器上查看该地址时是看不到任何相关信息的。因为，实际上你发送币和更改余额的信息仅仅存储在特定合约的数据存储器中。通过使用事件，你可以非常简单地为你的新币创建一个“区块链浏览器”来追踪交易和余额。</p><h3 id="以太坊虚拟机"><a href="#以太坊虚拟机" class="headerlink" title="以太坊虚拟机"></a>以太坊虚拟机</h3><p><strong>概述</strong></p><p>以太坊虚拟机 EVM 是智能合约的运行环境。它不仅是沙盒封装的，而且是完全隔离的，也就是说在 EVM 中运行代码是无法访问网络、文件系统和其他进程的。甚至智能合约之间的访问也是受限的。</p><p><strong>账户</strong></p><p>以太坊中有两类账户（它们共用同一个地址空间）： <strong>外部账户</strong> 由公钥-私钥对（也就是人）控制； <strong>合约账户</strong> 由和账户一起存储的代码控制.</p><p>外部账户的地址是由公钥决定的，而合约账户的地址是在创建该合约时确定的（这个地址通过合约创建者的地址和从该地址发出过的交易数量计算得到的，也就是所谓的“nonce”）</p><p>无论帐户是否存储代码，这两类账户对 EVM 来说是一样的。</p><p>每个账户都有一个键值对形式的持久化存储。其中 key 和 value 的长度都是256位，我们称之为 <strong>存储</strong> 。</p><p>此外，每个账户有一个以太币余额（ <strong>balance</strong> ）（单位是“Wei”），余额会因为发送包含以太币的交易而改变。</p><p><strong>交易</strong></p><p>交易可以看作是从一个帐户发送到另一个帐户的消息（这里的账户，可能是相同的或特殊的零帐户，请参阅下文）。它能包含一个二进制数据（合约负载）和以太币。</p><p>如果目标账户含有代码，此代码会被执行，并以 payload 作为入参。</p><p>如果目标账户是零账户（账户地址为 0 )，此交易将创建一个 <strong>新合约</strong> 。 如前文所述，合约的地址不是零地址，而是通过合约创建者的地址和从该地址发出过的交易数量计算得到的（所谓的“nonce”）。 这个用来创建合约的交易的 payload 会被转换为 EVM 字节码并执行。执行的输出将作为合约代码被永久存储。这意味着，为创建一个合约，你不需要发送实际的合约代码，而是发送能够产生合约代码的代码。</p><p><strong>注解</strong></p><p>在合约创建的过程中，它的代码还是空的。所以直到构造函数执行结束，你都不应该在其中调用合约自己函数。</p><p><strong>Gas</strong></p><p>一经创建，每笔交易都收取一定数量的 <strong>gas</strong> ，目的是限制执行交易所需要的工作量和为交易支付手续费。EVM 执行交易时，gas 将按特定规则逐渐耗尽。</p><p><strong>gas price</strong> 是交易发送者设置的一个值，发送者账户需要预付的手续费= gas_price * gas 。如果交易执行后还有剩余， gas 会原路返还。</p><p>无论执行到什么位置，一旦 gas 被耗尽（比如降为负值），将会触发一个 out-of-gas 异常。当前调用帧（call frame）所做的所有状态修改都将被回滚。</p><p>那么可能就会有一个问题，如果gas price是交易发送者自己制定的，那不是越低越省钱？每个人都不想多付钱。要解决这个问题首先要搞明白三个概念：</p><p>Gas</p><p>Gas对应于一个交易(Transaction)中以太坊虚拟机(EVM)的实际运算步数。 越简单的交易，例如单纯的</p><p>以太币转帐交易，需要的运算步数越少， Gas亦会需要的少一点。 反之，如果要计算一些复杂运算，Gas的消耗</p><p>量就会大。 所以你提交的交易需要EVM进行的计算量越大，所需的Gas消耗量就越高了。</p><p>Gas Price</p><p>Gas Price就是你愿意为一个单位的Gas出多少Eth，一般用Gwei作单位。 所以Gas Price 越高，</p><p>就表示交易中每运算一步，会支付更多的Eth。</p><p>大家可能对Gwei 这个单位感到陌生，Gwei 其实就是10 ^ -9 Eth，也就是说1 Gwei = 0.000000001 Eth。</p><p>所以，当你设定Gas price = 20 Gwei ，就意味着你愿意为单步运算支付0.00000002 Eth。</p><p>说到这里，聪明如你就会意识到以太坊的手续费计算公式很简单：</p><p>交易手续费(Tx Fee) = 实际运行步数(Actual Gas Used) * 单步价格(Gas Price)</p><p>例如你的交易需要以太坊执行50步完成运算，假设你设定的Gas Price是2 Gwei ，那么整个交易的手续费</p><p>就是50 * 2 = 100 Gwei 了。</p><p>Gas Limit</p><p>Gas Limit就是一次交易中Gas的可用上限，也就是你的交易中最多会执行多少步运算。 由于交易复杂程度各有不同，</p><p>确切的Gas消耗量是在完成交易后才会知道，因此在你提交交易之前，需要为交易设定一个Gas用量的上限。</p><p>如果说你提交的交易尚未完成，消耗的Gas就已经超过你设定的Gas Limit，那么这次交易就会被取消，而</p><p>已经消耗的手续费同样被扣取 —— 因为要奖励已经付出劳动的矿工。 而如果交易已经完成，消耗的Gas未达到Gas Limit，</p><p>那么只会按实际消耗的Gas 收取交易服务费。 换句话说，一个交易可能被收取的最高服务费就是Gas Limit * Gas Price 了。</p><p>最后值得一提的是Gas Price 越高，你提交的交易会越快被矿工接纳。 但通常人们都不愿多支付手续费</p><p><strong>委托调用/代码调用和库</strong></p><p>有一种特殊类型的消息调用，被称为 <strong>委托调用(delegatecall)</strong> 。它和一般的消息调用的区别在于，目标地址的代码将在发起调用的合约的上下文中执行，并且 msg.sender 和 msg.value 不变。 这意味着一个合约可以在运行时从另外一个地址动态加载代码。存储、当前地址和余额都指向发起调用的合约，只有代码是从被调用地址获取的。 这使得 Solidity 可以实现”库“能力：可复用的代码库可以放在一个合约的存储上，如用来实现复杂的数据结构的库。</p><p><strong>日志</strong></p><p>有一种特殊的可索引的数据结构，其存储的数据可以一路映射直到区块层级。这个特性被称为 <strong>日志(logs)</strong> ，Solidity用它来实现 <strong>事件(events)</strong> 。合约创建之后就无法访问日志数据，但是这些数据可以从区块链外高效的访问。因为部分日志数据被存储在 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://en.wikipedia.org/wiki/Bloom_filter">布隆过滤器（Bloom filter)</a> 中，我们可以高效并且加密安全地搜索日志，所以那些没有下载整个区块链的网络节点（轻客户端）也可以找到这些日志。</p><p><strong>创建</strong></p><p>合约甚至可以通过一个特殊的指令来创建其他合约（不是简单的调用零地址）。创建合约的调用 <strong>create calls</strong> 和普通消息调用的唯一区别在于，负载会被执行，执行的结果被存储为合约代码，调用者/创建者在栈上得到新合约的地址。</p><p><strong>自毁</strong></p><p>合约代码从区块链上移除的唯一方式是合约在合约地址上的执行自毁操作 selfdestruct 。合约账户上剩余的以太币会发送给指定的目标，然后其存储和代码从状态中被移除。</p><h3 id="重点概念再次解释"><a href="#重点概念再次解释" class="headerlink" title="重点概念再次解释"></a>重点概念再次解释</h3><p><strong>账户</strong></p><p>以太坊引入了账户的概念取代比特币UTXO模型。以太坊中有两类账户，外部账户和合约账户，两类账户对于EVM来说没有区别。每个账户都有一个与之关联的账户状态和一个20字节地址，都可以存储以太币。</p><p>外部账户：由私钥控制，没有代码与之关联，地址由公钥决定。私钥可用于对交易签名从而主动向其他账户发起交易（transaction）进行消息传递，</p><p>合约账户：由合约代码控制，有代码与之关联，其地址由合约创建者的地址和该地址发出过的交易数量nonce共同决定。不可以主动向其他账户发起交易，但可以“响应”其他账户进行消息调用（message call）。</p><p>外部账户之间的消息传递是价值转移的过程，外部账户到合约账户的交易或合约账户到合约账户的消息会激发合约账户代码的执行，允许它执行如转移代币，写入内部存储，执行运算，创建合约等各种操作。</p><p>账户状态</p><p>不论账户类型，账户状态都包含以下四个字段：</p><p>nonce：随机数，账户发出的交易数及创建的合约数量之和。</p><p>Balance：余额，账户拥有以太币数量，单位为Wei，1Ether=10^18Wei。</p><p>storageRoot：存储根节点，账户内容的MerklePatricia 树根节点的哈希编码。</p><p>codeHash：代码哈希，与账户关联的EVM代码的哈希值，外部账户的codeHash为一个空字符串的哈希，创建后不可更改。状态数据库中包含所有代码片段哈希, 以便后续使用。</p><p><img src="D:\document\study\YNote\qq063B60F6CBD116FB4E7479117DADDDEF\c84218cfc20e4f21be8e4befbd9157c4\4660_image3.jpeg" alt="img"></p><p><strong>交易（Transaction）</strong></p><p>外部账户向其他账户发送签名数据包。每一笔交易都会改变以太坊的状态，都将被序列化，经矿工验证广播后记入区块链，因此，交易是异步的，可以即时返回的值只有transaction hash。交易可以分为创建合约和传递消息两类。一个交易的完成可能会需要触发多条消息及消息调用。</p><p>交易包含：</p><p>∙交易的接收者</p><p>∙可识别交易发送者、证明这是一笔发送者通过区块链发送到接收者的交易的签名</p><p>∙ VALUE，需转移的以太币数量（wei）</p><p>∙ Gas Limit(有时被称为StartGas)，允许交易执行时消耗的最大gas数量</p><p>∙ Gas Price，交易发送者指定的单位gas的价格（用以太币计算）</p><p><strong>消息（Message）</strong></p><p>两个账户间传递的数据和值（以太币）。不一定会改变以太坊的状态，只存在于以太坊执行环境的虚拟对象，不会被序列化也不会被记入区块链，消息是同步的，可以即时得到返回值。</p><p>消息调用（Message Call）</p><p>将消息从一个帐户传递到另一个帐户的行为，调用形式类似Transaction，但是只存在于以太坊执行环境的虚拟对象不会被记入区块链，可以类比函数调用。如果目标账户是合约账户，则合约账户的EVM代码被激发执行，如果两个账户都是合约账户，则调用中可以传递所有虚拟机的返回值。</p><p>消息包含：</p><p>∙消息的发送者（隐式的）</p><p>∙消息的接收者</p><p>∙ VALUE，随消息传递到合约地址的以太币数量（wei）</p><p>∙可选数据字段，作为合约的输入</p><p>∙ STARTGAS，用来限制这个消息触发的代码执行能消耗的最大gas数量</p><p>消息调用和消息通常同义，没有必要严格区分。</p><p>交易和消息不是包含关系，而是部分重合关系：交易发送者不经过合约直接发送交易到以太坊指定地址创建合约的操作，没有消息调用的过程，只属于交易；交易发送者通过调用合约从一个账户向另一个账户转账的操作，既属于交易又属于消息调用；合约账户受到外部账户激发而进行创建合约的操作，只属于消息调用不属于交易。</p><p>交易一定是由外部账户发起，一个交易可能会引发一系列“消息调用”，合约账户为“响应”来自其他账户的“消息调用”而执行代码继而激发新的“消息调用”，因此，本质上所有“消息调用”及以太坊的状态改变都是由外部账户激发，即，以太坊在整体上可以看作一个基于交易的状态机：起始于一个创世块（Genesis）状态，然后随着交易的执行状态逐步改变一直到最终状态, 这个最终状态是以太坊世界的权威版本。</p><h2 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h2><h3 id="全零地址"><a href="#全零地址" class="headerlink" title="全零地址"></a>全零地址</h3><p>以太坊中有个地址拥有非常多的以太币，这个地址就是全零地址，那么这个地址为什么会有这么多的以太币呢？</p><p>这就要从以太坊的创世区块讲起。</p><p>ETH最主要的来源并不是挖矿，而是当年众筹时发行的。</p><p>即使在以太坊正式发布近三年后的今天，创世区块中发行的7200w个ETH依然占到73.4%。</p><p>那么，这个全零地址中的ETH，是不是来自创世区块中发行的ETH呢？</p><p>实际上并不是的。</p><p>然而，解析下创世区块，可以发现，挖出创世区块的miner，居然是这个全零的地址。</p><p>创世区块不是被挖出来的，它是被人为创建出来，并作为整条区块链的起点。</p><p>既然不是被挖出来的，使用全零的地址作为占位符也是合理的。</p><p>创世区块因为不是挖矿所得，无人为此消耗算力，自然也不会有任何区块奖励。</p><p>转了一圈，这个全零地址中的ETH和创世区块并无关系。</p><p>除了创世区块中发行的ETH，新的ETH只有一种产生途径，那就是挖矿。</p><p>为了更加精确的计算，以下单位均使用ETH的最小单位Wei，关于单位问题，可以参看这里《<a target="_blank" rel="external nofollow noopener noreferrer" href="https://zhuanlan.zhihu.com/p/28994731">以太币(Ether)的单位</a>》。</p><p>搜索下miner为这个全零地址的区块，还真不少呢。</p><p>这个全零地址共挖出主链区块94个：</p><p>那么问题来了，为什么有人会用全零地址挖矿，这样自己消耗了电力，最终获益的却是全零地址。</p><p>全零地址最早挖出的一个区块是5305，难度值仅有199,485,740,316，不到0.2T，还是1060显卡为例，仅需要不到3小时即可发现一个区块。</p><p>那时候，区块是如此容易挖掘，几乎任何一台有独立显卡的中端PC，都可以挖到区块。</p><p>于是，很多人本着试试看的心态，使用自家的普通PC尝试挖掘，几乎0成本。</p><p>这群人中，有相当一部分是仅会复制粘贴的小白，悲催的事儿来了，他们忘记设置收款地址。有些专业矿工在调试机器稳定性时，也会出于方便，没有对挖矿软件进行配置。</p><p>部分钱包软件在solo挖矿时，如果不设置收款地址，就会默认使用全零地址挖矿。</p><p><strong>这也就解释了，为什么会有如此多的区块是全零地址挖到的。</strong></p><p>而且要注意的是，全零地址是一个黑洞地址，没有一个人手中掌握了全零地址的私钥，我们也无法通过全零来反向推算出全零地址的私钥，所以理论上来说，进入了黑洞地址的以太币再也无法转出了。</p><h3 id="智能合约如何运行"><a href="#智能合约如何运行" class="headerlink" title="智能合约如何运行"></a>智能合约如何运行</h3><p>比特币交易非常简单。你可以只做一件事。一种类型的交易。略过一些细节，一切都可以归结为<strong>TO （付给，谁在收钱），FROM （来自于，谁在付钱）和 AMOUNT</strong>（数量，多少钱）。这使得比特币成为一种价值储存手段，能够在网络参与者之间传递价值。</p><p>以太坊的不同之处在于交易还有一个「<strong>DATA」</strong>（数据）字段。该「<strong>DATA</strong>」字段支持三种类型的交易：</p><p><strong>价值转移（和比特币一样）</strong></p><ul><li><strong>TO</strong>接收地址；</li><li><strong>DATA</strong>字段为空或包含要附加的任何消息；</li><li><strong>FROM</strong>你</li><li><strong>AMOUNT 是</strong>你要发送的以太坊数量</li></ul><p><strong>创建智能合约</strong></p><ul><li>TO 字段为空（它触发智能合约的创建）</li><li>DATA 字段包含编译为字节代码的智能合约代码（所以实际上我们编写的代码是用来创建合约代码的，而不是真正存储到链上的合约代码）</li><li>FROM 你</li><li>AMOUNT 可以是 0 或者任意你想放在合约里的以太币数量</li></ul><p><strong>调用智能合约</strong></p><ul><li>TO 字段是智能合约账户地址</li><li>DATA 字段包含函数名称和参数 —— 如何调用智能合约</li><li>FROM 你</li><li>AMOUNT 可以是 0 或者任何数量的以太币，比如你需要为一项服务合约支付的数目</li></ul><h3 id="合约与合约账户"><a href="#合约与合约账户" class="headerlink" title="合约与合约账户"></a>合约与合约账户</h3><p>合约是代码与账户当前状态的一个集合，每次交易之后，当前的合约都会</p><p>参考文章：</p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.csdn.net/sportshark/article/details/52249607">https://blog.csdn.net/sportshark/article/details/52249607</a></p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://solidity-cn.readthedocs.io/zh/develop/solidity-by-example.html">https://solidity-cn.readthedocs.io/zh/develop/solidity-by-example.html</a></p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://learnblockchain.cn/2018/01/04/understanding-smart-contracts/">https://learnblockchain.cn/2018/01/04/understanding-smart-contracts/</a></p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.csdn.net/jiang_xinxing/article/details/80289694">https://blog.csdn.net/jiang_xinxing/article/details/80289694</a></p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://zhuanlan.zhihu.com/p/34363341">https://zhuanlan.zhihu.com/p/34363341</a></p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.chainnews.com/articles/891681682372.htm">https://www.chainnews.com/articles/891681682372.htm</a></p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>本文作者：</strong> Ray Sun</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://sunra.top/posts/dfe9e270/" title="智能合约概述">https://sunra.top/posts/dfe9e270/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"> <span>欢迎关注我的其它发布渠道</span><div class="social-list"><div class="social-item"><span class="social-link"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></span> <img class="social-item-img" src="https://res.cloudinary.com/dvtfhjxi4/image/upload/v1685836114/origin-of-ray/wechat_channel_zmg0hw.jpg"></div><div class="social-item"><a target="_blank" class="social-link" href="/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/dfbc1109/" rel="prev" title="Azure Key Vault"><i class="fa fa-chevron-left"></i> Azure Key Vault</a></div><div class="post-nav-item"> <a href="/posts/52b6d429/" rel="next" title="Promise 源码分析">Promise 源码分析<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2023</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Sun</span></div><div class="powered-by">由 <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a> 强力驱动</div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/js/third-party/math/mathjax.js"></script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-comments-3w44.vercel.app/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎大家交流学习","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/posts/dfe9e270/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script></body></html>